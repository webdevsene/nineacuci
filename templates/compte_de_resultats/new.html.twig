{% extends 'base.html.twig' %}
{% block stylesheets %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/sweetalert2/6.1.0/sweetalert2.min.css" />
    <link href="{{ asset('admin/dist/assets/libs/sweetalert2/sweetalert2.min.css')}}" rel="stylesheet" type="text/css" />

{% endblock %}


{% block body %}

{# {{ include('compte_de_resultats/_formold.html.twig') }} #}


<div class="row">
    <div class="col-xl-12">

        <!-- start page title -->
       <div class="row">
       <div class="col-12">
       
       
           <div class="page-title-box d-sm-flex align-items-center justify-content-between">
               
       
               <div class="page-title-right">
                   <ol class="breadcrumb m-0">
                       <li class="breadcrumb-item"><a href="javascript: void(0);">Saisie des comptes de résultats</a></li>
                       <li class="breadcrumb-item active">Nouvelle saisie</li>  <hr class="bg-info">
                   </ol>
               </div>
       
           </div>
       </div>
       </div>
       <!-- end page title -->

        <!-- debut form -->

        
{# {% block body %} #}
<div class="card" style=" margin: 0%;padding: 0%;-webkit-box-shadow:0 1rem 3rem rgba(0,0,0,.175);box-shadow:0 1rem 3rem rgba(0,0,0,.175)">
    <form method="post" action="{{path('compte_de_resultats_new')}}" id="target">
    <div class="card-body " style="margin: 0%;padding: 0%;">
        <div class="row">
        <div class="col-xl-12"> 
       
        {# <form method="post" action="{{path('bilan_new')}}"> #}
        <table class="table table-bordered mt-5">
                 <tr>
                  <td>Numéro d'identification :<span style="color:red">*</span>
                      <input type="text"  class="form-control form-control-sm" name="idcuci" id="idcuci"></td>
                  <td>Designation entité :<span style="color:red">*</span>
                      <input type="text" disabled class="form-control form-control-sm" name="denomination" id="denomination"></td>
                  <td>Année financière :<span style="color:red">*</span>
                      <input type="text" class="form-control form-control-sm" name="annee" id="annee"></td>
                 </tr>
        </table>
         
             <div class="card">
                 <div class="card-body">

                     <div class="d-flex flex-wrap gap-2 justify-content-center">
                         <button type="button" class="btn btn-secondary waves-effect waves-light">
                             <i class="bx bx-error font-size-16 align-middle me-2"></i> Effacer les données
                         </button>
                         <button type="submit" class="btn btn-success waves-effect waves-light">
                             <i class="bx bx-check-double font-size-16 align-middle me-2"></i> Sauvegarder
                         </button>
                         <button type="button" class="btn btn-dark bg-soft opacity-25" name="valider" id="valider">
                             <i class="bx bx-block font-size-16 align-middle me-2"></i> Valider la saisie
                         </button>
                     </div>
                 </div>
             </div>
         </div>

         <div class="col-12">
            <div class="table-responsive">
                <table name="form2" id="form2" class="table table-striped|sm|hover|inverse table-inverse table-responsive mb-0">
                    <thead>
                        <tr class="bg-dark bg-soft opacity-65">
                            <th scope="col" colspan="2" class="text-center ">
                                REF
                            </th>
                            <th scope="col" colspan="3" class="text-center">
                              Libelle<br>
                            </th>
                            <th colspan="4" scope="col" class="text-center">
                              Exercice au 31/12/<span class="text-info">2019</span> 
                            </th>
                            <th colspan="3" scope="col" class="text-center">
                              Exercice au 31/12/<span class="text-info" id="anneeN-1">2018</span>
                            </th>
                          </tr>
                        <tr class="bg-dark bg-soft opacity-80">
                            <th scope="col" colspan="5" class="text-center">
                                
                            </th>
                           {#  <th colspan="1" scope="col" class="text-center">
                              Brut
                            </th>
                            <th colspan="3" scope="col" class="text-center">
                              Ammortissement
                            </th> #}
                            <th colspan="2" scope="col" class="text-center">
                              NET1
                            </th>
                            <th colspan="3" scope="col" class="text-center">
                              NET2
                            </th>
                          </tr>
                    </thead>

                    <!-- debut tbody inputs -->
                    <tbody id="tbody">
                
                    
                    
                    </tbody>
                    <!-- end tbody -->
                </table>
            </div>
         </div>

         </div>
         <input type="hidden" name="type" value="1" >
          <button type="submit" class="btn btn-success waves-effect waves-light">
                             <i class="bx bx-check-double font-size-16 align-middle me-2"></i> Sauvegarder
                         </button>
                         
                        </div>
                    </form>
</div>



    
{# {% endblock %} #}




<!-- end formulaire -->

</div>
</div>


{% endblock %}


{% block javascript %}
<script src="{{ asset('admin/dist/assets/libs/select2/js/select2.min.js')}}"></script>



<script src="{{ asset('admin/dist/assets/libs/bootstrap-datepicker/js/bootstrap-datepicker.min.js')}}"></script>
<script src="{{ asset('admin/dist/assets/libs/spectrum-colorpicker2/spectrum.min.js')}}"></script>
<script src="{{ asset('admin/dist/assets/libs/bootstrap-timepicker/js/bootstrap-timepicker.min.js')}}"></script>
<script src="{{ asset('admin/dist/assets/libs/bootstrap-touchspin/jquery.bootstrap-touchspin.min.js')}}"></script>
<script src="{{ asset('admin/dist/assets/libs/bootstrap-maxlength/bootstrap-maxlength.min.js')}}"></script>
<script src="{{ asset('admin/dist/assets/libs/@chenfengyuan/datepicker/datepicker.min.js')}}"></script>

        <!-- form advanced init -->
<script src="{{ asset('admin/dist/assets/js/pages/form-advanced.init.js')}}"></script>


<!-- Sweet Alerts js -->
<script src="{{ asset('admin/dist/assets/libs/sweetalert2/sweetalert2.min.js')}}"></script>
<!-- Sweet alert init js-->
<script src="{{ asset('admin/dist/assets/js/pages/sweet-alerts.init.js')}}"></script>

<!-- inclure a partir du cdn sweet alert2-->
<script src="https://cdn.jsdelivr.net/sweetalert2/6.1.0/sweetalert2.min.js"></script> 

<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<script type="text/javascript">
    $(document).ready(function(){

        $('#idcuci').change(function(){
            
            let route="{{path('nineaNum')}}"+"/"+ $('#idcuci').val();
            $.ajax({
                type: 'GET',
                url : route,
                dataType : "json",
                processData: false,
                contentType: false,
                cache: false,
                timeout: 800000,
                success: function(data){
                    
                    let denomination=document.getElementById("denomination");
                    denomination.value=data;
                    
                    
                } ,
                error : function(error){
                    console.log(error);
                }
            })
        });


        
    $('#annee').change(function(e){

        e.preventDefault();
            
        let route="{{path('bilanjson')}}"+"/"+ $('#annee').val(); //console.log(route);
        $.ajax({
            type: 'GET',
            url : route,
            dataType : "json",
            processData: false,
            contentType: false,
            cache: false,
            timeout: 800000,
            success: function(data){
                //tbody=document.getElementById("tbody");
                var tbody=document.getElementById("tbody");
                    var ann=document.getElementById("annee");
                    var anneeN_1=document.getElementById("anneeN-1");
                    tbody.innerHTML="";
                    ann.innerHTML="";
                    anneeN_1.innerHTML="";

                console.log(data);
                

                for (var i = data[2].length - 1; i >= 0; i--) {
                    var tr=document.createElement('tr');
                    tr.setAttribute('class',"bg-dark bg-soft opacity-65");           

                    var td1=document.createElement('td');
                    var td2=document.createElement('td');
                   //var td3=document.createElement('td');
                   //var td4=document.createElement('td');
                     var td5=document.createElement('td');
                     var td6=document.createElement('td');

                    td1.setAttribute('colspan',2); 
                    td1.setAttribute('scope',"col"); 
                    td1.setAttribute('class',"text-center form");           
                    td1.innerHTML=  data[2][i][0]; // sont stockés les ref
                    tr.appendChild(td1) ;

                    td2.setAttribute('colspan',2); 
                    td2.setAttribute('scope',"col"); 
                               
                    td2.innerHTML=  data[2][i][1]; // sont stockes les libelles
                    tr.appendChild(td2) ;

                   // td3.setAttribute('colspan',2); 
                   // td3.setAttribute('scope',"col"); 
                   // td3.setAttribute('class',"text-center"); 

                   // var input3=document.createElement('input');  
                   // input3.setAttribute('class','form-control form-control-sm'); 
                   // input3.setAttribute('type','number'); 
                   // input3.setAttribute('name',data[2][i][0]+"brut"); 
                   // td3.appendChild(input3);
                   // tr.appendChild(td3) ;


                   // td4.setAttribute('colspan',2); 
                   // td4.setAttribute('scope',"col"); 
                   // td4.setAttribute('class',"text-center");           
                   // 
                   // var input4=document.createElement('input');  
                   // input4.setAttribute('class','form-control form-control-sm');
                   // input4.setAttribute('type','number'); 
                   // input4.setAttribute('name',data[2][i][0]+"ammo"); 
                   // td4.appendChild(input4);
                   // tr.appendChild(td4) ;


                    td5.setAttribute('colspan',3); 
                    td5.setAttribute('scope',"col"); 
                    td5.setAttribute('class',"text-center");
                    var input1=document.createElement('input'); 
                    input1.setAttribute('type','number'); 
                    
                    input1.setAttribute('name',data[2][i][0]+"net1"); 
                    input1.setAttribute('id',data[2][i][0]+"net1"); 
                    input1.setAttribute('class','form-control form-control-sm total net1 '+data[2][i][0]);   
                    if(data[0][data[2][i][0]]){
                        input1.setAttribute('value',data[0][data[2][i][0]][1]);
                        // faut appeler la function sum ici
                    }

                    

                    

                    td5.appendChild(input1);
                    tr.appendChild(td5) ;
                    


                    td6.setAttribute('colspan',3); 
                    td6.setAttribute('scope',"col"); 
                    td6.setAttribute('class',"text-center");           
                    var input2=document.createElement('input'); 
                    input2.setAttribute('type','number'); 
                    input2.setAttribute('name',data[2][i][0]+"net2"); 
                    input2.setAttribute('id',data[2][i][0]+"net2"); 
                    input2.setAttribute('class','form-control form-control-sm total net2 '+data[2][i][0]);
                    if(data[0][data[2][i][0]]){
                        input2.setAttribute('value',data[0][data[2][i][0]][2]);
                      }
                            
                    td6.appendChild(input2);
                    tr.appendChild(td6) ;


                    tbody.appendChild(tr);  

                    for (var j = data[1].length - 1; j >= 0; j--) {
                                  
                        if (data[2][i][0]==data[1][j][2]) {

                            var tr=document.createElement('tr');
                            var td1=document.createElement('td');
                            var td2=document.createElement('td');
                            // var td3=document.createElement('td');
                            // var td4=document.createElement('td');
                            var td5=document.createElement('td');
                            var td6=document.createElement('td');

                            td1.setAttribute('colspan',2); 
                            td1.setAttribute('scope',"col"); 
                            td1.setAttribute('class',"text-center form");           
                            td1.innerHTML=  data[1][j][0];
                            tr.appendChild(td1) ;

                            td2.setAttribute('colspan',2); 
                            td2.setAttribute('scope',"col"); 
                                      
                            td2.innerHTML=  data[1][j][1];
                            tr.appendChild(td2) ;

                           //  td3.setAttribute('colspan',2); 
                           //  td3.setAttribute('scope',"col"); 
                           //  td3.setAttribute('class',"text-center"); 
// 
                           //  var input3=document.createElement('input'); 
                           //   input3.setAttribute('type','number'); 
                           //  input3.setAttribute('name',data[1][j][0]+"brut");  
                           //  input3.setAttribute('class','form-control form-control-sm'); 
                           //  td3.appendChild(input3);
                           //  tr.appendChild(td3) ;
// 
// 
                           //  td4.setAttribute('colspan',2); 
                           //  td4.setAttribute('scope',"col"); 
                           //  td4.setAttribute('class',"text-center");           
                           // 
                           //  var input4=document.createElement('input');  
                           //  input4.setAttribute('class','form-control form-control-sm'); 
                           //  input4.setAttribute('type','number'); 
                           //  input4.setAttribute('name',data[1][j][0]+"ammo");
                           //  td4.appendChild(input4);
                           //  tr.appendChild(td4) ;


                            td5.setAttribute('colspan',3); 
                            td5.setAttribute('scope',"col"); 
                            td5.setAttribute('class',"text-center");
                            var input5=document.createElement('input');
                            input5.setAttribute('type','number'); 
                            input5.setAttribute('name',data[1][j][0]+"net1"); 
                            input5.setAttribute('id',data[1][j][0]+"net1"); 
                            input5.setAttribute('class','form-control form-control-sm calcul net1 '+data[1][j][2]); 
                            input5.setAttribute('data-sousclasse',data[1][j][2]);
                            if(data[0][data[1][j][0]]){
                                input5.setAttribute('value',data[0][data[1][j][0]][1]);
                            }

                            // input5.addEventListener ("change", function(e){
                            //     var sousclasse= $(this).data('sousclasse');
                            //     var total = somme($(this).hasClass('net1')? 'net1':'net2',sousclasse);
                            //     
                            //     console.log(total);
                            //     if($(this).hasClass('net1')){
                            //          $('input.total.net1').val(total);
                            //     }else{
                            //         $('input.total.net2').val(total);
                            //     }
                            //    
                            // });
                            td5.appendChild(input5);
                            tr.appendChild(td5) ;
                            


                            td6.setAttribute('colspan',3); 
                            td6.setAttribute('scope',"col"); 
                            td6.setAttribute('class',"text-center");           
                            var input6=document.createElement('input');  
                            input6.setAttribute('class','form-control form-control-sm calcul net2 '+data[1][j][2]); 
                             input6.setAttribute('type','number'); 
                            input6.setAttribute('name',data[1][j][0]+"net2"); 
                            input6.setAttribute('id',data[1][j][0]+"net2"); 
                            input6.setAttribute('data-sousclasse',data[1][j][2]);
                            if(data[0][data[1][j][0]]){
                            input6.setAttribute('value',data[0][data[1][j][0]][2]);
                            }

                            // on commente cette partie pour tester la methode hard
                            //input6.addEventListener ("change", function(e){
                            //    var sousclasse= $(this).data('sousclasse');
                            //    var total = somme($(this).hasClass('net2')? 'net1':'net2',sousclasse);
                            //    console.log(total);
                            //    if($(this).hasClass('net2')){
                            //         $('input.total.net1').val(total);
                            //    }else{
                            //        $('input.total.net2').val(total);
                            //    }
                            //    // my update here 
                            //});
                            td6.appendChild(input6);
                            tr.appendChild(td6) ;


                            tbody.appendChild(tr);  


                        }
                    }          
                        
                   
                }
               
            } ,
            error : function(error){
                console.log(error);
            }
        })
    });
    
    function remplacer(value){
        value=value.replace(".", "");
        value=value.replace(",", "");
        return value;
    }



    // javascript function to verify integer value is
    function isInt(value) {
        return !isNaN(value) && 
               parseInt(Number(value)) == value ;
    }

    $('#valider').click(function(){

        var swalMsg = "Verifier les valeurs NET saisie pour ";
        
        var tagnet,net=0,somme=0, valider=1;
        {% for tag in refAgg%}

           console.log('{{tag.code}}');
       

        {% endfor %}

        // adapter les id element

        sumTB = 0; // RA+RB+TA sumTB c'est sumXA

        if(isInt(document.getElementById('RAnet1').value) == true){

            sumTB=sumTB+ parseInt(document.getElementById('RAnet1').value);

        }
        
        if(isInt(document.getElementById('RBnet1').value) == true){

            sumTB=sumTB+ parseInt(document.getElementById('RBnet1').value);


        }
        
        if(isInt(document.getElementById('TAnet1').value) == true){

            sumTB=sumTB+ parseInt(document.getElementById('TAnet1').value);
        }
        
        tb = 0;
        
        
        if(isInt(document.getElementById('XAnet1').value) == true){

            tb= parseInt(document.getElementById('XAnet1').value);

        }
        
        
        var testVar = "XA marge brute !";
        if(tb != sumTB){

            swal({
                title: "Error!",
                text: "Verifier les valeurs NET saisie pour " + testVar,
                type: "error",
                icon:"warning",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
               });
                     
        }else{
            
            swal("Aucune incoherence dans la saisie, penser à valider !");
        }
        
        // traitement sum chiffre d'affaire TI = TA+TC+TD+TH
        
        sumTI = 0; // sumTI c'est sumXB
        if(isInt(document.getElementById('TAnet1').value) == true){

            sumTI = parseInt(document.getElementById('TAnet1').value);

        }
        if(isInt(document.getElementById('TCnet1').value) == true && 
                isInt(document.getElementById('TDnet1').value) == true && 
                isInt(document.getElementById('TBnet1').value == true) ){

            sumTI = parseInt(document.getElementById('TAnet1').value)+
                    parseInt(document.getElementById('TCnet1').value)+
                    parseInt(document.getElementById('TDnet1').value)+
                    parseInt(document.getElementById('TBnet1').value)
                    ;

        }

        ti = 0;
        if(isInt(document.getElementById('XBnet1').value) == true){ // recuperer la valeur de TI
            ti = parseInt(document.getElementById('XBnet1').value);
        }
        
        testVar = "XB chiffre d'affaires !";
        if(ti != sumTI){

            swal({
                title: "Error!",
                text: "Verifier les valeurs NET saisie pour " + testVar,
                type: "error",
                icon:"warning",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
               });
                     
        }else{
            
            swal("Aucune incoherence dans la saisie, penser à valider !");
        }

        // traitement sum valeur ajoutee TN = TB+TI + TE+TF+TK+TL+TT+RC+RD+RE+RH+RI+RJ+RK+RL
        // sumTN = 0; tn = 0;  sumTN c'est sumXC
        
        sumTN = sumTB+sumTI; 

        if(isInt(document.getElementById('TEnet1').value) == true && 
                isInt(document.getElementById('TFnet1').value) == true && 
                isInt(document.getElementById('TGnet1').value == true) &&
                isInt(document.getElementById('THnet1').value == true) &&
                isInt(document.getElementById('TInet1').value == true) &&
                isInt(document.getElementById('RCnet1').value == true) &&
                isInt(document.getElementById('RDnet1').value == true) &&
                isInt(document.getElementById('REnet1').value == true) &&
                isInt(document.getElementById('RHnet1').value == true) &&
                isInt(document.getElementById('RInet1').value == true) &&
                isInt(document.getElementById('RJnet1').value == true) &&
                isInt(document.getElementById('RFnet1').value == true) &&
                isInt(document.getElementById('RGnet1').value == true) ){

            
            sumTN = sumTN + parseInt(document.getElementById('TEnet1').value)+
                    parseInt(document.getElementById('TFnet1').value)+
                    parseInt(document.getElementById('TGnet1').value)+
                    parseInt(document.getElementById('THnet1').value)+
                    parseInt(document.getElementById('TInet1').value)+
                    parseInt(document.getElementById('RCnet1').value)+
                    parseInt(document.getElementById('RDnet1').value)+
                    parseInt(document.getElementById('REnet1').value)+
                    parseInt(document.getElementById('RHnet1').value)+
                    parseInt(document.getElementById('RInet1').value)+
                    parseInt(document.getElementById('RJnet1').value)+
                    parseInt(document.getElementById('RFnet1').value)+
                    parseInt(document.getElementById('RGnet1').value)
                    ;

                    
        }

        
        tn=0;
        if(isInt(document.getElementById('XCnet1').value) == true){ 
            tn = parseInt(document.getElementById('XCnet1').value); // recuperer la valeur de TN
        }
        testVar = "XC valeur ajoutee !";
        if(tn != sumTN){

            swal({
                title: "Error!",
                text: "Verifier les valeurs NET saisie pour " + testVar,
                type: "error",
                icon:"warning",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
               });
                     
        }else{
            
            swal("Aucune incoherence dans la saisie, penser à valider !");
        }


        // traitement sum Excedent brute d'exploitation TQ= TN+RP

        tq = 0; 
        sumTQ = tn;  // sumTQ c'est sumXD

        if(isInt(document.getElementById('RKnet1').value) == true){
            sumTQ = sumTQ + parseInt(document.getElementById('RKnet1').value);

        }
        if(isInt(document.getElementById('XDnet1').value) == true){
            tq =  parseInt(document.getElementById('XDnet1').value);

        }
        testVar = "XD Excedent brute d'exploitation !"; 
        if(tq != sumTQ){

            swal({
                title: "Error!",
                text: "Verifier les valeurs NET saisie pour " + testVar,
                type: "error",
                icon:"warning",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
               });
                     
        }else{
            
            swal("Aucune incoherence dans la saisie, penser à valider !");
        }
        
        // traitement sum resultat d'exploitation TX = sumTQ+TS+RS

        
        tx = 0; 
        sumTX = sumTQ;  // sunTX c'est ex sumXE = sumXD + TJ+RL

        if(isInt(document.getElementById('TJnet1').value) == true){
            sumTX = sumTX + parseInt(document.getElementById('TJnet1').value);

        }
        if(isInt(document.getElementById('RLnet1').value) == true){
            sumTX = sumTX + parseInt(document.getElementById('RLnet1').value);

        }
        if(isInt(document.getElementById('XEnet1').value) == true){
            tx =  parseInt(document.getElementById('XEnet1').value);

        }
        testVar = "XE Resultat d'exploitation !";
        console.log(sumTX);
        if(tx != sumTX){

            swal({
                title: "Error!",
                text: "Verifier les valeurs NET saisie pour " + testVar,
                type: "error",
                icon:"warning",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
               });
                     
        }else{
            
            swal("Aucune incoherence dans la saisie, penser à valider !");
        }

        // traitement sum resultat financier UG = UA+ UD+ UE+ SA+ SD
        
        sumUG = 0; // sumUG c'est ex sumXF = RM+RN+TK+TL+TM
        ug = 0;
        if(isInt(document.getElementById('RMnet1').value) == true && 
           isInt(document.getElementById('RNnet1').value) == true && 
           isInt(document.getElementById('TKnet1').value == true) &&
           isInt(document.getElementById('TLnet1').value == true) &&
           isInt(document.getElementById('TMnet1').value == true) ){

            
            sumUG = parseInt(document.getElementById('RMnet1').value)+
                    parseInt(document.getElementById('RNnet1').value)+
                    parseInt(document.getElementById('TKnet1').value)+
                    parseInt(document.getElementById('TLnet1').value)+
                    parseInt(document.getElementById('TMnet1').value)
                    ;

                    
        }
        if(isInt(document.getElementById('XFnet1').value) == true){
            ug =  parseInt(document.getElementById('XFnet1').value);

        }
        testVar = "XF Resultat financier !";
        console.log(testVar);
        if(ug != sumUG){

            swal({
                title: "Error!",
                text: "Verifier les valeurs NET saisie pour " + testVar,
                type: "error",
                icon:"warning",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
               });
                     
        }else{
            
            swal("Aucune incoherence dans la saisie, penser à valider !");
        }

        // traitement sum resultat des activités ordinaires UI = TX +UG 
        
        sumUI = sumTX+sumUG; // sumUI c'est ex sumXG = XE+XF

        ui = 0;
        if(isInt(document.getElementById('XGnet1').value) == true){
            ui =  parseInt(document.getElementById('XGnet1').value);

        }
        testVar = "XG Resultat des activites ordinaires !";
        if(ui != sumUI){

            swal({
                title: "Error!",
                text: "Verifier les valeurs NET saisie pour " + testVar,
                type: "error",
                icon:"warning",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
               });
                     
        }else{
            
            swal("Aucune incoherence dans la saisie, penser à valider !");
        }

        // traitement sum resultat hors activites ordinaires (RHO) UP= UK + UL +SK +SL        
        sumUP = 0; // sumUP c'est ex sumXH = TN+TO-RO-RP 
        up = 0; 
        if(isInt(document.getElementById('TNnet1').value) == true && 
           isInt(document.getElementById('TOnet1').value) == true && 
           isInt(document.getElementById('ROnet1').value == true) &&
           isInt(document.getElementById('RPnet1').value == true) ){

            
            sumUP = parseInt(document.getElementById('TNnet1').value)+
                    parseInt(document.getElementById('TOnet1').value)-
                    parseInt(document.getElementById('ROnet1').value)-
                    parseInt(document.getElementById('RPnet1').value)
                    ;
                    
        }
        if(isInt(document.getElementById('XHnet1').value) == true){
            up =  parseInt(document.getElementById('XHnet1').value);

        }
        testVar = "XH Resultat hors activites ordinaires !";
        if(up != sumUP){

            swal({
                title: "Error!",
                text: "Verifier les valeurs NET saisie pour " + testVar,
                type: "error",
                icon:"warning",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
               });
                     
        }else{
            
            swal("Aucune incoherence dans la saisie, penser à valider !");
        }

        // traitement sum benef ou perte UZ = UI +UP +SQ +SR
        sumUZ = sumUI+sumUP; //sumUZ c'est ex sumXI=XG+XH-RQ-RS
        uz = 0;
        
        if(isInt(document.getElementById('RQnet1').value) == true && 
           isInt(document.getElementById('RSnet1').value) == true ){

            
            sumUZ = sumUZ-parseInt(document.getElementById('RQnet1').value)-
                    parseInt(document.getElementById('RSnet1').value)
                    ;
                    
        }
        if(isInt(document.getElementById('XInet1').value) == true){
            uz =  parseInt(document.getElementById('XInet1').value);

        }
        testVar = "XI résultat net !";
        if(uz != sumUZ){

            swal({
                title: "Error!",
                text: "Verifier les valeurs NET saisie pour " + testVar,
                type: "error",
                icon:"warning",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
               });
                     
        }else{
            
            swal("Aucune incoherence dans la saisie, penser à sauvegarder !");
        }

    }); // end eventListner btn valider 


    function somme(netnumber,sousclasseName){
        var elemts =  $('input.calcul.'+netnumber+'.'+sousclasseName);
        var sum =0;
        for(var i = 0 ; i< elemts.length;i++){
            sum+=parseInt(elemts[i].value);
        }

        return sum;

    }

        
    });


</script>


{% endblock %}