{% extends 'ninea.html.twig' %}
{% block title %}New NiNineaproposition 
{% endblock %} 
{% block stylesheets %} 

	<link href="{{ asset('admin/dist/assets/libs/sweetalert2/sweetalert2.min.css')}}" rel="stylesheet" type="text/css"/>
	<link href="{{ asset('admin/dist/assets/libs/select2/css/select2.min.css')}}" rel="stylesheet" type="text/css"/>
	<link href="{{ asset('admin/dist/assets/libs/bootstrap-datepicker/css/bootstrap-datepicker.min.css')}}" rel="stylesheet" type="text/css">
	<link href="{{ asset('admin/dist/assets/libs/spectrum-colorpicker2/spectrum.min.css')}}" rel="stylesheet" type="text/css">
	<link href="{{ asset('admin/dist/assets/libs/bootstrap-timepicker/css/bootstrap-timepicker.min.css')}}" rel="stylesheet" type="text/css">
	<link href="{{ asset('admin/dist/assets/libs/bootstrap-touchspin/jquery.bootstrap-touchspin.min.css')}}" rel="stylesheet" type="text/css"/>
	<link
	href="{{ asset('admin/dist/assets/libs/@chenfengyuan/datepicker/datepicker.min.css')}}" rel="stylesheet">
	<!-- App favicon -->
	<link
	rel="shortcut icon" href="{{ asset('admin/dist/assets/images/favicon.ico')}}">

	<!-- Bootstrap Css -->
	<link
	href="{{ asset('admin/dist/assets/css/bootstrap.min.css')}}" id="bootstrap-style" rel="stylesheet" type="text/css"/>
	<!-- Icons Css -->
	<link
	href="{{ asset('admin/dist/assets/css/icons.min.css')}}" rel="stylesheet" type="text/css"/>

	<style type="text/css">
		

		.has_error {
			background-color: #E8F0FE;
			border-color: red;
		}

		.larger {
			width: 100%;
		}

		.fieldcolor {
			border: 2px solid #eeeeee;

		}

		.toast{
			position: absolute; 
			top: 10px; 
			right: 10px;
		}

		legend {
			color: black;
			font-size: 12px;
		}




		a:hover,
a:focus{
    text-decoration: none;
    outline: none;
}
.tab{ font-family: 'Nunito', sans-serif; }
.tab .nav-tabs{ border: none; }
.tab .nav-tabs li a{
    color:#0d3174;
    background-color: #fff;
    font-size: 12px;
    font-weight: 700;
    padding: 10px 20px 8px;
    margin: 0 5px 10px 0;
    border: 5px solid #fff;
    border-radius: 0;
    box-shadow: 0 0 7px rgba(0,0,0,0.1), 0 0 5px rgba(0,0,0,0.15) inset;
    overflow: hidden;
    position: relative;
    z-index: 1;
    transition: all 0.3s ease 0s;
}
.tab .nav-tabs li.active a,
.tab .nav-tabs li a:hover ,
.tab .nav-tabs li.active a:hover{
    color: #fff;
    background-color: #fff;
    border: 5px solid #fff;
	
}
.tab .nav-tabs li a:before{
    content: "";
    background-color: #0d3174;
    width: 100%;
    height: 100%;
    opacity: 0;
    transform: rotate(20deg);
    position: absolute;
    top: 150%;
    left: 0;
    z-index: -1;
    transition: opacity 0.3s ease 0s,transform 0.3s ease 0.13s, top 0.5s ease 0s;
}
.tab .nav-tabs li.active a:before,
.tab .nav-tabs li a:hover:before{
    opacity: 1;
    transform: rotate(0);
    top: 0;
}
.tab .tab-content{
    color:#fff;
    font-size: 12px;
    padding: 20px;
    border: 10px solid #fff;
    box-shadow: 0 0 10px rgba(0,0,0,0.15), 0 0 10px rgba(0,0,0,0.15) inset;
    position: relative;
}
@media only screen and (max-width: 479px){
    .tab .nav-tabs li{
        width: 100%;
        text-align: center;
        margin: 0 0 5px;
    }
}

	.dropdown {
	position: relative;
	display: inline-block;
	margin: 5px;
	margin-right: 30px;
	}

	.dropdown-content {
	display: none;
	position: absolute;
	background-color: #f9f9f9;
	min-width: 70px;
	box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
	padding: 5px 5px;
	z-index: 3;
	
	}

	.dropdown:hover .dropdown-content {
	display: block;
	}

	
	

	</style>

{% endblock %}
{% block body %}

	<div class="row mr-5" >
	
		
		<div class="col-lg-12" align="right">
			<span style="font-size: 10px;">[ {{ni_nineaproposition.createdAt| date('d-m-Y')}} ]</span>
			{% if ni_nineaproposition.statut == "c" %}
				<span class="badge badge-pill badge-soft-info font-size-11">En attendte de validation</span> 
				{% else %}
					{% if ni_nineaproposition.statut == "b" %}
						<span class="badge badge-pill badge-soft-danger font-size-11">Brouillon</span> 
						{% else %}					
						{% if ni_nineaproposition.statut == "r" %}
						<span class="badge badge-pill badge-soft-danger font-size-11">Rejeter</span> 
						{% else %}	
							{% if ni_nineaproposition.statut == "t" %}
								<span class="badge badge-pill badge-soft-warning font-size-11">Retourner</span> 
							{% else %}				
								<span class="badge badge-pill badge-soft-success font-size-11">Valider</span> 
							{% endif %} 
					{% endif %} 
				{% endif %}
			{% endif %}

			<div class="dropdown">
				<p class="link-info"> <u><strong> Décisions </strong></u> </p>
				<div class="dropdown-content">
						{% if ni_nineaproposition.statut == "b" or ni_nineaproposition.statut == "t" %}
							{% if ni_nineaproposition.createdBy and app.user.id == ni_nineaproposition.createdBy.id %}
								<p>
									<a type="button" id="soumettre" class="btn btn-outline-primary btn-sm waves-effect soumettre abtn">Soumettre </a>
								</p>
							{% endif %}
						{% else %}
						
							{% if is_granted('ROLE_NINEA_ADMIN') or is_granted('ROLE_VALIDER_DEMANDE_NINEA') %}
								
									<a href="{{ path ('ni_nineaproposition_validation', {'id': ni_nineaproposition.id })}}" id="valider"
										class="btn btn-outline-success waves-effect abtn ">Valider </a>
								</P>
								<P>
									<a type="button" id="retourner" class="btn btn-outline-warning waves-effect abtn" data-bs-toggle="modal"
										data-bs-target=".btnretour">Retourner </a>
								</P>
								<P>
									<a type="button" id="rejeter" class="btn btn-outline-info waves-effect abtn " data-bs-toggle="modal"
										data-bs-target=".btnrejeter">Rejeter </a>
								</P>
							{% endif %}
						{% endif %}
				</div>
			</div>
			
		</div>
	</div>
	
	<div class="row">
	   <form name="FormEntete" method="post" action="{{path('modifierEntete',{id:ni_nineaproposition.id})}}">

		<div class="col-xl-12">
			<div>
				<div class="accordion mb-3" id="accordionExample">
					<div class="accordion-item">
						<h2 class="accordion-header" id="headingOne">
							<button class="accordion-button fw-medium" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
								<h5 class="font-size-14">Demande: Administration-{{ ni_nineaproposition.createdBy is not null ? ni_nineaproposition.createdBy.niAdministration.admlibelle: ""}};  Agent-{{ ni_nineaproposition.createdBy is not null ? ni_nineaproposition.createdBy.prenom :""}} {{ni_nineaproposition.createdBy is not null ? ni_nineaproposition.createdBy.nom :""}};  N°-{{ni_nineaproposition.ninnumerodemande}}</h5>
							</button>
							
						</h2>
						<div id="collapseOne" class="accordion-collapse collapse " aria-labelledby="headingOne" data-bs-parent="#accordionExample">
							<div class="accordion-body">
								<div class="text-muted">
									<div class="card" style=" margin: 0%;padding: 0%;-webkit-box-shadow:0 1rem 3rem rgba(0,0,0,.175);box-shadow:0 1rem 3rem rgba(0,0,0,.175)">
									<div class="row mb-0">
										<div class="col-lg-12">
											<fieldset class=" p-2 fieldcolor ">
												<div class="row">
													<div class="col-lg-5">
														<table style="width: 100%;">
														   
														    {% if ni_nineaproposition.ninNinea is not null %}
																	<tr>
                                                                        <td style="width: 40%;">
												                            <label  id="id_Ninea" for="basicpill-firstname-input" class=" TXT"> <b><u>NINEA:</u></b>  <span style="color:red;">*</span>
											                            	</label>
										                            	</td>
											                            <td style="width: 60%;">
												                           <input type="text"id="inputmere" disabled name="nineamere" value="{{ni_nineaproposition.ninNinea}}" class="form-control form-control-sm" oninput="this.value = this.value.replace(/[^0-9,]/g, '');">
												                           
											                            </td>
																	</tr>
																	
															{% endif %}
															<tr>
                                                               <td style="width: 40%;">
											                      <label for="" class="TXT"> <b><u> Forme unité : </u></b>   </label>	
											                      <span style="color:red;">*</span>	
										                        </td>
										                       <td style="width: 60%;">
											                       <select name="formeunite" required class="form-control form-control-sm classselect" id="idformeunite">
																		 {% for tag in formeunites %}
																		        {% if   ni_nineaproposition.ninFormejuridique.niFormeunite.id == tag.id  %}										
																				<option  value="{{ tag.id}}" selected >{{ tag.libelle}}</option>
																				{% else %}
																				<option  value="{{ tag.id}}">{{ tag.libelle}}</option>
																				{% endif %}
																		 {% endfor %}
											                       </select>
											                      <span style="color: red;" id="ninpersonne"></span>
										                       </td>
															</tr>
						
															<tr>
														    	<td style="width: 40%;">
											                       <label class="TXT" for="basicpill-firstname-input"> <b><u> Régime juridique : </u></b>
												                   <span style="color:red;">*</span>
										                        	</label>
										                        </td>
										                        <td style="width: 60%;">
																	<select name="formejuridique" required id="idFormejuridique" class="form-control form-control-sm classselect">
																		{% for tag in ni_nineaproposition.ninFormejuridique.niFormeunite.regimeJuridique %}
																		        {% if   ni_nineaproposition.ninFormejuridique.id == tag.id  %}										
																				<option  value="{{ tag.id}}" selected>{{ tag.fojLibelle}}</option>
																				{% else %}
																				<option  value="{{ tag.id}}">{{ tag.fojLibelle}}</option>
																				{% endif %}
																		 {% endfor %}											
																	</select>
																	<span style="color: red;" id="ninformejuridique"></span>
									                        	</td>

															</tr>
															
															<tr>
															    <td style="width: 40%;">
											                      <label for="basicpill-firstname-input" ><b><u>Statut :</u></b>
																	</label>
									                        	</td>
										                      <td style="width: 60%;">
										                           <select name="ninStatut" required id="idninStatut" class="form-control form-control-sm classselect">
														                  	
																		   {% if ni_nineaproposition.ninStatut.id == 1  %}	
																		       <option  value="1" selected >	{{ni_nineaproposition.ninStatut is not null ? ni_nineaproposition.ninStatut.statLibelle : ""}}</option>	
																			   <option  value="2"  >ETS SECONDAIRE</option>			
																		   {% else %}	
																		         <option  value="2" selected >	{{ni_nineaproposition.ninStatut is not null ? ni_nineaproposition.ninStatut.statLibelle : ""}}</option>	
																			     <option  value="1"  >SIEGE</option>							
																		   {% endif %}								
										                     	</select>
									                          </td>

															</tr>
															
															{% if ni_nineaproposition.ninStatut and ni_nineaproposition.ninStatut.id == 2 %}
																	<tr>
                                                                        <td style="width: 40%;">
												                            <label  id="labelmere" for="basicpill-firstname-input" class=" TXT"> <b><u>NINEA mère :</u></b>  <span style="color:red;">*</span>
											                            	</label>
										                            	</td>
											                            <td style="width: 60%;">
												                           <input type="text"id="inputmere" name="nineamere" value="{{ni_nineaproposition.ninNineamere}}" class="form-control form-control-sm" oninput="this.value = this.value.replace(/[^0-9,]/g, '');">
												                           <span style="color: red;" id="nineamere"></span>
											                            </td>
																	</tr>
																	
															{% endif %}
						
															{% if ni_nineaproposition.statut == "r" %}
															<tr>
																<td>
																	<label for="" > <b><u>Motif rejet :</u></b>	</label>
																</td>
																<td> 
																	<label for="" class="TXT">{{ni_nineaproposition.ninRemarque}}</label>
																	
																</td>
															</tr>
														{% endif %}
														</table>
													</div>
						
													<div class="col-lg-7">
														<table style="width: 100%;">
															

															{# controle sur les formes juridiques #}
														{% if ni_nineaproposition.ninFormejuridique.id == 26  or ni_nineaproposition.ninFormejuridique.id == 96 or ni_nineaproposition.ninFormejuridique.id == 99 %}
															{% if ni_nineaproposition.ninFormejuridique.id != 99 %}

																<tr>
																	<td style="width: 30%;">
																		<label for="basicpill-firstname-input"> <b><u>Enseigne : </u></b></label>
																	</td>
																	<td style="width: 70%;">
																		<input type="text"id="idninEnseigne" name="ninEnseigne" onkeyup="this.value=this.value.toUpperCase()" value="{{ni_nineaproposition.ninEnseigne}}" class="form-control form-control-sm">						
																	</td>
																</tr>
															{% endif %}

															{% if ni_nineaproposition.ninTitrefoncier != "" %}
																<tr>
																	<td style="width: 30%;">
																		<label for=""> <b><u> Titre foncier:</u></b> </label>
																	</td>
																	<td style="width: 70%;">
																		<input type="text" id="idtitrefoncier" name="nintitrefoncier" value=" {{ni_nineaproposition.ninTitrefoncier}}"
																			class="form-control form-control-sm">
																	</td>
																</tr>
															
															{% else %}
																{% if  ni_nineaproposition.ninBail != ""  %}
																	<tr>
																		<td style="width: 30%;">
																			<label for=""> <b><u> Bail:</u></b> </label>
																		</td>
																		<td style="width: 70%;">
																			<input type="text" id="idbail" name="ninbail" value=" {{ni_nineaproposition.ninBail}}"
																				class="form-control form-control-sm">
																		</td>
																	</tr>
																{% else  %}
																{% if  ni_nineaproposition.ninPermisoccuper != ""  %}
																	<tr>
																		<td style="width: 30%;">
																			<label for=""> <b><u> Permis d'occuper:</u></b> </label>
																		</td>
																		<td style="width: 70%;">
																			<input type="text" id="inputpermisoccuper" name="inputpermisoccuper" value=" {{ni_nineaproposition.ninPermisoccuper}}"
																				class="form-control form-control-sm">
																		</td>
																	</tr>
																{% endif %}
															{% endif %}
														{% endif %}
																
																
																
															{% elseif ni_nineaproposition.ninFormejuridique.id == 98 or  ni_nineaproposition.ninFormejuridique.id == 94 %}
															
															{% elseif ni_nineaproposition.ninFormejuridique.id == "90" %}
																<tr>
																	<td style="width: 30%;">
																		<label for="basicpill-firstname-input"> <b><u>Enseigne : </u></b></label>
																	</td>
																	<td style="width: 70%;">
																		<input type="text"id="idninEnseigne" name="ninEnseigne" value="{{ni_nineaproposition.ninEnseigne}}" class="form-control form-control-sm">						
																	</td>
																</tr>
																<tr>
																	<td style="width: 30%;">
																		<label for=""> <b><u> Accord:</u></b> </label>
																	</td>
																	<td style="width: 70%;">
																		<input type="text" id="idaccord" name="accord" value=" {{ni_nineaproposition.ninAccord}}"
																			class="form-control form-control-sm">
																	</td>
																</tr>

																{% elseif ni_nineaproposition.ninFormejuridique.id == 92 %}
																	<tr>
																		<td style="width: 30%;">
																			<label for="basicpill-firstname-input"> <b><u>Enseigne : </u></b></label>
																		</td>
																		<td style="width: 70%;">
																			<input type="text"id="idninEnseigne" name="ninEnseigne" value="{{ni_nineaproposition.ninEnseigne}}" class="form-control form-control-sm">						
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 30%;">
																			<label for=""> <b><u> Bordereau:</u></b> </label>
																		</td>
																		<td style="width: 70%;">
																			<input type="text" id="idbordereau" name="bordereau" value=" {{ni_nineaproposition.ninBordereau}}"
																				class="form-control form-control-sm">
																		</td>
																	</tr>
																{% elseif ni_nineaproposition.ninFormejuridique.id == 29  or ni_nineaproposition.ninFormejuridique.id == 91	 %}
																	<tr>
																		<td style="width: 30%;">
																			<label for="basicpill-firstname-input"> <b><u>Enseigne : </u></b></label>
																		</td>
																		<td style="width: 70%;">
																			<input type="text"id="idninEnseigne" name="ninEnseigne" value="{{ni_nineaproposition.ninEnseigne}}" class="form-control form-control-sm">						
																		</td>
																	</tr>	
																{% if registreCommerce != "" %}
																	<tr>
																		<td style="width: 30%;">
																			<label for=""> <b><u>Régistre de commerce :</u></b> </label>
																		</td>
																		<td style="width: 70%;">
																			<input type="text" id="ni_nineaproposition_ninRegcom" name="ni_nineaproposition_ninRegcom"
																				value="{{ registreCommerce }}" class="form-control form-control-sm">
																			<span style="color: red;" id="ninregcom"></span>
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 30%;">
																			<label for=""> <b><u>Date de régistre :</u></b> </label>
																		</td>
																		<td style="width: 70%;">
																			<input type="date" id="idninDatreg" name="ninDatreg" value="  {{ni_nineaproposition.ninDatreg != null ? ni_nineaproposition.ninDatreg | date('Y-m-d') : ""}}"
																				class="form-control form-control-sm" required>
																		</td>
																	</tr>
																{% else %}
																	
																	<tr>
																		<td style="width: 30%;">
																			<label for=""> <b><u> Bordereau:</u></b> </label>
																		</td>
																		<td style="width: 70%;">
																			<input type="text" id="idbordereau" name="bordereau" value=" {{ni_nineaproposition.ninBordereau}}"
																				class="form-control form-control-sm">
																		</td>
																	</tr>
																{% endif %}
																	
																	

																	{% elseif ni_nineaproposition.ninFormejuridique.id == 27	%}
																		<tr>
																			<td style="width: 30%;">
																				<label for="basicpill-firstname-input"> <b><u>Enseigne : </u></b></label>
																			</td>
																			<td style="width: 70%;">
																				<input type="text"id="idninEnseigne" name="ninEnseigne" value="{{ni_nineaproposition.ninEnseigne}}" class="form-control form-control-sm">						
																			</td>
																		</tr>

																	{% if registreCommerce != "" %}
																		<tr>
																			<td style="width: 30%;">
																				<label for=""> <b><u>Régistre de commerce :</u></b> </label>
																			</td>
																			<td style="width: 70%;">
																				<input type="text" id="ni_nineaproposition_ninRegcom" name="ni_nineaproposition_ninRegcom"
																					value="{{ registreCommerce }}" class="form-control form-control-sm">
																				<span style="color: red;" id="ninregcom"></span>
																			</td>
																		</tr>
																		<tr>
																			<td style="width: 30%;">
																				<label for=""> <b><u>Date de régistre :</u></b> </label>
																			</td>
																			<td style="width: 70%;">
																				<input type="date" id="idninDatreg" name="ninDatreg" value="{{ni_nineaproposition.ninDatreg|date('Y-m-d')}}"
																					class="form-control form-control-sm" required>
																			</td>
																		</tr>
																	{% else %}
																		<tr>
																			<td style="width: 30%;">
																				<label for=""> <b><u> Agrément:</u></b> </label>
																			</td>
																			<td style="width: 70%;">
																				<input type="text" id="idagrement" name="agrement" value=" {{ni_nineaproposition.ninAgrement}}"
																					class="form-control form-control-sm">
																			</td>
																		</tr>
																	{% endif %}
																	

																{% elseif ni_nineaproposition.ninFormejuridique.id == "44"  or ni_nineaproposition.ninFormejuridique.id == "48" %}
																	<tr>
																		<td style="width: 30%;">
																			<label for="basicpill-firstname-input"> <b><u>Enseigne : </u></b></label>
																		</td>
																		<td style="width: 70%;">
																			<input type="text"id="idninEnseigne" name="ninEnseigne" value="{{ni_nineaproposition.ninEnseigne}}" class="form-control form-control-sm">						
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 30%;">
																			<label for=""> <b><u> Agrément:</u></b> </label>
																		</td>
																		<td style="width: 70%;">
																			<input type="text" id="idagrement" name="agrement" value=" {{ni_nineaproposition.ninAgrement}}"
																				class="form-control form-control-sm">
																		</td>
																	</tr>
																	
																	{% elseif ni_nineaproposition.ninFormejuridique.id == 50  or ni_nineaproposition.ninFormejuridique.id == 51 or ni_nineaproposition.ninFormejuridique.id == 52
																		or ni_nineaproposition.ninFormejuridique.id == 54 or ni_nineaproposition.ninFormejuridique.id == 55 or ni_nineaproposition.ninFormejuridique.id == 59 %}
																		<tr>
																			<td style="width: 30%;">
																				<label for="basicpill-firstname-input"> <b><u>Enseigne : </u></b></label>
																			</td>
																			<td style="width: 70%;">
																				<input type="text"id="idninEnseigne" name="ninEnseigne" value="{{ni_nineaproposition.ninEnseigne}}" class="form-control form-control-sm">						
																			</td>
																		</tr>
																		<tr>
																			<td style="width: 30%;">
																				<label for=""> <b><u> Récépissé:</u></b> </label>
																			</td>
																			<td style="width: 70%;">
																				<input type="text" id="idrecepisse" name="recepisse" value=" {{ni_nineaproposition.ninRecepisse}}"
																					class="form-control form-control-sm">
																			</td>
																		</tr>
																	
																	{% elseif ni_nineaproposition.ninFormejuridique.id == 32  or ni_nineaproposition.ninFormejuridique.id == 40 or ni_nineaproposition.ninFormejuridique.id == 41
																			or ni_nineaproposition.ninFormejuridique.id == 42 or ni_nineaproposition.ninFormejuridique.id == 43 or ni_nineaproposition.ninFormejuridique.id == 45 or ni_nineaproposition.ninFormejuridique.id == 46 
																			or ni_nineaproposition.ninFormejuridique.id == 47 or ni_nineaproposition.ninFormejuridique.id == 56 or ni_nineaproposition.ninFormejuridique.id == 97 or ni_nineaproposition.ninFormejuridique.id == 95 %}
																			<tr>
																				<td style="width: 30%;">
																					<label for="basicpill-firstname-input"> <b><u>Enseigne : </u></b></label>
																				</td>
																				<td style="width: 70%;">
																					<input type="text"id="idninEnseigne" name="ninEnseigne" value="{{ni_nineaproposition.ninEnseigne}}" class="form-control form-control-sm">						
																				</td>
																			</tr>
																			<tr>
																				<td style="width: 30%;">
																					<label for=""> <b><u> Arrêté ou decret ou loi:</u></b> </label>
																				</td>
																				<td style="width: 70%;">
																					<input type="text" id="idarrete" name="arrete" value=" {{ ni_nineaproposition.ninArrete }}"
																						class="form-control form-control-sm">
																				</td>
																			</tr>

															{% else %}
																<tr>
																	<td style="width: 30%;">
																		<label for="basicpill-firstname-input"> <b><u>Enseigne : </u></b></label>
																	</td>
																	<td style="width: 70%;">
																		<input type="text"id="idninEnseigne" name="ninEnseigne" value="{{ni_nineaproposition.ninEnseigne}}" class="form-control form-control-sm">						
																	</td>
																</tr>
																<tr>
																	<td style="width: 30%;">
																		<label for=""> <b><u>Régistre de commerce :</u></b> </label>
																	</td>
																	<td style="width: 70%;">
																		<input type="text" id="ni_nineaproposition_ninRegcom" name="ni_nineaproposition_ninRegcom"
																			value="{{ registreCommerce }}" class="form-control form-control-sm">
																		<span style="color: red;" id="ninregcom"></span>
																	</td>
																</tr>
																	<tr>
																		<td style="width: 30%;">
																			<label for=""> <b><u>Date de régistre :</u></b> </label>
																		</td>
																		<td style="width: 70%;">
																			<input type="date" id="idninDatreg" name="ninDatreg" value="{{ni_nineaproposition.ninDatreg|date('Y-m-d')}}"
																				class="form-control form-control-sm" required>
																		</td>
																	</tr>
																	
															{% endif %}
																

														</table>
													</div>
												</div>
											</fieldset>
											<br>
										</div>
										<div class="row">
										<div class="col-lg-12">
										      <div class="mb-3 row">
												<label class="col-md-5" for="basicpill-firstname-input"></label>
												<div class="col-md-1" align="center">
													<input type="submit"  value="Modifier" name="modifierEntete" id="idmodifierEntete"  class="boutonsm">
												</div>
												<div class="col-md-1" align="center">
													<input hidden type="submit"  value="Reinitialiser" name="reprendre" id="idreprendre"  class="btn btn-primary  btn-sm">
											    </div>
												 
											  </div>
										</div>
										</div>
									</div>
								</div>
								
								</div>
							</div>
						</div>
					</div>
					
				</div>
				<!-- end accordion -->
			</div>
		</div>
		<!-- end col -->
        </form>
	</div>

	
	<div class="card" style=" margin: 0%;padding: 0%;-webkit-box-shadow:0 1rem 3rem rgba(0,0,0,.175);box-shadow:0 1rem 3rem rgba(0,0,0,.175)">
		
			<div class="col-lg-12">
				<div class="tab " role="tabpanel">
					<ul class="nav nav-tabs nav-fill " role="tablist" >

						<li class="nav-item ">
							<a class="nav-link active  " id="idpersonne" data-bs-toggle="tab"  href="#personne" role="tab" >
								<span class="d-block d-sm-none">
									<i class="fas fa-home"></i>
								</span>
								<span class="d-none d-sm-block">
									{% if ni_nineaproposition.ninFormejuridique.niFormeunite.id == 11 %} Personne physique 
									{% else %}
										{% if ni_nineaproposition.ninFormejuridique.niFormeunite.id == 21 %}
											Personne morale
										{% else %}
											{% if ni_nineaproposition.ninFormejuridique.niFormeunite.id == 12 %}
												Autres personnes physiques imposables
											{% else %}
												{% if ni_nineaproposition.ninFormejuridique.niFormeunite.id == 22 %}
													Autres personnes morales
												{% endif %}	
											{% endif %}
										{% endif %}
									{% endif %}

								</span>
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link "  id="idcoordonnee" data-bs-toggle="tab" href="#coordonnees" role="tab" >
								<span class="d-block d-sm-none">
									<i class="fas fa-home"></i>
								</span>
								<span class="d-none d-sm-block">Coordonnées de l'établissement
								</span>
							</a>
						</li>

						<li class="nav-item">
							<a class="nav-link " id="idactivite" data-bs-toggle="tab" href="#activites" role="tab" >
								<span class="d-block d-sm-none">
									<i class="fas fa-home"></i>
								</span>
								<span class="d-none d-sm-block">Activités et produits</span>
							</a>
						</li>

						<li class="nav-item">
							<a class="nav-link " id="idactiviteEconomique" data-bs-toggle="tab" href="#activiteEconomiques" role="tab">
								<span class="d-block d-sm-none">
									<i class="fas fa-home"></i>
								</span>
								<span class="d-none d-sm-block">Activité économique
								</span>
							</a>
						</li>

						{% if (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 21 or ni_nineaproposition.ninFormejuridique.niFormeunite.id == 22) %} 

							<li class="nav-item">
								<a class="nav-link " id="iddirigeant" data-bs-toggle="tab" href="#dirigeants" role="tab">
									<span class="d-block d-sm-none">
										<i class="fas fa-home"></i>
									</span>
									<span class="d-none d-sm-block">Dirigeants et associés</span>
								</a>
							</li>
						{% endif %}
					</ul>


					<div class="tab-content p-3 text-muted tabs" style="border: 3px solid #eeeeee;">
						
						<div	class="tab-pane active" id="personne" role="tabpanel">

							{% if ni_nineaproposition.niPersonne is not null  %} 
								<fieldset class=" fieldcolor p-2">
									
									
										<form  id="editajouter_personne" action="{{ path('ni_nineaproposition_editPersonne',{id:ni_nineaproposition.niPersonne.id,idDemande:ni_nineaproposition.id})}}" method="post" 
											 >
											
											{% if (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 11) or  (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 12) %}
												<div id="idPPhysique">
													<div class="row">
														<div class="col-lg-6 ">
															<fieldset class="border p-2">	
																<table style="width: 100%;">
																	<tr>
																		<td style="width: 30%;">
																			<label for="" class="TXT mt-2"><b><u>Civilité : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 50%;">
																			<select class="form-control form-control-sm classselect mt-2" name="civilite" id="idCivilite" required>
																				<option value="" selected>Sélectionner ...			</option>
																				{% for tagciv in civilites %}
																					{% if tagciv.id == ni_nineaproposition.niPersonne.civilite.id %}
																							<option value="{{ tagciv.id}}" selected>	{{ tagciv.civlibelle}}</option>
																						{% else %}
																							<option value="{{ tagciv.id}}" >	{{ tagciv.civlibelle}}</option>
																					{% endif %}
																				{% endfor %}
																			</select>
																			<span style="color: red;" id="nincivil"></span>
																		</td>
																	</tr>
										
																	<tr>
																		<td style="width: 30%;">
																			<label for="" class="TXT mt-2"><b><u>Prénom : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 50%;">
																			<input type="text" name="prenom" maxlength="100" id="prenom" required value="{{ni_nineaproposition.niPersonne.ninPrenom}}" class="form-control form-control-sm classselect mt-2"
																				onkeyup="this.value=this.value.toUpperCase()">
																			<span style="color: red;" id="ninprenom"></span>
																		</td>
																	</tr>
										
																	<tr>
																		<td style="width: 30%;">
																			<label for="" class="TXT mt-2"><b><u>Nom : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 50%;">
																			<input type="text" name="nom" id="idnom" maxlength="100" class="form-control form-control-sm mt-2" required value="{{ni_nineaproposition.niPersonne.ninNom}}">
																			<span style="color: red;" id="ninnom"></span>
																		</td>
																	</tr>
										
																	<tr>
																		<td style="width: 30%;">
																			<label for="" class="TXT mt-2"><b><u>Sexe : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 50%;">
																			<select class="form-control form-control-sm classselect mt-2" name="sexe" id="idsexe" aria-readonly="true">
																				{% for tags in sexes %}
																					{% if tags.id == ni_nineaproposition.niPersonne.ninSexe.id %}
																						<option value="{{ tags.id }}" selected > {{ tags.libelle}}</option>
																					{% else %}
																						<option value="0" > Sélectionner ...</option>
																					{% endif %}
																				{% endfor %}														
																			</select>
																			<span style="color: red;" id="ninsexe"></span>
										
																		</td>
																	</tr>
										
																	<tr>
																		<td style="width: 30%;">
																			<label for="" class="TXT mt-2"><b><u>Date de naissance : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 50%;">
																			<input type="date" name="datenais" id="idDatenais"  min="1900-01-01" required value="{{ni_nineaproposition.niPersonne.ninDateNaissance|date("Y-m-d")}}" class="form-control form-control-sm mt-2">
																			<span style="color: red;" id="nindatenais"></span>
																		</td>
																	</tr>
										
																	<tr>
																		<td style="width: 30%;">
																			<label for="" class="TXT mt-2"><b><u>Lieu de naissance : </u></b></label>
																			<span style="color: red;">*</span>

																		</td>
																		<td style="width: 70%;">
																			<input type="text" name="lieunais" id="idlieunais" maxlength="100"  value="{{ni_nineaproposition.niPersonne.ninLieuNaissance}}"  class="form-control form-control-sm mt-2" required>
																			<span style="color: red;" id="ninlieunais"></span>
																		</td>
																	</tr>
																	
																</table>
																<table style="width: 100%;" class="mt-2">
																	<tr>
																		<td style="width: 30%;">
																			<label for="" class="TXT"> <b><u>Nationalité : </u></b>  </label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 70%;">
																			<select class="form-control form-control-sm select2 classselect" name="nationalite"   id="idnationalite_personne" required>
																				<option value="" selected>
																					Sélectionner</option>
																				{% for tags in nationalites %}
																				   {% if ni_nineaproposition.niPersonne.nationalite.id == tags.id %}
																					<option value="{{tags.id}}"  selected >
																						{{tags.id}}-{{ tags.libelle}}</option>
																					{% else %}
																					  <option value="{{tags.id}}" >
																						{{tags.id}}-{{ tags.libelle}}</option>
																					{% endif %}
																				{% endfor %}
																			</select>
																			<span style="color: red;" id="ninationalite"></span>
																		</td>
																	</tr>
																</table>
										
																<div id="tableCni_personne" class="mt-2">
																	<table  style="width: 100%;">
																		<tr id="trcni">
																			<td style="width: 30%;">
																				<label for="" class="TXT"> <b><u>CNI : </u></b></label>
																				<span style="color: red;">*</span>
																			</td>
																			<td style="width: 50%;" >
																				<input  type="password" readonly onfocus="this.removeAttribute('readonly');" name="cni" id="idcni" value="{{ni_nineaproposition.niPersonne.ninCNI}}" maxlength = '14'  required
																					oninput="this.value = this.value.replace(/[^A-Za-z0-9]/g, '');" onkeyup="this.value=this.value.toUpperCase()" onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																					 class="form-control  form-control-sm">
																				<span style="color: red;" id="nincni"></span>
																			</td>
																		</tr>
																		
																		<tr >
																			<td style="width: 30%;">
																				<label for="" class="TXT mt-2" id="labelconfirmcni"> <b><u>Confirmation CNI : </u></b></label>
																				<span style="color: red;">*</span>
																			</td>
																			<td style="width: 50%;" >
																				<input type="text" name="confirm_cni" id="idConfirmcni" required class="form-control form-control-sm  mt-2" 
																					maxlength = '14'  onkeyup="this.value=this.value.toUpperCase()" onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																					oninput="this.value = this.value.replace(/[^A-Za-z0-9]/g, '');" value="{{ni_nineaproposition.niPersonne.ninCNI}}" >
																				<span style="color: red;" id="ninconfcni"></span>
																			</td>
																		</tr>
																		<tr id="trcni" class="mt-2">
																			<td style="width: 30%;">
																				<label for="" class="TXT mt-2"><b><u>Date de délivrance  : </u></b></label>
																				<span style="color: red;">*</span>
																			</td>
																			<td style="width: 70%;" >
																				<input type="date" name="datecni" id="idDatecni" value="{{ni_nineaproposition.niPersonne.ninDateCNI|date("Y-m-d") }}" min="1901-01-01" class="form-control form-control-sm mt-2">
																				<span style="color: red;" id="ninDatecni"></span>
																			</td>
																		</tr>
																	</table>
																</div>
																
																<div  id="tablePassport_personne" class="mt-2">
																	<table style="width: 100%;">
																		<tr id="trPassport">
																			<td style="width: 30%;">
																				<label for="" class="TXT ">	<b><u>Passport : </u></b></label>
																				<span style="color: red;">*</span>
																			</td>
																			<td style="width: 50%;">
																				<input type="password" name="passport" id="idpassport" maxlength = '14' oninput="this.value = this.value.replace(/[^A-Za-z0-9]/g, '');" 
																				value="{{ni_nineaproposition.niPersonne.ninCNI}}" onkeyup="this.value=this.value.toUpperCase()" onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																					class="form-control form-control-sm"  readonly onfocus="this.removeAttribute('readonly');">
																				<span style="color: red;" id="ninpassport"></span>
																			</td>
																		</tr>
																		<tr >
																			<td style="width: 30%;">
																				<label for="" class="TXT mt-2" id="labelconfirmpassport"> <b><u>Confirmation PP : </u></b></label>
																				<span style="color: red;">*</span>
																			</td>
																			<td style="width: 50%;" >
																				<input type="text" name="confirm_passport" id="idConfirmpassport" required onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																					 class="form-control form-control-sm  mt-2" 
																					maxlength = '14'  onkeyup="this.value=this.value.toUpperCase()"
																					oninput="this.value = this.value.replace(/[^A-Za-z0-9]/g, '');" value="{{ni_nineaproposition.niPersonne.ninCNI}}" >
																				<span style="color: red;" id="ninconfpassport"></span>
																			</td>
																		</tr>
																		<tr id="trDatePassport" class="mt-2">
																			<td style="width: 30%;">
																				<label for="" class="TXT mt-2"><b><u>Date du passport  : </u></b></label>
																			</td>
																			<td style="width: 70%;">
																				<input type="date" name="datepassport" id="idDatepassport" value="{{ni_nineaproposition.niPersonne.ninDateCNI|date("Y-m-d") }}" min="1901-01-01" class="form-control form-control-sm mt-2">
																				<span style="color: red;" id="nindatepassport"></span>
																			</td>
																		</tr>
																	</table>
																</div>
																<table style="width:100% ;" class="mt-2">
																	<tr>
																		<td style="width: 30%;">
																			<label for="" class="TXT"><b><u>Téléphone : </u></b></label>
																			<span style="color: red;">*</span>

																		</td>
																		<td style="width: 70%;">
																			<input type="text" name="telephone" maxlength = '9' id="idtelpersonne"  value="{{ni_nineaproposition.niPersonne.ninTelephone}}" class="form-control form-control-sm mt-2" required
																			  'oninput="this.value = this.value.replace(/[^0-9,]/g, '');" '>
																			<span style="color: red;" id="nintelpersonne"></span>
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 30%;">
																			<label for="" class="TXT mt-2"><b><u>Email : </u></b></label>
																		</td>
																		<td style="width: 70%;">
																			<input type="email" name="email" id="idemailpersonne"  value="{{ni_nineaproposition.niPersonne.ninEmailPersonnel}}" class="form-control form-control-sm">
																			<span style="color: red;" id="ninemail_personne"></span>
																		</td>
																	</tr>
										
																</table>
																		
															</fieldset>
															
														</div>
										
														<div class="col-lg-6">
															<fieldset class="border p-2">										
																<table style="width: 100%;">
																	<tr>
																		<td style="width: 50%;">
																			<label for="" class="TXT"> <b><u>Type Voie : </u></b> </label>
																		</td>
										
																		<td style="width: 50%;">
																			<select class="form-control form-control-sm classselect" name="typevoie" value="" id="idtypevoie" >
																				<option value="" selected >	Sélectionner</option>
																				{% for tagv in typevoies %}
																				     {% if ni_nineaproposition.niPersonne.ninTypevoie is not null %}
																						{% if tagv.id == ni_nineaproposition.niPersonne.ninTypevoie.id %}
																							<option value="{{ tagv.id }}" selected> {{ tagv.tyvlibelle}}</option>
																						{% else %}
																							<option value="{{ tagv.id }}" > {{ tagv.tyvlibelle}}</option>
																						{% endif %}
																					{% else %}
																							<option value="{{ tagv.id }}" > {{ tagv.tyvlibelle}}</option>
																						{% endif %}
																						
																				{% endfor %}
																			</select>
																			<span style="color: red;" id="nintypevoie"></span>
																		</td>
																	</tr>
										
																	<tr>
																		<td style="width: 50%;">
																			<label for="" class="TXT"><b><u>Voie : </u></b>  </label>

																		</td>
																		<td style="width: 50%;">
																			<input type="text" name="voie" maxLength="50" id="idvoie" value="{{ ni_nineaproposition.niPersonne.ninVoie}}" 
																			onkeyup="this.value=this.value.toUpperCase()"
																			class="form-control form-control-sm " >
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 50%;">
																			<label for="numvoie" class="TXT"> <b><u>Numero de la voie : </u></b> </label>
																		</td>
																		<td style="width: 50%;">
																			<input type="text" maxLength="5" name="numvoie" id="idNumvoie" value="{{ ni_nineaproposition.niPersonne.numVoie}}" oninput="this.value = this.value.replace(/[^0-9,]/g, '');" class="form-control form-control-sm" >
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 50%;">
																			<label for="numvoie" class="TXT"><b><u>Région : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 50%;">
																			<select class="form-control form-control-sm classselect  " name="region" id="region" style="width: 100%;">
																				<option>Sélectionner ...</option>
																				{% for tagr in regions %}
																					{% if tagr.id == ni_nineaproposition.niPersonne.ninQvh.qvhCACRID.cacrCAVID.cavDEPID.depRegCD.id %}
																						<option value="{{ tagr.id }}" selected> {{ tagr.libelle}}</option>
																					{% else %}
																						<option value="{{ tagr.id }}" > {{ tagr.libelle}}</option>
																					{% endif %}

																				{% endfor %}
																				</select>
																				<span style="color: red;" id="ninregion"></span>
																			</td>
																		</td>
																	</tr>
																	<tr>
																		<td>
																			<label for="numvoie" class="TXT"><b><u>Département : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td>
																			<select class="form-control form-control-sm classselect " name="departement" id="departement" style="width: 100%;">
																				{% if ni_nineaproposition.niPersonne.ninQvh.qvhCACRID.cacrCAVID.cavDEPID %}
																					<option value="{{ ni_nineaproposition.niPersonne.ninQvh.qvhCACRID.cacrCAVID.cavDEPID.id }}" selected> {{ ni_nineaproposition.niPersonne.ninQvh.qvhCACRID.cacrCAVID.cavDEPID.description}}</option>
																				{% else %}
																						<option value="" ></option>
																				{% endif %}
																			</select>
																			<span style="color: red;" id="nindepartement"></span>
																		</td>
																	</tr>
																	<tr>
																		<td>
																			<label for="numvoie" class="TXT"><b><u>Commune/Ville/Arrondissement : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td>
																			<select class="form-control form-control-sm classselect" name="cav" id="cav" style="width: 100%;">
																					{% if ni_nineaproposition.niPersonne.ninQvh.qvhCACRID.cacrCAVID %}
																						<option value="{{ ni_nineaproposition.niPersonne.ninQvh.qvhCACRID.cacrCAVID.id }}" selected> {{ ni_nineaproposition.niPersonne.ninQvh.qvhCACRID.cacrCAVID.libelle}}</option>
																					{% else %}
																							<option value="" ></option>
																					{% endif %}
																			</select>
																			<span style="color: red;" id="nincav"></span>
																		</td>
																	</tr>
										
																	<tr>
																		<td>
																			<label for="basicpill-firstname-input" class="TXT">	<b><u>Com d'arr/Communauté rurale : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td>
																			<select class="form-control form-control-sm classselect" name="cacr" id="cacr" style="width: 100%;">
																					{% if ni_nineaproposition.niPersonne.ninQvh.qvhCACRID %}
																						<option value="{{ ni_nineaproposition.niPersonne.ninQvh.qvhCACRID.id }}" selected> {{ ni_nineaproposition.niPersonne.ninQvh.qvhCACRID.libelle}}</option>
																					{% else %}
																							<option value="" ></option>
																					{% endif %}
																			</select>
																			<span style="color: red;" id="nincacr"></span>
																		</td>
																	</tr>
																	<tr>
										
																		<td style="width: 30%;">
																			<label for="basicpill-firstname-input" class="TXT">
																				<b><u>Quartier/Village/Hameau : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 70%;">
																			<select class="form-control form-control-sm classselect"  required="true" name="qvh" id="qvh" style="width: 100%;">
																					{% if ni_nineaproposition.niPersonne.ninQvh %}
																						<option value="{{ ni_nineaproposition.niPersonne.ninQvh.id }}" selected> {{ ni_nineaproposition.niPersonne.ninQvh.libelle}}</option>
																					{% else %}
																							<option value="" ></option>
																					{% endif %}
																			</select>
																			<span style="color: red;" id="ninqvh"></span>
																		</td>
																	</tr>	
																	<tr>				
																		<td style="width: 30%;">
																			<label for="basicpill-firsAdresse complète:tname-input" class="TXT">
																				<b><u>Adresse domicile : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 70%;">
																			<input type="text" name="adresse" id="idadresse" value="{{ ni_nineaproposition.niPersonne.adresse}}"class="form-control form-control-sm"
																			onkeyup="this.value=this.value.toUpperCase()">
																			<span style="color: red;" id="ninadresse"></span>
																		</td>
																	</tr>

																</table>	
															</fieldset>
										
														</div>
													</div>

												</div>
											{% else %}
												{% if (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 21) or  (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 22) %}
													<div id="idMorale"  class="col-lg-8 " >
														<fieldset class="border p-2" >
														<center>	
															<table style="width: 100%;">
																<tr >
																	<td style="width: 20%;">
																		<label for="" class="TXT"><b><u>Raison sociale : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 80%;" >
																		<textarea name="raison"  id="idraison" cols="10" rows="5" class="form-control form-control-sm" onkeyup="this.value=this.value.toUpperCase()" required value=""  >{{ni_nineaproposition.niPersonne.ninRaison}}  </textarea>
																		<span style="color: red;" id="ninraison"></span>
																	</td>
																</tr>

																<tr >
																	<td style="width: 20%;">
																		<label for="" class="TXT mt-2"><b><u>Sigle : </u></b></label>
																	</td>
																	<td style="width: 80%;" >
																		<input type="text" style=" width:40%;" name="sigle" id="idSigle"onkeyup="this.value=this.value.toUpperCase()" class="form-control form-control-sm mt-2" value="{{ni_nineaproposition.niPersonne.ninSigle}}">
																		<span style="color: red;" id="ninsigle"></span>
																	</td>
																</tr>
															</table>
														</center>
														</fieldset>
													</div>
												{% endif %}
											{% endif %}


											{% if ni_nineaproposition.statut == 'c' %}
												{% if is_granted('ROLE_NINEA_ADMIN') or is_granted('ROLE_VALIDER_DEMANDE_NINEA')  %} 
								
													<div class="row mt-3">
														<div class="col-lg-8">		</div>
														<div class="col-lg-4" align="right">
															<input type="button" value="Suivant" name="edit" id="btnSuivant" class="boutonsm ">
														</div>
													</div>
												{% endif %}
												{% else %}
												<div class="row mt-3">
													<div class="col-lg-9">		</div>
													
													{% if (ni_nineaproposition.ninStatut.id == 2 )  and ( (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 11 ) or (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 12 ) ) %}
														<div class="col-lg-3" align="right">
															<input type="button" value="Suivant" name="edit" onclick="verificationInfosNINET();" id="btnSuivantPP" class="boutonsm">
															<input type="button" value="Suivant" name="edit" id="btnSuivant" style="display:none" class="boutonsm">
														</div>
													{% else %}
														<div class="col-lg-3" align="right">
															<input type="button" value="Suivant" name="edit"  id="btnSuivant"  class="boutonsm">
														</div>
													{% endif %}
													
													{# <div class="col-lg-3 mt-4" align="right">
														<input type="button" value="Suivant" name="edit"  id="btnSuivant"  class="boutonsm">
													</div> #}
												</div>

												
											{% endif %}

											
										</form>

								</fieldset>
							

							{% else %}
						
								<form  action="{{path('ajouterPersonnes',{id:app.request.attributes.get('id')})}}" method="post" autocomplete="off" id="formajouterPersonne"
									 >
									{% if (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 11) or (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 12) %}
										<div id="idPPhysique">
											<div class="row">
												<div class="col-lg-6">
													<fieldset class="border p-2">	

														{% for message in app.session.flashbag.get('messageCNI')%}
														<div class="alert alert-danger alert-dismissible fade show" role="alert">
															{{message}}
															<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
														</div>
										
														{% endfor %}

														<table style="width: 100%;">
															<tr>
																<td style="width: 30%;">
																	<label for="" class="TXT mt-2"><b><u>Civilité : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 70%;">
																	<select class="form-control form-control-sm mt-2 classselect" style="width: 50%;" name="civilite" id="idCivilite" required>
																		<option value="" selected>Sélectionner ...			</option>
																		{% for tag in civilites %}
																			<option value="{{ tag.id}}">		{{ tag.civlibelle}}</option>
																		{% endfor %}
																	</select>
																	<span style="color: red;" id="nincivil"></span>
																</td>
															</tr>
								
															<tr>
																<td style="width: 30%;" >
																	<label for="" class="TXT mt-2"><b><u>Prénom : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 70%;"> 
																	{# ^[a-zA-Z_ ]*$ #}
																	<input type="text" name="prenom" maxlength="100" id="prenom"   class="form-control form-control-sm mt-2" 
																		 required onkeyup="this.value=this.value.toUpperCase()">
																	<span style="color: red;" id="ninprenom"></span>
																</td>
															</tr>
								
															<tr>
																<td style="width: 30%;">
																	<label for="" class="TXT mt-2"><b><u>Nom : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 70%;">
																	<input type="text" name="nom" maxlength="100" id="idnom" <input type="text"  onkeyup="this.value=this.value.toUpperCase()" class="form-control form-control-sm mt-2" required>
																	<span style="color: red;" id="ninnom"></span>
																</td>
															</tr>
								
															<tr>
																<td style="width: 30%;">
																	<label for="" class="TXT mt-2"><b><u>Sexe : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 70%;">
																	<select style="width: 50%;" class="form-control form-control-sm mt-2 classselect" name="sexe" id="idsexe" aria-readonly="true">
																		<option value=""></option>																	
																	</select>																
																	<span style="color: red;" id="ninsexe"></span>
																</td>
															</tr>
								
															<tr>
																<td style="width: 30%;">
																	<label for="" class="TXT mt-2"><b><u>Date de naissance : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 70%;">
																	<input type="date" style="width: 50%;" name="datenais" id="idDatenais"  min="1900-01-01"  class="form-control form-control-sm mt-2" required>
																	<span style="color: red;" id="nindatenais"></span>
																</td>
															</tr>
								
															<tr>
																<td style="width: 30%;">
																	<label for="" class="TXT mt-2"><b><u>Lieu de naissance : </u></b></label>
																	<span style="color: red;">*</span>

																</td>
																<td style="width: 70%;">
																	<input type="text" maxlength="100" name="lieunais" id="idlieunais" onkeyup="this.value=this.value.toUpperCase()"
																		class="form-control form-control-sm mt-2" value="" autocomplete="off" required>
																	<span style="color: red;" id="ninlieunais"></span>
																</td>
															</tr>
															
														</table>

														<table style="width: 100%; " class="mt-2">
															<tr>
																<td style="width: 30%;">
																	<label for="" class="TXT "> <b><u>Nationalité : </u></b>  </label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 70%;">
																	<select style="width: 50%;" class="form-control form-control-sm classselect select2 " name="nationalite" required id="idnationalite_personne">
																		<option value="" selected>
																			Sélectionner</option>
																		{% for tag in nationalites %}
																			<option value="{{tag.id}}" {% if tag.id =="SN" %} selected {% endif %}>
																				{{tag.id}}-{{ tag.libelle}}</option>
																		{% endfor %}
																	</select>
																	<span style="color: red;" id="ninationalite"></span>
																</td>
															</tr>
														</table>
								
														<div id="tableCni_personne">
															<table  style="width: 100%;">
																<tr id="trcni">
																	<td style="width: 30%;">
																		<label for="" class="TXT mt-2"> <b><u>CNI : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 70%;" >
																	  
																		<input type="password" name="cni" id="idcni" readonly onfocus="this.removeAttribute('readonly');" required autocomplete="off" class="form-control  form-control-sm mt-2 classselect" 
																			maxlength = '14' onkeyup="this.value=this.value.toUpperCase()" onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																			oninput="this.value = this.value.replace(/[^A-Za-z0-9]/g, '');" >
																		<span style="color: red;" id="nincni"></span>
																	</td>
																</tr>
																<tr id="">
																	<td style="width: 30%;">
																		<label for="" class="TXT mt-2" id="labelconfirmcni"> <b><u>Confirmation CNI : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 70%;" >
																		<input type="text" name="confirm_cni" id="idConfirmcni" required class="form-control form-control-sm mt-2 classselect" 
																			maxlength = '14'  required onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																			oninput="this.value = this.value.replace(/[^A-Za-z0-9]/g, '');" onkeyup="this.value=this.value.toUpperCase()" >
																		<span style="color: red;" id="ninconfcni"></span>
																	</td>
																</tr>
									
																<tr id="trcni">
																	<td style="width: 30%;">
																		<label for="" class="TXT mt-2"><b><u>Date de délivrance  : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 70%;" >
																		<input type="date" style="width: 50%;" name="datecni" id="idDatecni"  min="1901-01-01" class="form-control form-control-sm mt-2 classselect" required>
																		<span style="color: red;" id="ninDatecni"></span>
																	</td>
																</tr>
															</table>
														</div>
														
														<div  id="tablePassport_personne" class="mt-2"> 
															<table style="width: 100%;">
																<tr id="trPassport">
																	<td style="width: 30%;">
																		<label for="" class="TXT ">	<b><u>Passport : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 70%;">
																		<input type="password" name="passport" id="idpassport" maxlength = '14' oninput="this.value = this.value.replace(/[^A-Za-z0-9]/g, '');" 
																		class="form-control form-control-sm classselect" onkeyup="this.value=this.value.toUpperCase()"  onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																		readonly onfocus="this.removeAttribute('readonly');">
																		<span style="color: red;" id="ninpassport"></span>
																	</td>
																</tr>
																<tr >
																	<td style="width: 30%;">
																		<label for="" class="TXT mt-2" id="labelconfirmpassport"> <b><u>Confirmation PP : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 70%;" >
																		<input type="text" name="confirm_passport" id="idConfirmpassport" required onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																			class="form-control form-control-sm  mt-2" 
																			maxlength = '14'  onkeyup="this.value=this.value.toUpperCase()"
																			oninput="this.value = this.value.replace(/[^A-Za-z0-9]/g, '');" value="" >
																		<span style="color: red;" id="ninconfpassport"></span>
																	</td>
																</tr>
																<tr id="trDatePassport">
																	<td style="width: 30%;">
																		<label for="" class="TXT mt-2"><b><u>Date du passport  : </u></b></label>
																	</td>
																	<td style="width: 70%;">
																		<input type="date" style="width: 50%;" name="datepassport" id="idDatepassport" min="1901-01-01" class="form-control form-control-sm mt-2 classselect">
																		<span style="color: red;" id="nindatepassport"></span>
																	</td>
																</tr>
															</table>
														</div>
														<table style="width: 100%;">
															<tr>
																<td style="width: 30%;">
																	<label for="" class="TXT mt-2"><b><u>Téléphone : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 70%;">
																	<input  type="text" name="telephone" maxlength = '9' id="idtelpersonne" value="" oninput="this.value = this.value.replace(/[^0-9,]/g, '');" 
																		class="form-control form-control-sm mt-2 classselect" required>
																	<span style="color: red;" id="nintelpersonne"></span>
																</td>
															</tr>
															<tr>
																<td style="width: 30%;">
																	<label for="" class="TXT mt-2"><b><u>Email : </u></b></label>
																</td>
																<td style="width: 70%;">
																	<input type="email" name="email" id="idemailpersonne"  autocomplete="off" class="form-control form-control-sm mt-2 classselect">
																	<span style="color: red;" id="ninemail_personne"></span>
																</td>
															</tr>
														</table>
																
													</fieldset>
													
												</div>
								
												<div class="col-lg-6">
													<fieldset class="border p-2">										
														<table style="width: 100%;">
															<tr>
																<td style="width: 40%;">
																	<label for="" class="TXT mt-2"> <b><u>Type Voie : </u></b> </label>
																</td>
								
																<td style="width: 60%;">
																	<select class="form-control form-control-sm mt-2 classselect" name="typevoie" value="" id="idtypevoie" >
																		<option value="" selected >			Sélectionner</option>
																		{% for tag in typevoies %}
																			<option value="{{ tag.id}}">			{{tag.tyvlibelle}}</option>
																		{% endfor %}
																	</select>
																	<span style="color: red;" id="nintypevoie"></span>
																</td>
															</tr>
								
															<tr>
																<td style="width: 40%;">
																	<label for="" class="TXT mt-2"><b><u>Voie : </u></b>  </label>

																</td>
																<td style="width: 60%;">
																	<input type="text" name="voie"  maxLength="50" id="idvoie" onkeyup="this.value=this.value.toUpperCase()" class="form-control form-control-sm mt-2" >
																</td>
															</tr>
															<tr>
																<td style="width: 40%;">
																	<label for="numvoie" class="TXT mt-2"> <b><u>Numero de la voie : </u></b> </label>
																</td>
																<td style="width: 60%;">
																	<input type="text" maxLength="5" name="numvoie" id="idNumvoie" oninput="this.value = this.value.replace(/[^0-9,]/g, '');" class="form-control form-control-sm mt-2" >
																</td>
															</tr>
															<tr>
																<td style="width: 40%;">
																	<label for="numvoie" class="TXT mt-2"><b><u>Région : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 60%;">
																	<select class="form-control form-control-sm select2 mt-2 classselect" name="region" id="region" style="width: 100%;">
																		<option value="">Sélectionner ...</option>
																		{% for tag in regions %}
																			<option value="{{tag.id}}">{{tag.libelle}}</option>
																			{% endfor%}
																		</select>
																		<span style="color: red;" id="ninregion"></span>
																	</td>
																</td>
															</tr>
															<tr>
																<td style="width: 40%;">
																	<label for="numvoie" class="TXT mt-2"><b><u>Département : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 60%;">
																	<select class="form-control form-control-sm select2 mt-2 classselect" name="departement" id="departement" style="width: 100%;">
																		<option  value="0">Selectionner ...</option>
																	</select>
																	<span style="color: red;" id="nindepartement"></span>
																</td>
															</tr>
															<tr>
																<td>
																	<label for="numvoie" class="TXT"><b><u>Com/Ville/Arr : </u></b>:</label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 60%;">
																	<select class="form-control form-control-sm select2 mt-2 classselect" name="cav" id="cav" style="width: 100%;">
																		<option  value="">Selectionner ...</option>
																	</select>
																	<span style="color: red;" id="nincav"></span>
																</td>
															</tr>
								
															<tr>
																<td style="width: 40%;">
																	<label for="basicpill-firstname-input" class="TXT mt-2">	<b><u>CA/CR: </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 60%;">
																	<select class="form-control form-control-sm select2 mt-2 classselect" name="cacr" id="cacr" style="width: 100%;">
																		<option  value="0">Selectionner ...</option>
																	</select>
																	<span style="color: red;" id="nincacr"></span>
																</td>
															</tr>
															<tr>
								
																<td style="width: 40%;">
																	<label for="basicpill-firstname-input" class="TXT mt-2">
																		<b><u>Quartier/Village/Hameau : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 60%;">
																	<select  required class="form-control form-control-sm select2 mt-2 classselect" name="qvh" id="qvh" style="width: 100%;" >
																		<option  value="0">Selectionner ...</option>
																	</select>
																	<span style="color: red;" id="ninqvh"></span>
																</td>
															</tr>	
															<tr>				
																<td style="width: 40%;">
																	<label for="basicpill-firsAdresse complète:tname-input mt-2" class="TXT">
																		<b><u>Adresse domicile : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 60%;">
																	<input type="text" name="adresse" id="idadresse" value="" 
																	onkeyup="this.value=this.value.toUpperCase()" class="form-control form-control-sm mt-2 classselect" required>
																	<span style="color: red;" id="ninadresse"></span>
																</td>
															</tr>

														</table>	
													</fieldset>
								
												</div>
											</div>
						
										</div>
									{% else %}
										{% if (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 21) or (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 22)%}
											<div id="idMorale"  class="col-lg-8" >
												<fieldset class="border p-2">
													<center>			
														<table style="width: 100%;">
															<tr >
																<td style="width: 20%;">
																	<label for="" class="TXT"><b><u>Raison sociale : </u></b></label>
																	<span style="color: red;">*</span>
																</td>
																<td style="width: 80%;" >
																	<textarea name="raison"  id="idraison" cols="10" rows="5" class="form-control form-control-sm" onkeyup="this.value=this.value.toUpperCase()" required value=""  >  </textarea>
																	<span style="color: red;" id="ninraison"></span>
																</td>
															</tr>
							
															<tr >
																<td style="width: 20%;">
																	<label for="" class="TXT mt-2"><b><u>Sigle : </u></b></label>
																</td>
																<td style="width: 80%;" >
																	<input style=" width:40%;" type="text" name="sigle" id="idSigle" onkeyup="this.value=this.value.toUpperCase()" class="form-control form-control-sm mt-2" value="">
																	<span style="color: red; width:20%;" id="ninsigle"></span>
																</td>
															</tr>
														</table>
													</center>
												</fieldset>
											</div>
										{% endif %}
									{% endif %}
											<div class="row mt-3">
												<div class="col-lg-9">		</div>

												{% if (ni_nineaproposition.ninStatut.id == 2 )  and ( (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 11 ) or (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 12 ) ) %}
													
														<div class="col-lg-3" align="right">
															<input type="button" value="Suivant" name="ajouter" onclick="verificationInfosNINET();" id="btnSuivantPP" class="boutonsm">
															<input type="button" value="Suivant" name="ajouter" id="btnSuivant" style="display:none" class="boutonsm">
														</div>
													{% else %}
														<div class="col-lg-3 mt-4" align="right">
															<input type="button" value="Suivant" name="ajouter"  id="btnSuivant"  class="boutonsm">
														</div>
													{% endif %}
												{# <div class="col-lg-3 mt-4" align="right">
													<input type="button" value="Suivant" name="ajouter" id="btnSuivant" class=" boutonsm" 			>
												</div> #}
											</div>
								</form>
								
							{% endif %}
							
						</div>

						
						<div class="tab-pane " id="coordonnees" role="tabpanel">
							<div class="col-lg-12">					
								<fieldset class=" p-2 fieldcolor ">
									<div class="row">
										{% if ni_nineaproposition.coordonnees|length>0 %} 
											{% for tag in ni_nineaproposition.coordonnees %}
												
												<form action="{{path('ni_nineaproposition_editCoordonnees',{id:tag.id})}}" method="post"
												>
													<div class="row">
														<div class="col-lg-6">
										
															<fieldset class="border p-2">													
																<table style="width: 100%;">
																	<tr>
																		<td style="width: 50%;">
																			<label for="" class="TXT "> <b><u>Type Voie : </u></b> </label>
																		</td>
										
																		<td style="width: 50%;">
																			<select class="form-control form-control-sm classselect" name="typevoie" value="" id="idtypevoie_add_edit" >
																				<option value="" selected >			Sélectionner</option>
																				{% for tagv in typevoies %}
																				     {% if tag.ninTypevoie is not null %}
																						{% if tagv.id == tag.ninTypevoie.id %}
																							<option value="{{ tagv.id }}" selected> {{ tagv.tyvlibelle}}</option>
																						{% else %}
																							<option value="{{ tagv.id }}" > {{ tagv.tyvlibelle}}</option>
																						{% endif %}
																					{% else %}
																						<option value="{{ tagv.id }}" > {{ tagv.tyvlibelle}}</option>
																					{% endif %}
																				{% endfor %}
																			</select>
																			<span style="color: red;" id="nintypevoie_add_edit"></span>
																		</td>
																	</tr>
										
																	<tr>
																		<td style="width: 50%;">
																			<label for="" class="TXT mt-2"><b><u>Voie : </u></b>  </label>
																		</td>
																		<td style="width: 50%;">
																			<input type="text" name="voie"  maxLength="50" id="idvoie_add_edit" onkeyup="this.value=this.value.toUpperCase()" value="{{ tag.ninVoie}}" class="form-control form-control-sm mt-2">
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 50%;">
																			<label for="numvoie" class="TXT mt-2"> <b><u>Numero de la voie : </u></b> </label>
										
																		</td>
																		<td style="width: 50%;">
																			<input type="text" maxLength="5" name="numvoie" id="idNumvoie_add_edit" value="{{tag.ninnumVoie}}" class="form-control form-control-sm mt-2">
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 50%;">
																			<label for="numvoie" class="TXT mt-2"> <b><u>Région : </u></b> </label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 40%;">
																			<select class="form-control select2 form-control-sm  mt-2 classselect" name="region" required id="region_coordonnees" style="width: 100%;">
																				<option>Sélectionner ...</option>
																					{% for tagr in regions %}
																						{% if tagr.id == tag.qvh.qvhCACRID.cacrCAVID.cavDEPID.depRegCD.id %}
																							<option value="{{ tagr.id }}" selected> {{ tagr.libelle}}</option>
																						{% else %}
																							<option value="{{ tagr.id }}" > {{ tagr.libelle}}</option>
																						{% endif %}

																					{% endfor %}
																				</select>
																				<span style="color: red;" id="ninregion"></span>
																			</td>
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 50%;">
																			<label for="numvoie" class="TXT mt-2"> <b><u> Département : </u></b> </label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 40%;">
																			<select class="form-control form-control-sm   select2 classselect mt-2" name="departement" required id="departement_coordonnees" style="width: 100%;">
																				{% if tag.qvh.qvhCACRID.cacrCAVID.cavDEPID %}
																					<option value="{{ tag.qvh.qvhCACRID.cacrCAVID.cavDEPID.id }}" selected> {{ tag.qvh.qvhCACRID.cacrCAVID.cavDEPID.description}}</option>
																				{% else %}
																						<option value="" >Sélectionner ...</option>
																				{% endif %}
																			</select>
																			<span style="color: red;" id="nindepartement"></span>
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 50%;">
																			<label for="numvoie" class="TXT mt-2"><b><u>CAV : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 40%;">
																			<select class="form-control form-control-sm   select2 classselect mt-2" name="cav" required id="cav_coordonnees" style="width: 100%;">
																				{% if tag.qvh.qvhCACRID.cacrCAVID %}
																					<option value="{{ tag.qvh.qvhCACRID.cacrCAVID.id }}" selected> {{ tag.qvh.qvhCACRID.cacrCAVID.libelle}}</option>
																				{% else %}
																					<option value="" ></option>
																				{% endif %}												
																			</select>
																			<span style="color: red;" id="nincav"></span>
																		</td>
																	</tr>
										
																	<tr>
																		<td>
																			<label for="basicpill-firstname-input" class="TXT mt-2"><b><u>Comm d'arr/Comm rurale : </u></b>           </label>
																			<span style="color: red;">*</span>
																		</td>
																		<td>
																			<select class="form-control form-control-sm  classselect select2 mt-2" name="cacr" id="cacr_coordonnees" required style="width: 100%;">
																				{% if tag.qvh.qvhCACRID %}
																							<option value="{{ tag.qvh.qvhCACRID.id }}" selected> {{ tag.qvh.qvhCACRID.libelle}}</option>
																						{% else %}
																								<option value="" ></option>
																						{% endif %}
																			</select>
																			<span style="color: red;" id="nincacr"></span>
																		</td>
																	</tr>
																	<tr>
										
																		<td style="width: 30%;">
																			<label for="basicpill-firstname-input" class="TXT mt-2"><b><u>Quartier/Village/Hameau : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 70%;">
																			<select class="form-control form-control-sm  select2 classselect mt-2" name="qvh" id="qvh_coordonnees" required style="width: 100%;">
																				{% if tag.qvh %}
																						<option value="{{ tag.qvh.id }}" selected> {{ tag.qvh.libelle}}</option>
																					{% else %}
																						<option value="" ></option>
																					{% endif %}
																			</select>
																			<span style="color: red;" id="ninqvh"></span>
																		</td>
																	</tr>
										
																</table>
										
															</fieldset>
														</div>
										
														<div class="col-lg-6">
															<fieldset class="border p-2">													
																<table style="width: 100%;">
																	<tr>
																		<td style="width: 50%;">
																			<label for="" class="TXT mt-2"><b><u>Adresse de l'établissement : </u></b></label>
																			<span style="color: red;">*</span>
										
																		</td>
																		<td style="width: 50%;">
																			<input type="text" name="adresse1" id="idadresse1" onkeyup="this.value=this.value.toUpperCase()" 
																				value="{{tag.ninadresse1}}	" required class="form-control form-control-sm mt-2">
																		</td>
																	</tr>
																	
																	<tr>
																		<td style="width: 50%;">
																			<label for="" class="TXT mt-2"><b><u>Téléphone 1 : </u></b></label>
																			<span style="color: red;">*</span>
										
																		</td>
																		<td style="width: 50%;">
																			<input type="text" name="telephone1" id="idtelephone1" value="{{tag.ninTelephon1}}" required class="form-control form-control-sm"
																			maxlength = '9'  value="" oninput="this.value = this.value.replace(/[^0-9,]/g, '');">
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 50%;">
																			<label for="" class="TXT mt-2"><b><u>Téléphone 2 : </u></b></label>
																		</td>
																		<td style="width: 50%;">
																			<input type="text" name="telephone2" id="idtelephone2" value="{{tag.nintelephon2}}"  maxlength="9"
																			oninput="this.value.replace(/[^0-9,]/g, '');" class="form-control form-control-sm mt-2">
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 50%;">
																			<label for="" class="TXT mt-2"><b><u>Email : </u></b></label>
																		</td>
																		<td style="width: 40%;">
																			<input type="text" name="email" id="idemail" value="{{tag.ninEmail}}" class="form-control form-control-sm mt-2">
																		</td>
																	</tr>
										
																	<tr>
																		<td style="width: 50%;">
																			<label for="" class="TXT mt-2"><b><u>Boite postale : </u></b></label>
																		</td>
																		<td style="width: 40%;">
																			<input type="text" name="bp" id="idbp" value="{{tag.ninBP}}" class="form-control form-control-sm mt-2">
																		</td>
																	</tr>
																	<tr>
																		<td style="width: 30%;">
																			<label for="" class="TXT mt-2"><b><u>Site web : </u></b></label>
																		</td>
																		<td style="width: 70%;">
																			<input type="text" name="url" id="idurl" value="{{tag.ninUrl}}" class="form-control form-control-sm mt-2">
																		</td>
																	</tr>
																</table>
										
															</fieldset>
														</div>
															

															{% if ni_nineaproposition.statut == 'c' %}
																{% if is_granted('ROLE_NINEA_ADMIN') or is_granted('ROLE_VALIDER_DEMANDE_NINEA')  %} 
												
																<div class="row">
								                                   <div class="col-lg-12">
								                                    	<div class="mb-3 row">
									                                    	<label class="col-md-9" for="basicpill-firstname-input"></label>
									                                 	   <div class="col-md-3" align="right">
																		      <table width="100%" class="mt-4">
																				    <tr>
																						<td width="50%">  <input type="button" value="Precedent" name="precedent" id="idBtnPrecedentCoordonnees" class="boutonsm"></td>
																						<td width="50%"><input type="submit"  value="Suivant" name="editer" id="idBtnSuivantCoordonnees" class="boutonsm"></td>
																						
																				    </tr>
																			  </table>
									                                		
									                                	   </div>
									                                	   
								                                        </div>
							                                        </div>
							                                    </div>
																{% endif %}

																{% else %}

																<div class="row">
								                                   <div class="col-lg-12">
								                                    	<div class="mb-3 row">
									                                    	<label class="col-md-9" for="basicpill-firstname-input"></label>
									                                 	   <div class="col-md-3" align="right">
																		       <table width="100%" class="mt-4">
																				    <tr>
																						<td width="50%"> <input type="button" value="Precedent" name="precedent" id="idBtnPrecedentCoordonnees" class="boutonsm"></td>
																						<td width="50%"><input type="submit"  value="Suivant" name="editer" id="idBtnSuivantCoordonnees" class="boutonsm"></td>
																						
																				    </tr>
																				</table>
									                                		
									                                	   </div>
									                                	    
								                                        </div>
							                                        </div>
							                                    </div>
																
													   {% endif %}
													</div>
										
												</form>
												
												
											{% endfor %}

										{% else %}

											<form action="{{path('ajouterCoordonnees',{id:app.request.attributes.get('id')})}}" method="post" autocomplete="off"
												>
												<div class="row">
													<div class="col-lg-6">									
														<fieldset class="border p-2">													
															<table style="width: 100%;">
																<tr>
																	<td style="width: 50%;">
																		<label for="" class="TXT mt-2"> <b><u>Type Voie : </u></b> </label>
																	</td>
									
																	<td style="width: 50%;">
																		<select class="form-control form-control-sm mt-2 classselect" name="typevoie" value="" id="idtypevoie_add"  >
																			<option value="0" selected >	Sélectionner</option>
																			{% for tag in typevoies %}
																				<option value="{{ tag.id}}">
																					{{tag.tyvlibelle}}</option>
																			{% endfor %}
																		</select>
																		<span style="color: red;" id="nintypevoie_addd"></span>
																	</td>
																</tr>
									
																<tr>
																	<td style="width: 50%;">
																		<label for="" class="TXT mt-2"><b><u>Voie : </u></b>  </label>
																	</td>
																	<td style="width: 50%;">
																		<input type="text" name="voie"  maxLength="50"  id="idvoie_add" onkeyup="this.value=this.value.toUpperCase()" class="form-control form-control-sm mt-2">
																	</td>
																</tr>
																<tr>
																	<td style="width: 50%;">
																		<label for="numvoie" class="TXT mt-2"> <b><u>Numero de la voie : </u></b> </label>
									
																	</td>
																	<td style="width: 50%;">
																		<input type="text" maxLength="5" name="numvoie" id="idNumvoie_add" oninput="this.value = this.value.replace(/[^0-9,]/g, '');" class="form-control form-control-sm mt-2">
																	</td>
																</tr>
																<tr>
																	<td style="width: 50%;">
																		<label for="numvoie" class="TXT mt-2"> <b><u>Région : </u></b> </label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 40%;">
																		<select class="form-control select2 form-control-sm mt-2 classselect" name="region" required id="region_coordonnees" style="width: 100%;">
																			<option>Sélectionner ...</option>
																			{% for tag in regions %}
																				<option value="{{tag.id}}">{{tag.libelle}}</option>
																				{% endfor%}
																			</select>
																			<span style="color: red;" id="ninregion"></span>
																		</td>
																	</td>
																</tr>
																<tr>
																	<td style="width: 50%;">
																		<label for="numvoie" class="TXT mt-2"> <b><u> Département : </u></b> </label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 40%;">
																		<select class="form-control form-control-sm mt-2 classselect  select2" name="departement" required id="departement_coordonnees" style="width: 100%;">
																			<option>Sélectionner ...</option>
																		</select>
																		<span style="color: red;" id="nindepartement"></span>
																	</td>
																</tr>
																<tr>
																	<td style="width: 50%;">
																		<label for="numvoie" class="TXT mt-2"><b><u>Comm/Vill/Arro : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 40%;">
																		<select class="form-control form-control-sm  classselect mt-2 select2" name="cav" required id="cav_coordonnees" style="width: 100%;">
																			<option>Sélectionner ...</option>
																		</select>
																		<span style="color: red;" id="nincav"></span>
																	</td>
																</tr>
									
																<tr>
																	<td>
																		<label for="basicpill-firstname-input" class="TXT mt-2"><b><u>Comm d'arr/Comm rurale : </u></b>           </label>
																		<span style="color: red;">*</span>
																	</td>
																	<td>
																		<select class="form-control form-control-sm  classselect mt-2 select2" name="cacr" id="cacr_coordonnees" required style="width: 100%;">
																			<option> Sélectionner ...</option>
																		</select>
																		<span style="color: red;" id="nincacr"></span>
																	</td>
																</tr>
																<tr>
									
																	<td style="width: 30%;">
																		<label for="basicpill-firstname-input" class="TXT mt-2"><b><u>Quartier/Village/Hameau : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 70%;">
																		<select class="form-control form-control-sm classselect mt-2 select2" name="qvh" id="qvh_coordonnees" required style="width: 100%;">
																			<option value=""> Sélectionner ...</option>
																		</select>
																		<span style="color: red;" id="ninqvh"></span>
																	</td>
																</tr>
									
															</table>
									
														</fieldset>
													</div>
									
													<div class="col-lg-6">
														<fieldset class="border p-2">													
															<table style="width: 100%;">
																<tr>
																	<td style="width: 50%;">
																		<label for="" class="TXT mt-2"><b><u>Adresse de l'établissement : </u></b></label>
																		<span style="color: red;">*</span>
									
																	</td>
																	<td style="width: 50%;">
																		<input type="text" name="adresse1" id="idadresse1" value="" required onkeyup="this.value=this.value.toUpperCase()"  class="form-control form-control-sm mt-2">
																		<span style="color: red;" id="ninadresse1"></span>
																	</td>
																</tr>
																
																<tr>
																	<td style="width: 50%;">
																		<label for="" class="TXT mt-2"><b><u>Téléphone 1 : </u></b></label>
																		<span style="color: red;">*</span>
									
																	</td>
																	<td style="width: 50%;">
																		<input type="text" name="telephone1" id="idtelephone1" value="" oninput="this.value = this.value.replace(/[^0-9,]/g, '');" required maxlength="9" class="form-control form-control-sm mt-2">
																	</td>
																</tr>
																<tr>
																	<td style="width: 50%;">
																		<label for="" class="TXT mt-2"><b><u>Téléphone 2 : </u></b></label>
																	</td>
																	<td style="width: 50%;">
																		<input type="text" name="telephone2" id="idtelephone2" value=""  maxlength = '9'  value="" oninput="this.value = this.value.replace(/[^0-9,]/g, '');" class="form-control form-control-sm mt-2">
																	</td>
																</tr>
																<tr>
																	<td style="width: 50%;">
																		<label for=" class="TXT mt-2""><b><u>Email : </u></b></label>
																	</td>
																	<td style="width: 40%;">
																		<input type="text" name="email" id="idemail" value="" class="form-control form-control-sm mt-2">
																	</td>
																</tr>
									
																<tr>
																	<td style="width: 50%;">
																		<label for="" class="TXT mt-2"><b><u>Boite postale : </u></b></label>
																	</td>
																	<td style="width: 40%;">
																		<input type="text" name="bp" id="idbp" value="" class="form-control form-control-sm mt-2">
																	</td>
																</tr>
																<tr>
																	<td style="width: 30%;">
																		<label for="" class="TXT mt-2"><b><u>Site web : </u></b></label>
																	</td>
																	<td style="width: 70%;">
																		<input type="text" name="url" id="idurl" value="" class="form-control form-control-sm mt-2">
																	</td>
																</tr>
															</table>
									
														</fieldset>
													</div>
												</div>


												<div class="row">
												<div class="col-lg-12">
													<div class="row">
														<label class="col-md-9" for="basicpill-firstname-input"></label>
														<div class="col-md-3" align="right">
														    <table width="100%" class="mt-4">
															   <tr>
															   		<td width="50%"><input type="button" value="Precedent" name="precedent" id="idBtnPrecedentCoordonnees" class="boutonsm"></td>
															   		<td width="50%"><input type="submit"  value="Suivant" name="ajouter" id="idBtnSuivantCoordonnees" class="boutonsm"></td>
															   		
															   </tr>
															</table>
															
														</div>
														
													</div>
												</div>
												</div>
									
											</form>
										{% endif %}
										
									</div>
								</fieldset>				
							</div>
						</div>


						<div class="tab-pane" id="activites" role="tabpanel">							

				          	<div class="w-100">
								<div class="col-lg-12 justify-content-center"> 
									<form name="formActivites" action="{{path('activiteEtProduits',{id:app.request.attributes.get('id')})}}" method="post" id="formajouterActivite">

										<fieldset class="fieldcolor p-2 mb-3">
												<div class="row justify-content-center">
													<div class="col-lg-10">
													    <table width="100%" >
														    <tr>
															   <td width="20%">
																	<label for="" > <b><u> Libellé de l'ativité</u></b> </label>
											                   </td>
															   <td width="80%">
																	<textarea name="libelleactiviteglobale" id="txtLibelleact" onkeyup="this.value=this.value.toUpperCase()" cols="5" rows="3" value="" class="form-control form-control-sm classselect"
																required style="font-weight: bold; padding: 0;">{{ activiteglobale  }}</textarea>
																<span id="ninLibelleact" style="color: red;"></span>
											                   </td>
															</tr>
														</table>
														
													</div>
												</div>

													{% if statut == 'c' %}
														{% if is_granted('ROLE_NINEA_ADMIN') or is_granted('ROLE_VALIDER_DEMANDE_NINEA')  %} 

															<label for="basicpill-address-input" class="mt-4">
															  {% if ni_nineaproposition.statut == "b" or  ni_nineaproposition.statut == "t" %}
																<button type="button" id="btnAjouterActivities"  class="boutonsm "><i class="fas fa-plus-circle"></i> 
																	Ajouter
																</button>
																 {% endif %}
															</label>

														   
														{% endif %}

													{% else %}
														<label for="basicpill-address-input" class="mt-4">
														{% if ni_nineaproposition.statut == "b" or  ni_nineaproposition.statut == "t" %}
															<button type="button" id="btnAjouterActivities"  class="boutonsm "><i class="fas fa-plus-circle"></i> Ajouter
															</button>
														{% endif %}
														</label>

													{% endif %}

												<div class="row">
													<div class="col-lg-12 table-responsive-lg">
														<table id="idtab" class="table table-bordered  table-hover " style="width: 100% ;">
															<thead class="tr_entete" >
																<tr>
																	<th>Libelle</th>
																	<th >NAEMA</th>
																	<th >Produits</th>
																	<th >Statut</th>
																	<th >Action</th>
																</tr>
															</thead>
														<tbody id="idActivities"></tbody>
														{% set nb = 0 %}
															
														{% for tagact in ninactivites %}
															{% set nb = nb + 1 %}
															<tr>
																<td style="width: 20%;">
																	<input type="text" {% if tagact.statActivprincipale == 1 %}  {% endif %} name="ninAutact{{ nb }}" id="idninAutact{{ nb }}" value="{{tagact.ninAutact}}" class="form-control form-control-sm mt-2" required>
																	{% if nb == 1 %}
																		<input type="hidden" name="nbActivites" id="idnbActivites">
																	{% endif %}
																</td>
																<td style="width: 30%;">				                      
																	<select  class="form-control form-control-sm select2 classselect " name="refNaema{{ nb }}"   id="idrefNaema{{ nb }}" required>
																		{% for tagN in naemas %}
																			{% if tagN.id == tagact.refnaema.id %}
																				<option value="{{tagN.id}}" selected> {{tagN.id}}-{{ tagN.libelle}}</option>
																			{% else %}
																				<option value="{{tagN.id}}"> {{tagN.id}}-{{ tagN.libelle}}</option>
																			{% endif %}
																		{% endfor %}
																	</select>
																</td>
																<td style="width: 30%;">
																	<select class="select2 form-control select2-multiple selectproduit classselect" name="refProduit{{ nb }}[]" required   id="idrefProduit{{ nb }}"
																			multiple="multiple" data-placeholder="Selectionner...">
																		{% for tagP in ninproduits %}
																			{% if tagP.refproduits.naema.id == tagact.refnaema.id %}
																				<option value="{{tagP.refproduits.id}}" selected> {{tagP.refproduits.id}}-{{ tagP.refproduits.libelle}}</option>
																			{% endif %}
																		{% endfor %}

																		{% for tagPR in produits %}
																		{% if tagPR.naema.id == tagact.refnaema.id %}
																			{% set bProduitExiste = false %}
																			{% for tagP in ninproduits %}
																				{% if tagP.refproduits.id == tagPR.id %}
																					{% set bProduitExiste = true %}
																					
																				{% endif %}
																			{% endfor %}
																			{% if bProduitExiste == false %}
																				<option value="{{tagPR.id}}"> {{tagPR.id}}-{{ tagPR.libelle}}</option>
																			{% endif %}
																		{% endif %}
																		{% endfor %}

																	</select>
																</td>
																{% if tagact.statActivprincipale == 1 %}
																<td>
																		<label for="">Principale</label>
																</td>
																{% else %}
																<td>
																	<label for="">Secondaire</label>
																</td>
																{% endif %}
																<td>
																	{% if tagact.statActivprincipale != 1 %}
																		<input  id="idBtnSupprimerDirigeant{{ nb }}" class="boutonsm" type="submit" onclick="suppActiviteEtProduits('{{tagact.id}}');" value="Supprimer" >
																	{% endif %}
																</td>
															</tr>
															{% endfor %}

															{% if nb == 0 %}
																<tr>
																<td style="width: 20%;">
																	<input  style="width: 100%;" type="text" name="ninAutact1" id="idninAutact1" class="form-control form-control-sm " onkeyup="this.value=this.value.toUpperCase()" required>
																	<input type="hidden" name="nbActivites" id="idnbActivites">
																	<span id="ninAutact1" style="color: red;"></span>
																</td>
																<td style="width: 30%;">				                      
																	<select style="width: 100%;background-color :#D6EAF8;"  class="form-control form-control-sm select2 classselect" name="refNaema1"   id="idrefNaema1" required>
																		<option value="" selected> Sélectionner...</option>
																		{% if ni_nineaproposition.ninFormejuridique.id == 98  %}
																			{% for tag in naemas %}
																				{% if tag.id == "4800" %}
																				<option value="{{tag.id}}"> {{tag.id}}-{{ tag.libelle}}</option>
																				{% endif %}
																			{% endfor %}
																		{% else %}
																			{% if ni_nineaproposition.ninFormejuridique.id == 99  %}

																				{% for tag in naemas %}
																						{% if tag.id == "9803" %}
																						<option value="{{tag.id}}"> {{tag.id}}-{{ tag.libelle}}</option>
																						{% endif %}
																				{% endfor %}
																			{% else %}
																					{% if ni_nineaproposition.ninFormejuridique.id == 94  %}
																							{% for tag in naemas %}
																									{% if tag.id == "9901" %}
																									<option value="{{tag.id}}"> {{tag.id}}-{{ tag.libelle}}</option>
																									{% endif %}
																							{% endfor %}
 
																					{% else %}

																							{% for tag in naemas %}
																							   {% if tag.id != "9901" and tag.id != "9803" and tag.id != "4800"   %}
																									<option value="{{tag.id}}"> {{tag.id}}-{{ tag.libelle}}</option>
																								{% endif %}
																							{% endfor %}

																			        {% endif %}
																			{% endif %}


																		{% endif %}
																		
																	</select>
																</td>
																<td style="width: 30%;">
																	<select style="width: 100%; background-color :#D6EAF8;" class="select2 form-control select2-multiple selectproduit classselect" name="refProduit1[]" required   id="idrefProduit1"
																			multiple="multiple" data-placeholder="Selectionner...">
																	</select>
																</td>
																<td>
																	<label for="">Principale</label>
																</td>
															</tr>
															{% endif %}
														</tbody>
														</table>
													</div>
												</div>
					
												<div class="row">
													<div class="col-lg-12 table-responsive-lg">
														<div class="row">
															<label class="col-md-9" for="basicpill-firstname-input"></label>
														<div class="col-md-3" align="right">
														    <table width="100%" class="mt-4">
															   <tr>
															   		<td width="50%"><input type="button" value="Precedent" name="precedenter" id="idBtnPrecedentActivites" class="boutonsm"></td>
															   		<td width="50%"><input type="button"  value="Suivant" id="idBtnSuivantActivites" name="ajouter" class="boutonsm"></td>
															   		
															   </tr>
															</table>
															<input type="submit" style="visibility: hidden;" value="1" name="ecohidden" id="ecohidden">
														</div>
														
													</div>
													</div>
												</div>

										</fieldset>

									</form>
								</div>
							</div>
						</div>


						<div class="tab-pane" id="activiteEconomiques" role="tabpanel"> 
								<div class="w-100">
									{% if ni_nineaproposition.niActiviteEconomiques|length>0 %} 
										{% for tag in ni_nineaproposition.niActiviteEconomiques %}

										<div class="col-lg-12 justify-content-center"> 
											<form action="{{path('ni_nineaproposition_editActivitesEconomiques',{id:tag.id})}}" method="post"
												 >

												<div class="row">
													<div class="col-lg-6">

														<table style="width: 100%;">
														
																<tr>																
																	<td style="width: 50%;">
																		<label for="" class="TXT"> <b><u>Chiffre d'affaires : </u></b>   </label>	
																	</td>
																	<td style="width: 50%;">
																		<input type="text" name="ninAffaire" id="idninAffaire"   value="{{  tag.ninAffaire }}" oninput="this.value.replace(/[^0-9,]/g, '');" class="form-control form-control-sm">
																	</td>
																</tr>

																<tr>
																	<td style="width: 50%;">
																		<label for="" class="TXT mt-2"> <b><u> Capital : </u></b>   </label>	
																	</td>
																	<td style="width: 50%;">
																		<input type="text" name="ninCapital" id="ni_activite_economique_ninCapital"  oninput="this.value.replace(/[^0-9,]/g, '');" value="{{tag.ninCapital}}" class="form-control form-control-sm mt-2">
																	</td>
																</tr>

																<tr>
																	<td style="width: 50%;">
																		<label for="" class="TXT mt-2"> <b><u>Effectif permanent : </u></b>   </label>	
																	</td>
																	<td style="width: 50%;">
																		<input type="text" name="ninEffectif" id="idninEffectif"  maxlength="7" value="{{tag.ninEffectif}}" class="form-control form-control-sm">
																	</td>
																</tr>

																<tr>
																	<td style="width: 50%;">
																		<label for="" class="TXT"> <b><u>Effectif permanent féminin:</u></b>   </label>	
																	</td>
																	<td style="width: 50%;">
																		<input type="text" name="ninEffectifFem" id="idninEffectifFem"  maxlength="7" value="{{tag.ninEffectifFem}}" class="form-control form-control-sm">
																	</td>
																</tr>
														</table>
													</div>

											<div class="col-lg-6">
											<table style="width: 100%;">
													<tr>
														<td style="width: 50%;">
															<label for="" class="TXT"> <b><u>Année du chiffres d'affaires :</u></b>   </label>	
														</td>
														<td style="width: 50%;">
															<input type="text" name="ninAnneeCa" id="ni_activite_economique_ninAnneeCa" value="{{tag.ninAnneeCa}}"  maxlength="4" class="form-control form-control-sm input-mask">
														</td>
													</tr>

													<tr>
														<td style="width: 50%;">
															<label for="" class="TXT"> <b><u>Effectif temporaire : </u></b>   </label>	
														</td>
														<td style="width: 50%;">
														<input type="text" name="ninEffect1" id="idninEffect1" value="{{tag.ninEffect1}}"  maxlength="7" class="form-control form-control-sm">
														</td>
													</tr>

													<tr>
														<td style="width: 50%;">
															<label for="" class="TXT"> <b><u>Effectif temporaire féminin : </u></b>   </label>	
														</td>
														<td style="width: 50%;">
															<input type="text" name="ninEffectifFemSAIS" id="idninEffectifFemSAIS"  maxlength="7" value="{{tag.ninEffectifFemSAIS}}" class="form-control form-control-sm">
														</td>
													</tr>

												</table>
										</div>
										
												</div> 

												<div class="row">
													<div class="col-lg-12">
														<div class="mb-3 row">
														<label class="col-md-5" for="basicpill-firstname-input"></label>
														<div class="col-md-5" align="right">
															<input type="button" value="Precedent" name="precedent" id="idBtnPrecedentActivitesEconomiques" class="boutonsm">
														</div>
														<div class="col-md-2" align="right">
														   {% if (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 12 or ni_nineaproposition.ninFormejuridique.niFormeunite.id == 11) %}
															<input type="submit"  value="Modifier" name="modifierActivitesEcos" id="idBtnsuivantActivitesEconomiques" class="boutonsm">
														   {% else %}
															<input type="submit"  value="Suivant" name="modifierActivitesEcos" id="idBtnsuivantActivitesEconomiques" class="boutonsm">
														   {% endif %}
															</div>
														</div>
													</div>
												</div>

											</form>

										</div>
										{% endfor %}

									{% else %}
										
										{{ form_start(form2,{'action':path('ajouterActivite_economique',{id:ni_nineaproposition.id}), 'attr': {'autocomplete': 'off'}})}}
											<div class="row">
												<div class="col-lg-6">
													<table style="width: 100%;">
														<tr>
															<td style="width: 50%;">
																<label for="" class="TXT"> <b><u>Chiffre d'affaires : </u></b>   </label>	
															</td>
															<td style="width: 50%;">

																<input type="text" id="ni_activite_economique_ninAffaire"  name="ni_activite"  oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
																 class="form-control form-control-sm">
															</td>
														</tr>
														
														<tr>
															<td style="width: 50%;">
																<label for="" class="TXT"> <b><u> Capital : </u></b>   </label>	
															</td>
															<td style="width: 50%;">
																{{form_widget(form2.ninCapital)}}
															</td>
														</tr>

														<tr>
															<td style="width: 50%;">
																<label for="" class="TXT"> <b><u>Effectif permanent : </u></b>   </label>	
															</td>
															<td style="width: 50%;">
																{{form_widget(form2.ninEffectif)}}
															</td>
														</tr>

															<tr>
															<td style="width: 50%;">
																<label for="" class="TXT"> <b><u>Effectif permanent féminin:</u></b>   </label>	
															</td>
															<td style="width: 50%;">
																{{form_widget(form2.ninEffectifFem)}}
															</td>
														</tr>
													</table>
												</div>

												<div class="col-lg-6">
													<table style="width: 100%;">
														<tr>
															<td style="width: 50%;">
																<label for="" class="TXT"> <b><u>Année du chiffres d'affaires :</u></b>   </label>	
															</td>
															<td style="width: 50%;">
																{{form_widget(form2.ninAnneeCa)}}
															</td>
														</tr>

															<tr>
															<td style="width: 50%;">
																<label for="" class="TXT"> <b><u>Effectif temporaire : </u></b>   </label>	
															</td>
															<td style="width: 50%;">
																{{form_widget(form2.ninEffect1)}}
															</td>
														</tr>

															<tr>
															<td style="width: 50%;">
																<label for="" class="TXT"> <b><u>Effectif temporaire féminin : </u></b>   </label>	
															</td>
															<td style="width: 50%;">
																{{form_widget(form2.ninEffectifFemSAIS)}}
															</td>
														</tr>

													</table>
												</div>
									
											</div> 

											<div class="row">
												<div class="col-lg-12">
												  <div class="mb-3 row">
													   <label class="col-md-9" for="basicpill-firstname-input"></label>
													    <div class="col-md-3" align="right">
																<table width="100%" class="mt-4">
																	<tr>
																		<td width="50%">  <input type="button" value="Precedent" name="precedent" id="idBtnPrecedentActivitesEconomiques" class="boutonsm"></td>
																		<td width="50%">
																			{% if (ni_nineaproposition.ninFormejuridique.niFormeunite.id == 12 or ni_nineaproposition.ninFormejuridique.niFormeunite.id == 11) %}
																				<input type="submit"  value="Sauvegarder" name="ajouter" id="idBtnsuivantActivitesEconomiques" class="boutonsm">
																			{% else %}
																				<input type="submit"  value="Suivant" name="ajouter" id="idBtnsuivantActivitesEconomiques" class="boutonsm">
																			{% endif %}
																		</td>
																		
																	</tr>
																</table>
													   </div>
													   
													</div>
												</div>
											</div>

									{{ form_end(form2) }}
									
									{% endif %}

								</div>

						</div>


						<div class="tab-pane" id="dirigeants" role="tabpanel">
							<form name="formDirigeant" action="{{path('ajouterDirigeants',{id:app.request.attributes.get('id')})}}" method="post" id="formDirigeants"
									  >
								{% if ni_nineaproposition.statut == "b" or  ni_nineaproposition.statut == "t" %}
									<button type="button" id="idBtnAjoutDirigeants"  class="boutonsm"><i class="fas fa-plus-circle"></i> Ajouter </button>
								{% endif %}
			
								<div class="col-lg-12 justify-content-center"> 
									<fieldset class=" p-2 fieldcolor ">
										<div>
												<div class="row" id="idPageAjoutDirigeants">
													<div class="col-lg-6" id="idPageAjoutDirigeants1">
														<fieldset class="border p-2">
															<table style="width: 100%;">
																<tr>
																	<td style="width: 40%;">
																		<label for="" class="TXT"><b><u>Civilite : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 60%;">
																		<select class="form-control form-control-sm classselect" name="civilite" required id="idcivilite_dirig">
																			<option value="" selected>Sélectionner...</option>
																			{% for tag in civilites %}
																				{% if Odirigeant %}
																				{% if Odirigeant.ninCivilite and  Odirigeant.ninCivilite.id==tag.id %}
																					<option value="{{ tag.id}}" selected>{{ tag.civlibelle}}</option>
																				{% else %}
																					<option value="{{ tag.id}}">{{ tag.civlibelle}}</option>
																					{% endif %} 
																				{% else %}
																				<option value="{{ tag.id}}">{{ tag.civlibelle}}</option>
																				{% endif %}
																			{% endfor %}
																		</select>
																		<span style="color: red;" id="nincivil"></span>
																	</td>
																</tr>

																<tr>
																	<td style="width: 40%;">
																		<label for="" class="TXT"><b><u>Prénom : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 60%;">
																		<input type="text" name="prenom" maxlength="100" id="prenom_dirig" value="{{Odirigeant ? Odirigeant.ninPrenom : ""}}" required class="form-control form-control-sm"
																		onkeyup="this.value=this.value.toUpperCase()"  >	
																		<span style="color: red;" id="ninprenom"></span>
																		<input type="hidden" name="idDirigeantAM"  id="idDirigeantAM" value="{{Odirigeant ? Odirigeant.id : ""}}" required class="form-control form-control-sm">	
																	</td>
																</tr>

																<tr>
																	<td style="width: 40%;">
																		<label for=""><b><u>Nom : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 60%;">
																		<input type="text" name="nom" maxlength="100" id="idnom_dirig" value="{{Odirigeant ? Odirigeant.ninNom : ""}}" required class="form-control form-control-sm"
																		onkeyup="this.value=this.value.toUpperCase()" >
																		<span style="color: red;" id="ninnom"></span>
																	</td>
																</tr>

																<tr>
																	<td style="width: 40%;">
																		<label for="" class="TXT"><b><u>Sexe : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 60%;">
																	<select type="text" readonly name="sexe" id="idSexe_dirig" value="" required class="form-control form-control-sm">
																			
																	</select>
																	
																	<span style="color: red;" id="ninsexe"></span>

																	</td>
																</tr>
																
															</table>
															
															<table style="width: 100%;">
																<tr>
																	<td style="width: 40%;">
																		<label for="" class="TXT"><b><u>Nationalité : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 60%;">
																		<select style="width: 100%;" class="form-control form-control-sm classselect" required  name="nationalite"  id="idnationalite_dirigeant">
																			<option value="" selected>		Sélectionner</option>
																			{% for tag in nationalites %}
																				<option value="{{tag.id}}" {% if Odirigeant!=null and Odirigeant.ninNationalite.id==tag.id %} selected {% elseif Odirigeant==null and  tag.id=="SN"%} selected {% endif %}>
																					{{ tag.libelle}}</option>
																			{% endfor %}
																		</select>
																		<span style="color: red;" id="ninationalite"></span>
																	</td>
																</tr>
															</table>

															<div id="tableCni_dirigeant">
																<table  style="width: 100%;">
																	<tr id="trcni">
																		<td style="width: 40%;">
																			<label for="" class="TXT"><b><u>CNI</u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 60%;" >
																			<input type="password" readonly onfocus="this.removeAttribute('readonly');"  name="cni" id="idcni_dirig" value="{{Odirigeant ? Odirigeant.ninCni : ""}}" required="required"
																				maxlength = '14' pattern ="[A-Za-z0-9]{10,14}" onkeyup="this.value=this.value.toUpperCase()" onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																				class="form-control  form-control-sm">
																			<span style="color: red;" id="nincni_dirig"></span>
																		</td>
																	</tr>
																	<tr id="trcni">
																		<td style="width: 40%;">
																			<label for="" class="TXT " id="labelconfirmcni"> <b><u>Confirmation CNI : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 60%;" >
																			<input type="text" name="confirm_cni" id="idConfirmcni_dirig" onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																			 value="{{Odirigeant ? Odirigeant.ninCni : ""}}" required class="form-control form-control-sm mt-2 " 
																				maxlength = '14'  required
																				oninput="this.value = this.value.replace(/[^A-Za-z0-9]/g, '');"onkeyup="this.value=this.value.toUpperCase()" >
																			<span style="color: red;" id="ninconfcni_dirg"></span>
																		</td>
																	</tr>
										
																	<tr id="trcni">
																		<td style="width: 40%;">
																			<label for="" class="TXT"><b><u>Date de délivrance CNI : </u></b></label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 60%;" >
																			<input type="date" name="datecni" id="idDatcni_dirig" value="{{Odirigeant ? Odirigeant.ninDateCni | date("Y-m-d")  : ""}}"  required class="form-control form-control-sm">
																			<span style="color: red;" id=""></span>
																		</td>
																	</tr>
																</table>
															</div>
															
															<div id="tablePassport_dirigeant">
																<table style="width: 100%;" >
																	<tr id="trPassport">
																		<td style="width: 40%;">
																			<label for="" class="TXT"><b><u>Passport : </u></b>	</label>
																			<span style="color: red;">*</span>
																		</td>
																		<td style="width: 60%;">
																			<input type="text" name="passport" id="idPassport_dirig"  oninput="this.value = this.value.replace(/[^A-Za-z0-9]/g, '');" 
																			value="{{Odirigeant ? Odirigeant.ninCni : ""}}" onselectstart="return false" onpaste="return false;" onCopy="return false" onCut="return false" onDrag="return false" onDrop="return false"
																			 class="form-control form-control-sm">
																			<span style="color: red;" id="ninpassport_dirig"></span>
																		</td>
																	</tr>
																
										
																	<tr id="trDatePassport">
																		<td style="width: 40%;">
																			<label for="" class="TXT"><b><u>Date du passport : </u></b></label>
																		</td>
																		<td style="width: 60%;">
																			<input type="date" name="datepassport" id="idDatepassport_dirig" value="{{Odirigeant and Odirigeant.ninDateCni ? Odirigeant.ninDateCni | date("Y-m-d")  : ""}}" class="form-control form-control-sm">
																			<span style="color: red;" id="nindatepassport"></span>
																		</td>
																	</tr>
																</table>
															</div>
															
										
														</fieldset>
													</div>

													<div class="col-lg-6" id="idPageAjoutDirigeants2">
														<fieldset class="border p-2">
															<table style="width: 100%;">
																<tr>
																	<td style="width: 40%;">
																		<label for="" class="TXT mt-2"><b><u>Date de naissance : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 60%;">
																		<input type="date" name="datenais" id="idDatenais_dirig"  min="1900-01-01" value="{{Odirigeant and Odirigeant.ninDatenais ? Odirigeant.ninDatenais | date("Y-m-d")  : ""}}" required  class="form-control form-control-sm mt-2">
																		<span style="color: red;" id="nindatenais"></span>
																	</td>
																</tr>
																							
																<tr>
																	<td style="width: 40%;">
																		<label for="" class="TXT"><b><u>Qualification : </u></b></label>
																		<span style="color: red;">*</span>
																	</td>
																	<td style="width: 60%;">
																		<select class="form-control form-control-sm classselect" name="qualification" required id="idqualification">
																			<option value="" selected>	Sélectionner....</option>
																			{% for tag in qualifications %}
																				{% if Odirigeant %}
																					{% if Odirigeant.ninPosition and  Odirigeant.ninPosition.id==tag.id %}
																						<option value="{{ tag.id}}" selected>		{{ tag.libelle}}</option>
																					{% else %}
																						<option value="{{ tag.id}}">		{{ tag.libelle}}</option>
																					{% endif %} 
																				{% else %}
																				<option value="{{ tag.id}}">		{{ tag.libelle}}</option>
																				{% endif %}
																			{% endfor %}
																		</select>
																		<span style="color: red;" id="ninqualications"></span>
																	</td>
																</tr>
																<tr>
																	<td style="width: 40%;">
																		<label for="" class="TXT"><b><u>Téléphone : </u> <span style="color: red;">*</span></b> </label>

																	</td>
																	<td style="width: 60%;">
																		<input type="tel" name="telephone" id="idtelpersonne_dirig1"  value="{{Odirigeant ? Odirigeant.ninTelephone1 : ""}}" 
																		class="form-control form-control-sm" maxlength = '9' oninput="this.value = this.value.replace(/[^0-9,]/g, '');" >
																		<span style="color: red;" id="nintelpersonne_dirig"></span>
																	</td>
																</tr>
																<tr>
																	<td style="width: 40%;">
																		<label for="" class="TXT"><b><u>Adresse : </u></b></label> <span style="color: red;">*</span>
																	</td>
																	<td style="width: 60%;">
																		<input type="text" name="adresse" id="idadresse_dirig" value="{{Odirigeant ? Odirigeant.ninAddresse : ""}}"   onkeyup="this.value=this.value.toUpperCase()" class="form-control form-control-sm">
																		<span style="color: red;" id="ninadresse_dirig"></span>
																	</td>
																</tr>

																<tr>
																	<td style="width: 40%;">
																		<label for="" class="TXT"><b><u>Email : </u></b></label>
																	</td>
																	<td style="width: 60%;">
																		<input type="text" name="email" id="idemail_dirig" value="{{Odirigeant ? Odirigeant.ninEmail : ""}}"   class="form-control form-control-sm">
																		<span style="color: red;" id="ninemail_dirig"></span>
																	</td>
																</tr>

															</table>

														</fieldset>

													</div>
												</div>
								
												<div class="row" id="idGroupeBtnAjoutDirigeants">
													<div class="col-lg-12">
														<div class="mb-3 row">
															<label class="col-md-8" for="basicpill-firstname-input"></label>
															
															<div class="col-md-4" align="right">
																<input type="button"  value="Valider" name="valider" onclick="ajoutModifDirigeant();" id="btnValider" class="boutonsm">
																<input type="button"  value="Annuler" id="idBtnAnnulerAjoutDirigeant" name="annuler"  class="boutonsm">
															</div>
															
														</div>
													</div>
												</div>

												<div class="row ">
													<div class="col-lg-12">
														<div class="mb-3 row">
															<label class="col-md-6" for="basicpill-firstname-input">LISTE DES DIRIGEANTS</label>
															
														</div>
													</div>
												</div>

												<div class="row">
													<div class="col-lg-12">
															<table id="ninea" class="table table-bordered dt-responsive table-hover nowrap w-100 ">
																<thead class="tr_entete" >
																	<tr>
																		<th>Prénom</th>
																		<th>Nom</th>
																		<th>Qualification</th>
																		<th>CNI</th>
																		<th>Nationalité</th>
																		<th>Actions</th>
																	</tr>
																</thead>
																<tbody>
																{% for tag in Dirigeants %}
																	<tr>
																		<td >{{tag.ninPrenom}}</td>
																		<td >{{tag.ninNom}}	</td>
																		<td > 
																			{% if tag.ninPosition %}
																				{{tag.ninPosition.libelle}} 
																			{% endif %}
																		</td>
																		<td >{{tag.ninCni}}</td>
																		<td >{{ tag.ninNationalite.libelle}}</td>
																		<td>
																			<a href="">
																				
																			</a>
																			<input  id="idBtnModifDirigeant"  name="valider" type="submit" value="Modifier" onclick="modifierDirigeants('{{ tag.id}}');" >
																			<input  id="idBtnSupprimeDirigeant"  type="submit" value="Supprimer" onclick="supprimerDirigeants('{{ tag.id}}');" >

																		</td>
																	
																	</tr>
																	{% endfor %}
																</tbody>
															</table>
															
													</div>

												</div>

												<div class="row">
													<div class="col-lg-12">
														<div class="mb-3 row">
															<label class="col-md-8" for="basicpill-firstname-input"></label>
															<div class="col-md-4" align="right">
																<input type="button" value="Precedent" name="precedent" id="idBtnPrecedentDirigeant" class="boutonsm">
																<input type="button" value="Soumettre" name="suivent" id="idBtnsuivantDirigeant" class="boutonsm">
															</div>
															
														</div>
													</div>
												</div>
										
										</div>
									</fieldset>
								</div>
							</form>
							</div>

					</div>
				</div>
			</div>


			<div class="modal fade btnrejeter" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-sm">
					<div class="modal-content">
						<div class="modal-header">
							<h6 class="modal-title" id="mySmallModalLabel">Motifs du rejet de la demande </h6>
							<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
						</div>
						<div class="modal-body">
							
							<div id="sidebar">
								<form    action="{{ path('ni_nineaproposition_rejet',{id:ni_nineaproposition.id}) }}" method="post">
									<div class="row justify-content-center">
										<div class="col-lg-12">	
											<center>							
												<textarea name="remarque"  cols="20" rows="5" required></textarea>
											</center>	
										</div>
										<div class="col-lg-12">
											<center><br>
												<input type="submit" class=" boutonsm" value="Rejeter" width="200px">
											</center>
											
										</div>
									</div>
								</form>	
							</div>
						</div>
					</div><!-- /.modal-content -->
				</div><!-- /.modal-dialog -->
			</div>


			<div class="modal fade btnretour" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-sm">
					<div class="modal-content">
						<div class="modal-header">
							<h6 class="modal-title" id="mySmallModalLabel">Motifs du retour de la demande </h6>
							<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
						</div>						
						<div class="modal-body">							
							<div id="sidebar">
								<form    action="{{ path('ni_nineaproposition_retourner',{id:ni_nineaproposition.id}) }}" method="post">
									<div class="row justify-content-center">
										<div class="col-lg-12">	
											<center>							
												<textarea name="remarque"  cols="20" rows="5" required></textarea>
											</center>	
										</div>
										<div class="col-lg-12">
											<center><br>
												<input type="submit" class="boutonsm" value="Retourner" width="200px">
											</center>
											
										</div>
									</div>
								</form>	
							</div>
						</div>
					</div><!-- /.modal-content -->
				</div><!-- /.modal-dialog -->
			</div>

	{# edit Personne #}
	<div class="modal fade editPersonne" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-xl">
			<div class="modal-content">
				<div class="modal-header">				
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" id="body">
					{# templates/base.html.twig #}

				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div>

	{# edit Coordonnees #}
	<div class="modal fade editCoordonnees" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-xl">
			<div class="modal-content">
				<div class="modal-header">				
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" id="body">
					{# templates/base.html.twig #}
					
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div>

<!-- end card -->
{% endblock %}


{% block javascript %}

<script src="{{ asset('admin/dist/assets/libs/sweetalert2/sweetalert2.min.js')}}"></script>

     <!-- toastr plugin -->
	

	 <script src="{{ asset( 'admin/dist/assets/libs/select2/js/select2.min.js')}} "></script>

	 			<!-- form mask init -->
	<script src="{{ asset('admin/dist/assets/js/pages/form-mask.init.js')}}"></script>

	<script src="{{ asset('admin/dist/assets/libs/inputmask/min/jquery.inputmask.bundle.min.js')}}"></script>

	
	<script src="{{ asset('admin/dist/assets/js/multiselect.min.js')}}"></script>


<script>

   function formatJuridiction(juridiction) {
			//var cleaned = ('' + rccm).replace(/\D/g, '')
			var match = juridiction.match(/^(DKR|STL|KLK|TBC|THS|DBL|KLD|ZGR|LGA|FTK|MTM|SDH|KDG|MBR[A-Z]{3})$/)
			if (match) {
	
			return 1;
			}
			return 0;
	}

	function formatRCCM(texte) {
		//var im=new Inputmask('SN AAA 9999 A 99999');

		var pays = texte.substr(0,2);
		
		var juridiction = texte.substr(2,3);
		
		var annee = texte.substr(5,4);
		
		var lettreCle = texte.substr(9,1);
		
		var sequence = texte.substr(10,5);
		
		if (pays == "SN" && (formatJuridiction(juridiction) == 1) && (annee.match("/\d{4}/g") == 1) 
			&& (lettreCle.match(/^(A|B|C|E[A-Z]{1})$/) == 1) && (sequence.match("/\d{1,5}/g") == 1))
		{
			return 1;
		}				
		return 0;
	}


			//controle sur le registre de commerce
			$("#ni_nineaproposition_ninRegcom").change(function () {
				var registre = $("#ni_nineaproposition_ninRegcom").val();
				var registrenormal1 = registre.replace(/ /g, "");
				let registrenormal2 = registrenormal1.split('_').join('').trim();
				console.log(registrenormal2);

				let route = "{{ path('controleRCCM') }}" + "/" + registrenormal2;
					$.ajax
					({
						type: 'GET',
						url: route,
						success: function (data) 
						{
							if (data == 1) {
								document.getElementById('idmodifierEntete').setAttribute("disabled", true);
								document.getElementById('ninregcom').innerHTML = "Ce numéro de registe existe déjà.";
								Swal.fire('Ce numéro de registe existe déjà.');
								$('#ni_nineaproposition_ninRegcom').addClass('has_error');
								$("#ni_nineaproposition_ninRegcom").focus();

							}
							else 
							{
								
																
								//console.log("regitre 2:" +registrenormal2);

									if (registrenormal2.length < 11)
									{
										Swal.fire('Numéro de registre incomplet.');
										document.getElementById('idmodifierEntete').setAttribute("disabled", true);
										$('#ni_nineaproposition_ninRegcom').addClass('has_error');
										$("#ni_nineaproposition_ninRegcom").focus();
									}							
									else
									{
										$('#ni_nineaproposition_ninRegcom').removeClass('has_error');
										document.getElementById('idmodifierEntete').removeAttribute("disabled");
									
										
											//controle pour les entreprises individuelles
											if ($("#idFormejuridique").val() == 10) 
											{
												var rccmnormalphys = registrenormal2.indexOf("A", 9);
													if (rccmnormalphys == -1 ) {
														document.getElementById('idmodifierEntete').setAttribute("disabled", true);
														Swal.fire('Le format du RCCM saisi n\'est pas valide.');
														$('#ni_nineaproposition_ninRegcom').addClass('has_error');
														$('#ni_nineaproposition_ninRegcom').focus();
													}
											
													else {
														$('#ni_nineaproposition_ninRegcom').removeClass('has_error');
														document.getElementById('ninregcom').innerHTML = "";
														document.getElementById('idmodifierEntete').removeAttribute("disabled");
													}
													
											} 
											else if ($("#idFormejuridique").val() != 93) 
											{
						
												//controle pour les GIE
												if ($("#idFormejuridique").val() == 30) {
													var rccmnormalgie = registrenormal2.indexOf("C", 9);
													if (rccmnormalgie == -1 ) {
														Swal.fire('Le format du RCCM saisi n\'est pas valide.');
														$('#ni_nineaproposition_ninRegcom').addClass('has_error');
														$('#ni_nineaproposition_ninRegcom').focus();
														document.getElementById('idmodifierEntete').setAttribute("disabled", true);
													}
													
													else {
														$('#ni_nineaproposition_ninRegcom').removeClass('has_error');
														document.getElementById('ninregcom').innerHTML = "";
														document.getElementById('idmodifierEntete').removeAttribute("disabled");
													}
												}
												else {
													//controle pour les societes et GIE
													var rccmnormalSoGie = registrenormal2.indexOf("B", 9);
													if (rccmnormalSoGie == -1 ) {
														Swal.fire('Le format du RCCM saisi n\'est pas valide.');
														$('#ni_nineaproposition_ninRegcom').addClass('has_error');
														$('#ni_nineaproposition_ninRegcom').focus();
														document.getElementById('idmodifierEntete').setAttribute("disabled", true);
													}
													
													else {
														$('#ni_nineaproposition_ninRegcom').removeClass('has_error');
														document.getElementById('ninregcom').innerHTML = "";
														document.getElementById('idmodifierEntete').removeAttribute("disabled");
													}
												}
											}
											else 
											{
													//controle pour les succursales
													var rccmnormalsuc = registrenormal2.indexOf("E", 9);
													if (rccmnormalsuc == -1 ) {
														Swal.fire('Le format du RCCM saisi n\'est pas valide.');
														$('#ni_nineaproposition_ninRegcom').addClass('has_error');
														$('#ni_nineaproposition_ninRegcom').focus();
														document.getElementById('idmodifierEntete').setAttribute("disabled", true);
									
													} 
													else {
														$('#ni_nineaproposition_ninRegcom').removeClass('has_error');
														document.getElementById('ninregcom').innerHTML = "";
														document.getElementById('idmodifierEntete').removeAttribute("disabled");
													}
									
											}
									}
									
							}

						},
						error: function (error) 
						{

							console.log(error);
						}
					});
			});
	
   
		// In your Javascript (external .js resource or <script> tag)
			$(document).ready(function() {

				document.getElementById('ni_activite_economique_ninAnneeCa').setAttribute("disabled",true);

				document.getElementById("idPageAjoutDirigeants1").style.display = "none";
				document.getElementById("idPageAjoutDirigeants2").style.display = "none";
				document.getElementById("idGroupeBtnAjoutDirigeants").style.display = "none";

               if($.trim($('#idninAffaire').val()).length> 2 )
				{
					document.getElementById('ni_activite_economique_ninAnneeCa').removeAttribute("disabled");
					document.getElementById('ni_activite_economique_ninAnneeCa').setAttribute("required", true);
					let nStr = $("#idninAffaire").val();
					nStr += '';
					x = nStr.split('.');
					x1 = x[0];
					x2 = x.length > 1 ? '.' + x[1] : '';
					var rgx = /(\d+)(\d{3})/;
					while (rgx.test(x1)) {
					x1 = x1.replace(rgx, '$1' + ' ' + '$2');
					}
					$("#idninAffaire").val(x1 + x2) ;

				}
				

			
                 var exitcni=0, personne_sub=0;
				//champ select pour activite
				$("#idrefNaema1").select2();

				// affichage registre de commerce
				$('#ni_nineaproposition_ninRegcom').inputmask('SN AAA 9999 A 99999');

				// affichage registre de commerce
				$('#ni_activite_economique_ninAnneeCa').inputmask('9999');

				$('#idActivities').find('select').each(function(){
					$(this).select2();
				  });

				  $('.refNaemaModif').find('select').each(function(){
					$(this).select2();
				  });
				  
				  
				  $("#idnationalite_personne").select2();
				  $("#idnationalite_dirigeant").select2();

				  $(".activiteliste").select2();
				  $(".selectproduit").select2();		 


				    let formeunite = "{{ ni_nineaproposition.ninFormejuridique.niFormeunite.id }}";
				  	if(formeunite == 21)					
					{
						document.getElementById("ni_activite_economique_ninCapital").setAttribute("required", true);
					}


				  //DIRIGEANTS
				  $("#prenom_dirig").blur(function() {
					let prenom = $("#prenom_dirig").val();
					
					if (prenom.match(/^[0-9]+$/)!=null)
					{
						
						document.getElementById("ninprenom").innerHTML = "Le prénom ne peut pas contenir que des chiffres.";
					}
					else
					{
						
						document.getElementById("ninprenom").innerHTML = "";
					
					}
					
				  });


				   //DIRIGEANTS
				   $("#idnom_dirig").blur(function() {
					let prenom = $("#idnom_dirig").val();
					
					if (prenom.match(/^[0-9]+$/)!=null)
					{
						
						document.getElementById("ninnom").innerHTML = "Le nom ne peut pas contenir que des chiffres.";
					}
					else
					{
						
						document.getElementById("ninnom").innerHTML = "";
					
					}
					
				  });


				  $("#idadresse_dirig").blur(function() {
					let prenom = $("#idadresse_dirig").val();
					
					if (prenom.match(/^[0-9]+$/)!=null)
					{
						document.getElementById("idadresse_dirig").value = "";
						document.getElementById("ninadresse_dirig").innerHTML = "L'adresse ne peut pas contenir que des chiffres.";
					}
					else
					{
						
						document.getElementById("ninadresse_dirig").innerHTML = "";
					
					}
					
				  });

				  var idDirigeantAM = document.getElementById("idDirigeantAM").value;
                  if(idDirigeantAM ==""){
					  if( "{{app.session.get('PageAjoutDirigeant')}}" ===  null){
                    	document.getElementById("idGroupeBtnAjoutDirigeants").style.display = "none";
                        document.getElementById("idPageAjoutDirigeants1").style.display = "none";
                       document.getElementById("idPageAjoutDirigeants2").style.display = "none";
					  }
					  if( "{{app.session.get('PageAjoutDirigeant')}}" !=1 ){
                    	document.getElementById("idGroupeBtnAjoutDirigeants").style.display = "none";
                        document.getElementById("idPageAjoutDirigeants1").style.display = "none";
                       document.getElementById("idPageAjoutDirigeants2").style.display = "none";
					  }
				  }
				 else {
					 if (document.getElementById("idcivilite_dirig").value == "1") {
		
		                
						let departement = document.getElementById("idSexe_dirig");
						departement.innerHTML = "";
						
						let opt = document.createElement('option');
						opt.innerHTML = "Masculin";
						opt.value = '1';
						departement.add(opt);
		
		             } else  {
		               
						let opt = document.createElement('option');
						opt.innerHTML = "Féminin";
						opt.value = '2';
						departement.add(opt);
	
		            }
				 }
                   {% if Odirigeant ==null %}
				       document.getElementById("tablePassport_dirigeant").style.display = "none";
                    {% else %}
                        if ($('#idnationalite_dirigeant').val() == "SN") {
							document.getElementById("tableCni_dirigeant").style.display = "block";
							document.getElementById("idcni_dirig").setAttribute('required',true);
							document.getElementById("idDatcni_dirig").setAttribute('required',true);
							document.getElementById("idDatepassport_dirig").removeAttribute('required');
							document.getElementById("idPassport_dirig").removeAttribute('required',true);

							document.getElementById("tablePassport_dirigeant").style.display = "none";

							} else {
							document.getElementById("tableCni_dirigeant").style.display = "none";
							document.getElementById("tablePassport_dirigeant").style.display = "block";
							document.getElementById("idDatepassport_dirig").setAttribute('required',true);
							document.getElementById("idPassport_dirig").setAttribute('required',true);
							document.getElementById("idcni_dirig").removeAttribute('required');
							document.getElementById("idDatcni_dirig").removeAttribute('required');


							}
					{% endif %}

			});	

			$(function() {   
				$('#undo_redo').multiselect();
			});


			$(".form-control").bind("keypress", function(e) {

				if (e.keyCode == 13) {
					var inps = $("input"); //add select too
					for (var x = 0; x < inps.length; x++) {
						if (inps[x] == this) {
							while ((inps[x]).name == (inps[x + 1]).name) {
							x++;
							}
							if ((x + 1) < inps.length) $(inps[x + 1]).focus();
						}
					}   e.preventDefault();
				}
			});
	
			
			// Affichage des activités
			const newItemActivities = (e) => {
				var collections = document.querySelector(e.currentTarget.dataset.collection);
				let index = parseInt(collections.dataset.index);
					
				let item = document.createElement("tr");
				
				item.innerHTML = collections.dataset.index = index + 1;
				let prototype = collections.dataset.prototype;
				item.innerHTML = prototype.replace(/__name__/g, index);

				if (index == 0)
				{
					item.querySelector('#ni_activite2_ninActivites_0_statActivprincipale').setAttribute('checked',true);
					item.querySelector(".btn-delete").setAttribute('disabled',true);
					//item.querySelector(".statActivprincipale").setAttribute('disabled', true);

				} 
				
					console.log("ok");

				 
				

				$('#idrefNaema'+index).find('select').each(function(){
					$(this).select2();
				});
				
				
					

				$('#idActivities').on('change', '#ni_activite2_ninActivites_'+index+'_refNaema', function(){
					document.getElementById("undo_redo").innerHTML = "";

					{% for tag in produits %}
						
						if ($('#ni_activite2_ninActivites_'+index+'_refNaema').val() == '{{ tag.naema.id }}') {
						let opt = document.createElement('option');
						opt.value = "{{ tag.id }}";
						opt.innerHTML = "{{ tag.id }}"+"-"+"{{ tag.libelle }}";
						document.getElementById("undo_redo").add(opt);
						}

					{% endfor %}
				});

				
				item.querySelector(".btn-delete").addEventListener("click", () => item.remove());
				collections.appendChild(item);

				//$('form-control').find('select').each(function(){
				//	$(this).select2();
				//});

				$(".activiteliste").select2();
				
			}
			
			document.querySelectorAll(".ajouterActivities").forEach(btn => btn.addEventListener("click", newItemActivities));
			

			//EDIT 

			function editPersonne (id) {
			
				let route = "{{ path('ni_nineaproposition_editPersonne') }}" + "/" +id;
				
				$.ajax({
				type: 'GET',
				url: route,
				success: function (data) {
					document.getElementById('body').innerHTML = "";
					document.getElementById('body').innerHTML = data;
					
					document.getElementById("tablePassport_editpersonne").style.display = "none";

					$('#idnationaliteditpersonne').change(function () {
					
						if ($('#idnationaliteditpersonne').val() == "SN") {
							document.getElementById("tableCni_editpersonne").style.display = "block";
							document.getElementById("tablePassport_editpersonne").style.display = "none";
					
						} else {
							document.getElementById("tableCni_editpersonne").style.display = "none";
							document.getElementById("tablePassport_editpersonne").style.display = "block";
					
						}
					});


					$('#editregion_personne').change(function () {

						let route = "{{ path('departementsRegion') }}" + "/" + $('#editregion_personne').val();
						$.ajax({
						type: 'GET',
						url: route,
						dataType: "json",
						success: function (data) {
						
						let departement = document.getElementById("editdepartement_personne");
						departement.innerHTML = "";
						
						let opt = document.createElement('option');
						opt.innerHTML = "Selectionner ...";
						opt.value = '';
						departement.add(opt);
						for (var i = data.length - 1; i >= 0; i--) {
						let opt = document.createElement('option');
						opt.value = data[i][0];
						opt.innerHTML = data[i][1];
						departement.add(opt);
						$("#editdepartement_personne").select2({
							dropdownParent : $('.editPersonne')
						})
						}
						},
						error: function (error) {
						console.log(error);
						}
						})
						});
						
						$('#editdepartement_personne').change(function () {
						
						let route = "{{ path('cavDepartement') }}" + "/" + $('#editdepartement_personne').val();
						$.ajax({
						type: 'GET',
						url: route,
						dataType: "json",
						success: function (data) {
						
						let cav = document.getElementById("editcav_personne");
						cav.setAttribute('class','form-control form-control-sm'); 
						cav.innerHTML = "";
						
						let opt = document.createElement('option');
						opt.innerHTML = "Selectionner ...";
						opt.value = '';
						cav.add(opt);
						for (var i = data.length - 1; i >= 0; i--) {
						let opt = document.createElement('option');
						opt.value = data[i][0];
						opt.innerHTML = data[i][1];
						cav.add(opt);
						$("#editcav_personne").select2({
							dropdownParent : $('.editPersonne')
						})
						}
						},
						error: function (error) {
						console.log(error);
						}
						})
						});
						
						
						$('#editcav_personne').change(function () 
						{
						
						let route = "{{ path('cacrCav') }}" + "/" + $('#editcav_personne').val();
						$.ajax({
						type: 'GET',
						url: route,
						dataType: "json",
						success: function (data) {
						
						let cacr = document.getElementById("editcacr_personne");
						cacr.innerHTML = "";
						
						let opt = document.createElement('option');
						opt.innerHTML = "Selectionner ...";
						opt.value = '';
						cacr.add(opt);
						for (var i = data.length - 1; i >= 0; i--) {
						let opt = document.createElement('option');
						opt.value = data[i][0];
						opt.innerHTML = data[i][1];
						cacr.add(opt);
						$("#editcacr_personne").select2({
							dropdownParent : $('.editPersonne')
						})
						}
						},
						error: function (error) {
						console.log(error);
						}
						})
						});
						
						$('#editcacr_personne').change(function () {
						
						let route = "{{ path('qvhCacr') }}" + "/" + $('#editcacr_personne').val();
						$.ajax({
						type: 'GET',
						url: route,
						dataType: "json",
						success: function (data) {
						
						let qvh = document.getElementById("editqvh_personne");
						qvh.innerHTML = "";
						
						let opt = document.createElement('option');
						opt.innerHTML = "Selectionner ...";
						opt.value = '';
						qvh.add(opt);
						for (var i = data.length - 1; i >= 0; i--) {
						let opt = document.createElement('option');
						opt.value = data[i][0];
						opt.innerHTML = data[i][1];
						qvh.add(opt);
						$("#editqvh_personne").select2({
							dropdownParent : $('.editPersonne')
						})
						}
						},
						error: function (error) {
						console.log(error);
						}
						})
						});
					
				},
				error: function (error) {
					
				console.log(error);
				}
				});
			}


			function editCoordonnees (id) {
				
				let route = "{{ path('ni_nineaproposition_editCoordonnees') }}" + "/" +id;
				
				$.ajax({
				type: 'GET',
				url: route,
				success: function (data) {
					document.getElementById('body').innerHTML = "";
					document.getElementById('body').innerHTML = data;
					
					$(".editPersonne").modal('show');	
					
					$('#editregion_coord').change(function () {

						let route = "{{ path('departementsRegion') }}" + "/" + $('#editregion_coord').val();
						$.ajax({
						type: 'GET',
						url: route,
						dataType: "json",
						success: function (data) {
						
						let departement = document.getElementById("editdepartement_coord");
						departement.innerHTML = "";
						
						let opt = document.createElement('option');
						opt.innerHTML = "Selectionner ...";
						opt.value = '';
						departement.add(opt);
						for (var i = data.length - 1; i >= 0; i--) {
						let opt = document.createElement('option');
						opt.value = data[i][0];
						opt.innerHTML = data[i][1];
						departement.add(opt);
						$("#editdepartement_coord").select2({
							dropdownParent : $('.editPersonne')
						})
						}
						},
						error: function (error) {
						console.log(error);
						
						}
						})
						});
						
						$('#editdepartement_coord').change(function () {
						
						let route = "{{ path('cavDepartement') }}" + "/" + $('#editdepartement_coord').val();
						$.ajax({
						type: 'GET',
						url: route,
						dataType: "json",
						success: function (data) {
						
						let cav = document.getElementById("editcav_coord");
						cav.innerHTML = "";
						
						let opt = document.createElement('option');
						opt.innerHTML = "Selectionner ...";
						opt.value = '';
						cav.add(opt);
						for (var i = data.length - 1; i >= 0; i--) {
						let opt = document.createElement('option');
						opt.value = data[i][0];
						opt.innerHTML = data[i][1];
						cav.add(opt);
						$("#editcav_coord").select2({
							dropdownParent : $('.editPersonne')
						})
						}
						},
						error: function (error) {
						console.log(error);
						}
						})
						});
						
						
						$('#editcav_coord').change(function () {
						
						let route = "{{ path('cacrCav') }}" + "/" + $('#editcav_coord').val();
						$.ajax({
						type: 'GET',
						url: route,
						dataType: "json",
						success: function (data) {
						
						let cacr = document.getElementById("editcacr_coord");
						cacr.innerHTML = "";
						
						let opt = document.createElement('option');
						opt.innerHTML = "Selectionner ...";
						opt.value = '';
						cacr.add(opt);
						for (var i = data.length - 1; i >= 0; i--) {
						let opt = document.createElement('option');
						opt.value = data[i][0];
						opt.innerHTML = data[i][1];
						cacr.add(opt);
						$("#editcacr_coord").select2({
							dropdownParent : $('.editPersonne')
						})
						}
						},
						error: function (error) {
						console.log(error);
						}
						})
						});
						
						$('#editcacr_coord').change(function () {
						
						let route = "{{ path('qvhCacr') }}" + "/" + $('#editcacr_coord').val();
						$.ajax({
						type: 'GET',
						url: route,
						dataType: "json",
						success: function (data) {
						
						let qvh = document.getElementById("editqvh_coord");
						qvh.innerHTML = "";
						
						let opt = document.createElement('option');
						opt.innerHTML = "Selectionner ...";
						opt.value = '';
						qvh.add(opt);
						for (var i = data.length - 1; i >= 0; i--) {
						let opt = document.createElement('option');
						opt.value = data[i][0];
						opt.innerHTML = data[i][1];
						qvh.add(opt);
						$("#editqvh_coord").select2({
							dropdownParent : $('.editPersonne')
						})
						}
						},
						error: function (error) {
						console.log(error);
						}
						})
						});
						
				},
				error: function (error) {
					
				console.log(error);
				}
				});
			}


			function editActivites (id) {
				
				let route = "{{ path('ni_nineaproposition_editActivites') }}" + "/" +id;
				
				$.ajax({
				type: 'GET',
				url: route,
				success: function (data) {
					document.getElementById('body').innerHTML = "";
					document.getElementById('body').innerHTML = data;
					
					$(".editPersonne").modal('show');		
				},
				error: function (error) {
					
				console.log(error);
				}
				});
			}
	

			function suppActiviteEtProduits (id) {
				// alert(document.forms['formActivites'].action);
				document.forms['formActivites'].action="{{path('suppActiviteEtProduits')}}"+ "/" + id;
				// alert(document.forms['formActivites'].action);
			}

			function modifierEntete () {
				alert("entete");
				document.forms['FormEntete'].action="{{path('modifierEntete')}}"+ "/" + id;
			}

		$("#idBtnAjoutDirigeants").click(function () {
			    document.getElementById("idPageAjoutDirigeants1").style.display = "block";
				document.getElementById("idPageAjoutDirigeants2").style.display = "block";
				document.getElementById("idGroupeBtnAjoutDirigeants").style.display = "block";
				
		});

			$("#idBtnAnnulerAjoutDirigeant").click(function () {
				document.getElementById("idPageAjoutDirigeants1").style.display = "none";
				document.getElementById("idPageAjoutDirigeants2").style.display = "none";
				document.getElementById("idGroupeBtnAjoutDirigeants").style.display = "none";

			});


			
			function verificationInfosNINET(){
				
				{% if (ni_nineaproposition.ninStatut.id == 2) %}
				 //  	alert("verifff");
					let prenom=document.getElementById("prenom").value;
					let nom=document.getElementById("idnom").value;
					let cni=document.getElementById("idcni").value;
					let datenaissance=document.getElementById("idDatenais").value;
					let lieunaissancce=document.getElementById("idlieunais").value;
				//	alert(datenaissance);
					let datenaisMere='{{niNinea_mere.niPersonne.ninDateNaissance|date('Y-m-d')}}';
//					alert(datenaisMere);
				   {% if(niNinea_mere) %}
                    if("{{niNinea_mere.niPersonne.ninPrenom}}".toUpperCase()!=prenom.toUpperCase()){
						Swal.fire('Le prénom de l\'entreprise mére est different de celui de l\'entreprise secondaire.');
					}
					else if("{{niNinea_mere.niPersonne.ninNom}}".toUpperCase()!=nom.toUpperCase()){
						Swal.fire('Le nom de l\'entreprise mére est different de celui de l\'entreprise secondaire.');
					}
					else if("{{niNinea_mere.niPersonne.ninCNI}}".toUpperCase()!=cni.toUpperCase()){
						Swal.fire('La cni de l\'entreprise mére est differente de celle de l\'entreprise secondaire.');
					}
				    else if(datenaisMere != datenaissance){
						Swal.fire('La date de naissance de l\'entreprise mére est differente de celle de l\'entreprise secondaire.');
					}
					else if("{{niNinea_mere.niPersonne.ninLieuNaissance}}".toUpperCase()!=lieunaissancce.toUpperCase()){
						Swal.fire('Le lieu de naissance de l\'entreprise mére est different de celui de l\'entreprise secondaire.');
					}
					else {
						 $("#btnSuivant").click();
					}
					{% endif %}

				{% else %}
				    $("#btnSuivant").click();
				{% endif %}

				
			}


		function ajoutModifDirigeant() 
		{
		
			if ($('#idnationalite_dirigeant').val() != "SN") {
				document.getElementById("idcni_dirig").removeAttribute('pattern');
			}
			var idDirigeantAM = document.getElementById("idDirigeantAM").value;

			if(idDirigeantAM !=""){
				document.forms['formDirigeant'].action="{{path('modifierDirigeants')}}"+ "/" + idDirigeantAM;
			//  alert(document.forms['formDirigeant'].action);
			}
		}


		function modifierDirigeants (id) 
		{
			document.forms['formDirigeant'].action="{{path('modifierDirigeants')}}"+ "/" +id;
			if ($('#idnationalite_dirigeant').val() != "SN") {
				document.getElementById("idcni_dirig").removeAttribute('pattern');
				document.getElementById("idConfirmcni_dirig").removeAttribute('pattern');
				
				
			 }
			document.getElementById("idnationalite_dirigeant").removeAttribute('required');
			document.getElementById("idcni_dirig").removeAttribute('required');
			document.getElementById("idConfirmcni_dirig").removeAttribute('required');
			document.getElementById("idDatcni_dirig").removeAttribute('required');
			document.getElementById("idPassport_dirig").removeAttribute('required');
			document.getElementById("idDatepassport_dirig").removeAttribute('required');
			document.getElementById("idcivilite_dirig").removeAttribute('required');
			document.getElementById("prenom_dirig").removeAttribute('required');
			document.getElementById("idnom_dirig").removeAttribute('required');
	
			document.getElementById("idSexe_dirig").removeAttribute('required');
			document.getElementById("idDatenais_dirig").removeAttribute('required');
			document.getElementById("idqualification").removeAttribute('required');

			
		}

		
	function supprimerDirigeants (id) {
    	// alert(id);
	  document.forms['formDirigeant'].action="{{path('supprimerDirigeants')}}"+ "/" +id;

	  if ($('#idnationalite_dirigeant').val() != "SN") {
            document.getElementById("idcni_dirig").removeAttribute('pattern');
			document.getElementById("idConfirmcni_dirig").removeAttribute('pattern');

		 }
		document.getElementById("idnationalite_dirigeant").removeAttribute('required');
		document.getElementById("idcni_dirig").removeAttribute('required');
		document.getElementById("idConfirmcni_dirig").removeAttribute('required');
		document.getElementById("idDatcni_dirig").removeAttribute('required');
		document.getElementById("idPassport_dirig").removeAttribute('required');
		document.getElementById("idDatepassport_dirig").removeAttribute('required');
		document.getElementById("idcivilite_dirig").removeAttribute('required');
		document.getElementById("prenom_dirig").removeAttribute('required');
		document.getElementById("idnom_dirig").removeAttribute('required');

		document.getElementById("idSexe_dirig").removeAttribute('required');
		document.getElementById("idDatenais_dirig").removeAttribute('required');
		document.getElementById("idqualification").removeAttribute('required');
		document.getElementById("idemail_dirig").removeAttribute('required');

	}

		$('#idcivilite_dirig').change(function () {
			if (document.getElementById("idcivilite_dirig").value == "1") {
				
				let departement = document.getElementById("idSexe_dirig");
				departement.innerHTML = "";
						
				let opt = document.createElement('option');
				opt.innerHTML = "Masculin";
				opt.value = '1';
				departement.add(opt);
			
			} else {
				
				let departement = document.getElementById("idSexe_dirig");
				departement.innerHTML = "";
						
				let opt = document.createElement('option');
				opt.innerHTML = "Féminin";
				opt.value = '2';
				departement.add(opt);
		
			}
		
		});


		$('#idrefNaema1').change(function(){
			document.getElementById("idrefProduit1").innerHTML = "";
            {% for tag in produits %}
				
					if ($('#idrefNaema1').val() == '{{ tag.naema.id }}') 
					{
						let opt = document.createElement('option');
						opt.value = "{{ tag.id }}";
						opt.innerHTML = "{{ tag.id }}"+"-"+"{{ tag.libelle }}";
						document.getElementById("idrefProduit1").add(opt);
					}
				
			{% endfor %}
		});


	

		function hasDuplicates(arr) {
			return new Set(arr).size !== arr.length;
		}

		//CONTROLES CHAMPS 
		$("#idBtnSuivantActivites").click(function()
		{
			var table = document.getElementById("idtab");
	       
            var rowNumber = table.rows.length-1;
			var tabcode = [];
			var tablibelle = [];
			tabcode[0] ="none";
			tablibelle[0] ="none";

			
			for(let i=1; i<=rowNumber;i++ )
			{
				if (document.getElementById("idrefNaema"+i) != null)
				{
					tabcode[i] =document.getElementById("idrefNaema"+i).value ;
					tablibelle[i] =document.getElementById("idninAutact"+i).value ;
					
					
				}else{
				 tabcode[i] ="none"+i; 
				 tablibelle[i] ="none"+i; 
				}
				
			}
					
			

			let idlieunais = document.getElementById("txtLibelleact").value;
			let ninautact = document.getElementById("idninAutact1").value;

			if (idlieunais != "")
			{
				if (idlieunais.match(/^[0-9]+$/) != null)
				{
					
					$("#txtLibelleact").focus();
					document.getElementById("ninLibelleact").innerHTML = "Le libellé ne peut pas contenir que des chiffres.";
					Swal.fire("Le libellé ne peut pas contenir que des chiffres.");
				}
				else
				{
					if (ninautact != "")
					{
						if (ninautact.match(/^[0-9]+$/) != null)
						{
							$("#idninAutact1").focus();
							document.getElementById("ninAutact1").innerHTML = "Le libellé ne peut pas contenir que des chiffres.";
							Swal.fire("Le libellé de l'activité ne peut pas contenir que des chiffres.");
						}
						else 
						{
							if (document.getElementById("idrefNaema1").value != "")
							{

								if (document.getElementById("idrefProduit1").value != "")
									{

										if (hasDuplicates(tablibelle)) {
											Swal.fire("Les libellés ne doivent pas être les memes.");
										}
										else {
											if (hasDuplicates(tabcode)) {
												Swal.fire("Les acivités ne doiven pas être les mêmes.");
											}
											else {
												var table = document.getElementById("idtab");
												var rowNumber = table.rows.length-1;
												document.getElementById("idnbActivites").value=rowNumber;
												
												$("#ecohidden").click();
											}
										}
										
										//$("#formajouterActivite").submit();
									}
									else
									{
										$("#idrefProduit1").addClass("has_error");
										Swal.fire("La liste de  produits ne peut pas être vide.");

									}
								
							}
							else
							{
								Swal.fire("La liste NAEMA de l'activité ne peut pas être vide.");
								$("#idrefNaema1").addClass("has_error");
							}
							
						}
						
					}
					else
					{
						$("#idninAutact1").addClass("has_error");
						Swal.fire("Le champ ne peut pas être vide.");
					}
				}
			}
			else
			{
				$("#txtLibelleact").addClass("has_error");
				Swal.fire("Le champ ne peut pas être vide.");
			}



		});


		$('#btnAjouterActivities').click(function(){
            var table = document.getElementById("idtab");
				//table.setAttribute('style',"width:100% ;")
	        var newRow = table.insertRow(-1);
            var rowNumber = table.rows.length-1;
			var tab=[];
            tab[0]="none";
			
			for(let i=1;i<table.rows.length-1;i++){
				if(document.getElementById("idrefNaema"+i)!=null)
				 tab[i]=document.getElementById("idrefNaema"+i).value;
				else
				 tab[i]="none";
				 
			}
            
			let selectact = document.getElementById("idrefNaema"+rowNumber);
			var newCell = newRow.insertCell(0);
			 newCell.innerHTML = '<td  style="width: 20%;"> <input required type="text" name="ninAutact'+rowNumber+'" id="idninAutact'+rowNumber+'" onkeyup="this.value=this.value.toUpperCase()"  class="form-control form-control-sm "> <span id="ninAutact'+rowNumber+'" style="color:red;"></span></td>';

			 $("#idninAutact"+rowNumber).change(function() {
				let idlieunais = document.getElementById("idninAutact"+rowNumber).value;
					
					if (idlieunais.match(/^[0-9]+$/)!=null)
					{
						
						//document.getElementById("btnSuivant").setAttribute("disabled", true);
						document.getElementById("idBtnSuivantActivites").setAttribute("disabled", true);
						document.getElementById("ninAutact"+rowNumber).innerHTML = "Le libellé ne peut pas contenir que des chiffres.";

					}
					else
					{
						//document.getElementById("btnSuivant").removeAttribute("disabled");
						document.getElementById("idBtnSuivantActivites").removeAttribute("disabled");
						document.getElementById("ninAutact"+rowNumber).innerHTML = "";
					
					}
				});


				//libellé unique


			var newCell2 = newRow.insertCell(1);	
			var opt="";


        {% if ni_nineaproposition.ninFormejuridique.id == 98  %}
				{% for tag in naemas %}
					{% if tag.id == "4800" %}
						if ( !tab.includes('{{tag.id}}'))
							opt=opt+'<option value="{{tag.id}}"> {{tag.id}}-{{ tag.libelle}}</option> ';
					{% endif %}
				{% endfor %}
			{% else %}
				{% if ni_nineaproposition.ninFormejuridique.id == 99  %}

				  {% for tag in naemas %}
						{% if tag.id == "9803" %}
							if ( !tab.includes('{{tag.id}}'))
								opt=opt+'<option value="{{tag.id}}"> {{tag.id}}-{{ tag.libelle}}</option> ';
						{% endif %}
			       {% endfor %}
					

				{% else %}
						{% if ni_nineaproposition.ninFormejuridique.id == 94  %}
							{% for tag in naemas %}
								{% if tag.id == "9901" %}
									if ( !tab.includes('{{tag.id}}'))
										opt=opt+'<option value="{{tag.id}}"> {{tag.id}}-{{ tag.libelle}}</option> ';
								{% endif %}
							{% endfor %}

						{% else %}

						   {% for tag in naemas %}
								{% if tag.id != "9901" and tag.id != "9803" and tag.id != "4800"   %}
									if ( !tab.includes('{{tag.id}}'))
										opt=opt+'<option value="{{tag.id}}"> {{tag.id}}-{{ tag.libelle}}</option> ';
									{% endif %}
					        {% endfor %}

						{% endif %}
				{% endif %}


			{% endif %}

	    
			newCell2.innerHTML = '<td >	<select required style=" background-color :#D6EAF8;"class="form-control form-control-sm select2 classselect" name="refNaema'+rowNumber+'"   id="idrefNaema'+rowNumber+'" required> <option value="" selected> Sélectionner...</option> '+
				opt+
				'</select></td>';
		
            var newCell3 = newRow.insertCell(2);		    
			newCell3.innerHTML = '<td style="width: 30%;"> <select required class="select2 form-control select2-multiple selectproduit" name="refProduit'+rowNumber+'[]" required   id="idrefProduit'+rowNumber+'" multiple="multiple" data-placeholder="Selectionner...">  </select> </td>';

            var newCell4 = newRow.insertCell(3);
            newCell4.innerHTML = ' <td style="width: 10%;"> <label> Secondaire </label></td>';
          
			 var newCell5 = newRow.insertCell(4);
			newCell5.innerHTML = ' <td> <input  id="idBtnSupprimerDirigeant' + rowNumber + '"  type="button" value="Supprimer" ></td>';
			
		    $('.selectproduit').select2();
			$('#idrefNaema'+rowNumber).select2();

            $('#idrefNaema'+rowNumber).change(function(){
				document.getElementById("idrefProduit"+rowNumber).innerHTML = "";
				{% for tag in produits %}
					
					if ($('#idrefNaema'+rowNumber).val() == '{{ tag.naema.id }}') {
					let opt = document.createElement('option');
					opt.value = "{{ tag.id }}";
					opt.innerHTML = "{{ tag.id }}"+"-"+"{{ tag.libelle }}";
					document.getElementById("idrefProduit"+rowNumber).add(opt);
					}

				{% endfor %}			

			});

			newRow.querySelector('#idBtnSupprimerDirigeant'+rowNumber).addEventListener("click",()=>{
				newRow.remove();
			});

		});


	function editDirigeants (id) {
		
		let route = "{{ path('ni_nineaproposition_editDirigeant') }}" + "/" +id;
		
		$.ajax({
		type: 'GET',
		url: route,
		success: function (data) {
			document.getElementById('body').innerHTML = "";
			document.getElementById('body').innerHTML = data;
			
			$(".editPersonne").modal('show');	

			 if ($('#editnationalite_dirig').val() == "SN") {
			      document.getElementById("edittablePassport_dirig").style.display = "none";
	         }
			
		},
		error: function (error) {
			
		console.log(error);
		}
		});
	}


	function editActivitesEconomiques (id) {
		
		let route = "{{ path('ni_nineaproposition_editActivitesEconomiques') }}" + "/" +id;
		
		$.ajax({
		type: 'GET',
		url: route,
		success: function (data) {
			document.getElementById('body').innerHTML = "";
			document.getElementById('body').innerHTML = data;
			
			$(".editPersonne").modal('show');		
		},
		error: function (error) {
			
		console.log(error);
		}
		});
	}


	function activated ()
	{
		let route = "{{ path('activated') }}";
		$.ajax({
		type: 'GET',
		url: route,
		dataType: "json",
		success: function (data) {
		},
		error: function (error) {
		console.log(error);
		}

		});
	}


	//message toast
		
		

		$("#idFormejuridique").change(function (e) {
			   

			     {
                e.preventDefault();
                var a=$(this);
                Swal.fire({
                title:"Confirmation",
                text:"En modifiant la forme juridique vous allez réinitialiser la demande. Êtes-vous sûr de vouloir réinitialiser  ?",
                icon:"success",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
                buttonsStyling:!1}).then(function(t)
                {
                  if (t.value) {
                     document.getElementById("idreprendre").click()
                  }else
                      e.preventDefault();

                })}

				let formejuridique = document.getElementById("idFormejuridique");
				formejuridique.innerHTML = "";

				var opt = document.createElement('option');
				opt.innerHTML = "Sélectionner ...";
				opt.value = '';
				formejuridique.add(opt);

				{% for tag in ni_nineaproposition.ninFormejuridique.niFormeunite.regimeJuridique %}
					{% if   ni_nineaproposition.ninFormejuridique.id == tag.id  %}										
					
					  var opt = document.createElement('option');
						opt.value = "{{ tag.id }}";
						opt.setAttribute('selected',true);
						opt.innerHTML = "{{ tag.fojLibelle }}";
						formejuridique.add(opt);
					{% else %}
					
					  var opt = document.createElement('option');
					  opt.value = "{{ tag.id }}";
					  opt.innerHTML = "{{ tag.fojLibelle }}";
					  formejuridique.add(opt)
					{% endif %}
				{% endfor %}	

			


		});

		

		$("#idninStatut").change(function (e) {
			   

			     {
                e.preventDefault();
                var a=$(this);
                Swal.fire({
                title:"Confirmation",
                text:"En modifiant le statut vous allez réinitialiser la demande. Êtes-vous sûr de vouloir réinitialiser  ?",
                icon:"success",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
                buttonsStyling:!1}).then(function(t)
                {
                  if (t.value) {
                     document.getElementById("idreprendre").click()
                  }else
                      e.preventDefault();

                })}

				let ninStatut = document.getElementById("idninStatut");
				ninStatut.innerHTML = "";

				var opt = document.createElement('option');
				opt.innerHTML = "Sélectionner ...";
				opt.value = '';
				ninStatut.add(opt);

				{% if ni_nineaproposition.ninStatut.id == 1  %}	
				    var opt = document.createElement('option');
					opt.value = "1";
					opt.setAttribute('selected',true);
					opt.innerHTML = "SIEGE";
					ninStatut.add(opt);
					var opt = document.createElement('option');
					opt.value = "2";
					
					opt.innerHTML = "ETS SECONDAIRE";
					ninStatut.add(opt);
								
				{% else %}	
					var opt = document.createElement('option');
					opt.value = "1";
					
					opt.innerHTML = "SIEGE";
					ninStatut.add(opt);
					var opt = document.createElement('option');
					opt.value = "2";
					opt.setAttribute('selected',true);
					opt.innerHTML = "ETS SECONDAIRE";
					ninStatut.add(opt);						
				{% endif %}	

				 


		});
	
		//chargeement forme juridique
		$("#idformeunite").change(function (e) {
			   

			     {
                e.preventDefault();
                var a=$(this);
                Swal.fire({
                title:"Confirmation",
                text:"En modifiant la forme unité vous allez réinitialiser la demande. Êtes-vous sûr de vouloir réinitialiser  ?",
                icon:"success",
                showCancelButton:true,
                confirmButtonText:"Oui",
                cancelButtonText:"Non",
                confirmButtonClass:"btn btn-success mt-2",
                cancelButtonClass:"btn btn-danger ms-2 mt-2",
                buttonsStyling:!1}).then(function(t)
                {
                  if (t.value) {
                     document.getElementById("idreprendre").click()
                  }else
                      e.preventDefault();

                })}

				let formeunite = document.getElementById("idformeunite");
				formeunite.innerHTML = "";

				var opt = document.createElement('option');
				opt.innerHTML = "Sélectionner ...";
				opt.value = '';
				formeunite.add(opt);

				 {% for tag in formeunites %}
					{% if   ni_nineaproposition.ninFormejuridique.niFormeunite.id == tag.id  %}										
					
					    var opt = document.createElement('option');
						opt.value = "{{ tag.id }}";
						opt.setAttribute('selected',true);
						opt.innerHTML = "{{ tag.libelle }}";
						formeunite.add(opt);
					{% else %}
					
					  var opt = document.createElement('option');
					  opt.value = "{{ tag.id }}";
					  opt.innerHTML = "{{ tag.libelle }}";
					  formeunite.add(opt);

					{% endif %}
				{% endfor %}


		});



	//garder la session sur la page
     
	//coordonnees	
	if( "{{app.session.get('actived')}}" == 2 ){
		
			$('#personne').removeClass('active');
			$('#idpersonne').removeClass('active');

			if ($('#idcoordonnee').hasClass("disabled"))
				$('#idcoordonnee').removeClass("disabled");

			$('#idcoordonnee').addClass('active');
			$('#coordonnees').addClass('active');

			activated();
		
	}


	//activites
	if( "{{app.session.get('actived')}}" == 3 ){
		
			$('#personne').removeClass('active');
			$('#idpersonne').removeClass('active');

			//document.getElementById('idcoordonnee').removeAttribute("disabled");
			if ($('#idcoordonnee').hasClass("disabled"))
				$('#idcoordonnee').removeClass("disabled");
			if ($('#idactivite').hasClass("disabled"))
				$('#idactivite').removeClass("disabled");

			$("#idactivite").addClass('active');
			$("#activites").addClass('active');
		
			activated();

	}

    
	//activites economiques
	if( "{{app.session.get('actived')}}" == 4 ){
		
			$('#personne').removeClass('active');
			$('#idpersonne').removeClass('active');
			
			if ($('#idactivite').hasClass("disabled"))
				$('#idactivite').removeClass("disabled");
			if ($('#idcoordonnee').hasClass("disabled"))
				$('#idcoordonnee').removeClass("disabled");
				if ($('#idactiviteEconomique').hasClass("disabled"))
				$('#idactiviteEconomique').removeClass("disabled");

			$("#idactiviteEconomique").addClass('active');
			$("#activiteEconomiques").addClass('active');
		
		
			activated();

	}
	
		//Dirigeants    
	if( "{{app.session.get('actived')}}" == 5 ){
		
			$('#personne').removeClass('active');
			$('#idpersonne').removeClass('active');

			if ($('#idactivite').hasClass("disabled"))
				$('#idactivite').removeClass("disabled");
			if ($('#idcoordonnee').hasClass("disabled"))
				$('#idcoordonnee').removeClass("disabled");
			if ($('#idactiviteEconomique').hasClass("disabled"))
				$('#idactiviteEconomique').removeClass("disabled");

			if ($('#iddirigeant').hasClass("disabled"))
				$('#iddirigeant').removeClass("disabled");

			$("#iddirigeant").addClass('active');
			$("#dirigeants").addClass('active');
		
			activated();

	}
  let formeunite = "{{ ni_nineaproposition.ninFormejuridique.niFormeunite.id }}"
	if (formeunite == 11 || formeunite == 12){
    if ($('#idnationalite_personne').val() == "SN") {
	      document.getElementById("tablePassport_personne").style.display = "none";
	}else{
		 document.getElementById("tableCni_personne").style.display = "none";
	}
	}
			$('#idnationalite_personne').change(function () {
			
				if ($('#idnationalite_personne').val() == "SN") {
					document.getElementById("tableCni_personne").style.display = "block";
					document.getElementById("idcni").setAttribute('required',true);
					document.getElementById("idDatecni").setAttribute('required',true);
					document.getElementById("idDatepassport").removeAttribute('required');

					document.getElementById("tablePassport_personne").style.display = "none";
			
				} else {
					document.getElementById("tableCni_personne").style.display = "none";
					document.getElementById("tablePassport_personne").style.display = "block";
					document.getElementById("idDatepassport").setAttribute('required',true);
					document.getElementById("idcni").removeAttribute('required');
					document.getElementById("idDatecni").removeAttribute('required');

			
				}
			});

	$('#editnationalite_dirig').change(function () {
	//	alert("nationalite edit");
		if ($('#editnationalite_dirig').val() == "SN") {
			document.getElementById("edittableCni_dirig").style.display = "block";
			document.getElementById("edittablePassport_dirig").style.display = "none";
		} else {
			document.getElementById("edittableCni_dirig").style.display = "none";
			document.getElementById("edittablePassport_dirig").style.display = "block";
		}
	});


	$("#idActivites").click(function () {
		$('#ni_activite_refSyscoa').select2({
			dropdownParent: $('#modalActivites')
		});

		$('#ni_activite_refNaema').select2({
			dropdownParent: $('#modalActivites')
		});

		$('#ni_activite_refNaemas').select2({
			dropdownParent: $('#modalActivites')
		});

		$('#ni_activite_refCiti').select2({
			dropdownParent: $('#modalActivites')
		});
	});



function formatPhoneNumber(phoneNumberString) {
		var cleaned = ('' + phoneNumberString).replace(/\D/g, '')
		var match = cleaned.match(/^(70|77|78|72|75|76|33|30|32)[0-9]{7}$/)
		if (match) {

		return 1;
		}
		return 0;
		}


	function formatPhoneNumberPortable(phoneNumberString) {
		var cleaned = ('' + phoneNumberString).replace(/\D/g, '')
		var match = cleaned.match(/^(77|78|72|77|75|76|70)[0-9]{7}$/)
		if (match) {

		return 1;
		}
		return 0;
		}


	function formatPhoneNumberFixe(phoneNumberString1) {
		var cleaned = ('' + phoneNumberString1).replace(/\D/g, '')
		var match = cleaned.match(/^(33|32|30)[0-9]{7}$/)
		if (match) {

		return 1;
		}
		return 0;
		}


		function formatUrl(url) {
				var cleaned = ('' + url).replace(/\D/g, '')
				var match = cleaned.match(/^(\(|33|32)[0-9]{7}$/)
				if (match) {

					return 1;
				}
				return 0;
			}


 //var phoneno = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/

		$('#idtelpersonne').change(function () {
			if ($.trim($('#idtelpersonne').val()) != "") 
			{
				

				if (formatPhoneNumber($.trim($('#idtelpersonne').val())) == 0) {

					$('#idtelpersonne').focus();                 
					Swal.fire('Le numéro téléphone n\'est pas valide.');
					$('#idtelpersonne').addClass('has_error');
					$('#idtelpersonne').val("");
				}
				else
				{
					$('#idtelpersonne').removeClass('has_error');
				}

			}
			else
			{
				$('#idtelpersonne').removeClass('has_error');
			}

		});
		

		$('#idtelephone1').change(function () {
			if ($.trim($('#idtelephone1').val()) != "") 
			{
				if (formatPhoneNumber($.trim($('#idtelephone1').val())) == 0) {
					$('#idtelephone1').focus();
				    Swal.fire('Le numéro téléphone n\'est pas valide.');
				    $('#idtelephone1').addClass('has_error');
			    }
				else
			    {
			     	$('#idtelephone1').removeClass('has_error');
			    }
			}
			else
			{
				$('#idtelephone1').removeClass('has_error');
			}
			
		});


		$('#idtelephone2').change(function () {
			if ($.trim($('#idtelephone2').val()) != "") {

				if (formatPhoneNumber($.trim($('#idtelephone2').val())) == 0) {
                    $('#idtelephone2').focus();
					Swal.fire('Le numéro téléphone n\'est pas valide.');
					$('#idtelephone2').addClass('has_error');
				}
				else
				{
					$('#idtelephone2').removeClass('has_error');
				}

			}
			else
			{
				$('#idtelephone2').removeClass('has_error');
			}

		});


	$('#idtelpersonne_dirig1').blur(function () {
		if ($.trim($('#idtelpersonne_dirig1').val() ) != "") {
		
			if (formatPhoneNumber($.trim($('#idtelpersonne_dirig1').val())) == 0) {
				$('#idtelpersonne_dirig1').focus();
				$('#idtelpersonne_dirig1').addClass('has_error');
				document.getElementById("nintelpersonne_dirig").innerHTML = "Le numéro de téléphone n'est pas valide";
				Swal.fire('Le numéro téléphone n\'est pas valide.');

			}
			else
			{
				document.getElementById("nintelpersonne_dirig").innerHTML = "";
				$('#idtelpersonne_dirig1').removeClass('has_error');
			}
		
		}
		else
		{
			$('#idtelpersonne_dirig1').removeClass('has_error');
		}
	});



	//controle sur raison sociale	
	   //controle sur raison sociale	
	   $("#idraison").change(function() {
			let route = "{{ path('controleRaison') }}" + "/" + $("#idraison").val();
			$.ajax({
				type: 'GET',
				url: route,
				success: function (data) {
					if (data == 1) {
						document.getElementById('btnSuivant').setAttribute("disabled", true);
						document.getElementById('ninraison').innerHTML = "Cette raison sociale existe déjà.";
						$('#idraison').addClass('has_error');
						$("#idraison").focus();

					}
					else {
						$('#idraison').removeClass('has_error');
						document.getElementById('ninraison').innerHTML = "";
						document.getElementById('btnSuivant').removeAttribute("disabled");
					}

				},
				error: function (error) {

					console.log(error);
				}
			});
		});



		function controleRCCM(rccm) {
			let route = "{{ path('controleRCCM') }}" + "/" + rccm;
				$.ajax({
					type: 'GET',
					url: route,
					success: function (data) {
						if (data == 1) {
							document.getElementById('idmodifierEntete').setAttribute("disabled", true);
							document.getElementById('ninregcom').innerHTML = "Ce numéro de registe existe déjà.";
							$('#ni_nineaproposition_ninRegcom').addClass('has_error');
							$("#ni_nineaproposition_ninRegcom").focus();

						}
						else {
							$('#ni_nineaproposition_ninRegcom').removeClass('has_error');
							document.getElementById('ninregcom').innerHTML = "";
							document.getElementById('idmodifierEntete').removeAttribute("disabled");
						}

					},
					error: function (error) {

						console.log(error);
					}
				});
		}



		//controle sur les champs autres que RCCM
		$("#idtitrefoncier").change(function()
		{
			if (formatRCCM($("#idtitrefoncier").val()) == 0)
			{
				$("#idtitrefoncier").focus();
				$("#idtitrefoncier").innerHTML = "Le format du titre foncier n'est pas valide.";
				Swal.fire("Le format du titre foncier n'est pas valide.");
			}
			
		});



		$('#idninDatreg').change(function () 
		{
			var dateReg = new Date($('#idninDatreg').val());
			var dateDuJour = new Date();
			if (dateReg > dateDuJour) {
			Swal.fire('La date de création du  regsitre  ne doit pas être postérieure  à la date du jour.');
			$('#idninDatreg').val("");
			//document.getElementById("idninDatreg").value = new Date("");
			}
		});

		$(document).ready(function() 
		{

				function controleCNI0 (cni) 
				{
					let route = "{{ path('controleCNI') }}" + "/" +cni;	   
					$.ajax
					({
						type: 'GET',
						url: route,
						success: function (data) 
						{
							if (data == 1)
							{
								
								
								document.getElementById('nincni').innerHTML = "Ce numéro d'identification est déjà utilisé.";
								$('#idcni').addClass('has_error');

								document.getElementById('btnSuivant').setAttribute("disabled",true);
							}
							else 
							{
								
								

								$('#idcni').removeClass('has_error');
								document.getElementById('nincni').innerHTML = "";
								document.getElementById('btnSuivant').removeAttribute("disabled");
							}
						
						},
						error: function (error) {
							
							console.log(error);
						}
			        });
	            }
      
	  
			// CONTROLE DIRIGEANTS
			$("#btnValider").click(function() {
					let error = 0;
					if(document.getElementById("idcivilite_dirig").value!="" ){
						if(document.getElementById("prenom_dirig").value!="" ){
							if(document.getElementById("idnom_dirig").value!="" ){
								if(document.getElementById("idDatenais_dirig").value!="" ){
									var nat_dirig = document.getElementById("idnationalite_dirigeant").value;
									if(nat_dirig=='SN'){
										if(document.getElementById("idcni_dirig").value!="" ){  
											if(document.getElementById("idConfirmcni_dirig").value!="" ){
												if(document.getElementById("idDatcni_dirig").value!="" ){
													if(document.getElementById("idqualification").value!="" ){
														if(document.getElementById("idtelpersonne_dirig1").value!="" ){
															
																if(document.getElementById("idadresse_dirig").value!="" ){
																			let prenom = document.getElementById("prenom_dirig").value;
																			if (prenom.match(/^[0-9]+$/)!=null){
																				Swal.fire("Le prénom ne peut pas contenir que des chiffres.");
																						
																			}
																			else{
																				let nom = document.getElementById("idnom_dirig").value;
																				if (nom.match(/^[0-9]+$/)!=null){
																					Swal.fire("Nom ne peut pas contenir que des chiffres.");			
																				}
																				else{
																					let datenais = new Date($('#idDatenais_dirig').val());
																					var dateDuJour = new Date();
																					let yearsDiff = dateDuJour.getFullYear() - datenais.getFullYear();
																					if (yearsDiff < 18 )
																					{
																						Swal.fire("L'âge ne doit pas être inférieur à 18 ans")

																					}else{
																						
																							let CNI = $("#idcni_dirig").val();
																							let confirmationCNI = $("#idConfirmcni_dirig").val();
																							if(CNI != confirmationCNI)
																							{
																								
																								Swal.fire("Les deux CNI ne sont pas conformes.");						
																								
																							}
																							else
																							{																							

																								if (document.getElementById("idcivilite_dirig").value == "2") {
																									cni = $("#idcni_dirig").val();
																									
																								
																									if (cni.startsWith("2"))
																									{
																										
																									$("#formDirigeants").submit();
																									
																									}
																									else
																									{
																										Swal.fire("Attention! la CNI commmence par 1, donc non conforme avec la civilité Madame.");
																			
																									}
																									
																								}
																								else {
																									cni = $("#idcni_dirig").val()
																									
														
																					
																										if ( cni.startsWith("1"))
																										{
																											
																											$("#formDirigeants").submit();
																											
																										}
																										else
																										{
																											Swal.fire("Attention! la CNI commmence par 2, donc non conforme avec la civilité Monsieur");
																				
																										}
																									
																								}
																								

																							}
																							
																					}
																				}		
																				
																		}
																
																}else{
																	Swal.fire("L'adresse complète ne peut pas être vide.");
																}
																
														}else{
															Swal.fire("Le téléphone ne peut pas être vide.");
														}
													}else{
														Swal.fire("La qualification ne peut pas être vide.");
													}			
												}else{
													Swal.fire("La date  de délivrance de la CNI  ne peut pas être vide.");
												}
											}else{
												Swal.fire("La confirmation de la CNI  ne peut pas être vide.");
											}
										}else{
											Swal.fire("La CNI  ne peut pas être vide.");
										}
									}else{
										if(document.getElementById("idPassport_dirig").value!="" ){  
											
												if(document.getElementById("idDatepassport_dirig").value!="" ){
													if(document.getElementById("idqualification").value!="" ){
														if(document.getElementById("idtelpersonne_dirig1").value!="" ){
															
																if(document.getElementById("idadresse_dirig").value!="" ){
																			let prenom = document.getElementById("prenom_dirig").value;
																			if (prenom.match(/^[0-9]+$/)!=null){
																				Swal.fire("Le prénom ne peut pas contenir que des chiffres.");
																						
																			}
																			else{
																				let nom = document.getElementById("idnom_dirig").value;
																				if (nom.match(/^[0-9]+$/)!=null){
																					Swal.fire("Nom ne peut pas contenir que des chiffres.");			
																				}
																				else{
																					let datenais = new Date($('#idDatenais_dirig').val());
																					var dateDuJour = new Date();
																					let yearsDiff = dateDuJour.getFullYear() - datenais.getFullYear();
																					if (yearsDiff < 18 )
																					{
																						Swal.fire("L'âge ne doit pas être inférieur à 18 ans")

																					}else{
																						
																							$("#formDirigeants").submit();
																							
																					}
																				}		
																				
																		}
																
																}else{
																	Swal.fire("L'adresse complète ne peut pas être vide.");
																}
																
														}else{
															Swal.fire("Le téléphone ne peut pas être vide.");
														}
													}else{
														Swal.fire("La qualification ne peut pas être vide.");
													}			
												}else{
													Swal.fire("La date du passport  ne peut pas être vide.");
												}
											
										}else{
											Swal.fire("Le passport  ne peut pas être vide.");
										}

									}

										
								}else{
									Swal.fire("La date de naissance ne peut pas être vide.");
								}
							}else{
								Swal.fire("Le nom ne peut pas être vide.");
							}
				
						}else{
							Swal.fire("Le prénom ne peut pas être vide.");
						}
					}else{
						Swal.fire("La civilité ne peut pas être vide.");
					}
			});

													
	   $("#btnSuivant").click(function() {
			
			
			
			    let formeunite = "{{ ni_nineaproposition.ninFormejuridique.niFormeunite.id }}"
				if (formeunite == 11 || formeunite == 12)
				{
					if(document.getElementById("idCivilite").value!="" ){
						if(document.getElementById("prenom").value!="" ){
							if(document.getElementById("idnom").value!="" ){
								if(document.getElementById("idDatenais").value!="" ){
									if(document.getElementById("idlieunais").value!="" ){ 
										if ($('#idnationalite_personne').val() == "SN") {
											if(document.getElementById("idcni").value!="" ){  
											  
												
												//verifier si nationalite==SN  idConfirmpassport
													if(document.getElementById("idConfirmcni").value!="" ){
														if(document.getElementById("idDatecni").value!="" ){
															if(document.getElementById("idtelpersonne").value!="" ){
																if(document.getElementById("qvh").value!="" ){
																	if(document.getElementById("idadresse").value !="" ){

																			let idlieunais = document.getElementById("idlieunais").value;
																			if (idlieunais.match(/^[0-9]+$/)!=null){
																				Swal.fire("Le lieu de naissance ne peut pas contenir que des chiffres.");
																						
																			}else{
																				let prenom = document.getElementById("prenom").value;
																				if (prenom.match(/^[0-9]+$/)!=null){
																					Swal.fire("Le prénom ne peut pas contenir que des chiffres.");
																							
																				}
																				else{
																				let nom = document.getElementById("idnom").value;
																				if (nom.match(/^[0-9]+$/)!=null){
																					Swal.fire("Nom ne peut pas contenir que des chiffres.");			
																				}
																				else{
																					let datenais = new Date($('#idDatenais').val());
																					var dateDuJour = new Date();
																					let yearsDiff = dateDuJour.getFullYear() - datenais.getFullYear();
																					//console.log(yearsDiff);
																					var dateinf=new Date("1900-01-01");
																					if(datenais>dateinf){	
																						if (yearsDiff < 18 && formejuridique == 10)
																						{
																							$("#idDatenais").addClass("has_error");
																							document.getElementById("nindatenais").innerHTML = "L'âge ne doit pas être inférieur à 18 ans";
																							Swal.fire("L'âge ne doit pas être inférieur à 18 ans")

																						}else
																						{ 
																							$("#idDatenais").removeClass("has_error");
																								document.getElementById("nindatenais").innerHTML = "";

																								let cni = $("#idcni").val();
																								let confirmationCNI = $("#idConfirmcni").val();
																							if (cni.length == 13 || cni.length == 14)
																							{

																								
																									document.getElementById("nincni").innerHTML = "";	
																									$("#idcni").removeClass("has_error");	

																									if(cni != confirmationCNI)
																									{
																										document.getElementById("nincni").innerHTML = "Les deux CNI ne sont pas conformes.";
																										Swal.fire("Les deux CNI ne sont pas conformes.");						
																										
																									}
																									else
																									{																						
																										document.getElementById("nincni").innerHTML = "";
																										if (document.getElementById("idCivilite").value == "2") {
																																																	
																											if (cni.startsWith("2"))
																											{
																												
																												$("#formajouterPersonne").submit();
																												$("#editajouter_personne").submit();
																																																		
																											}
																											else
																											{
																												Swal.fire("Attention! la CNI commmence par 1, donc non conforme avec la civilité Madame.");
																					
																											}
																											
																										}
																										else 
																										{
																																																		
																											if ( cni.startsWith("1"))
																											{
																											
																												
																												$("#editajouter_personne").submit();
																												$("#formajouterPersonne").submit();
																												
																											}
																											else
																											{
																												Swal.fire("Attention! la CNI commmence par 2, donc non conforme avec la civilité Monsieur");
																					
																											}
																											
																					
																										}
																										
				
																									}
																								
												
																							}else{
																								
																									$("#idcni").addClass("has_error");
																									document.getElementById("nincni").innerHTML = "Le nombre de caractères de la CNI ne doit pas être inférieur à 13 ou 14 caractères.";
																								
																							}
																							
																								
																						}
																					}else{
																						$("#idDatenais").addClass("has_error");
																							
																							Swal.fire('La date de naissance   ne doit pas être antérieure à la date 01-01-1900.');
																							
																					}
																				}		
																					
																			}
																			}

																		
																		
																	
																	}else{
																		Swal.fire("L'adresse complète ne peut pas être vide.");
																	}
																}else{
																	Swal.fire("L'adresse(QVH) ne peut pas être vide.");
																}	
															}else{
																Swal.fire("Le téléphone ne peut pas être vide.");
															}			
														}else{
															Swal.fire("La date  de délivrance de la CNI  ne peut pas être vide.");
														}
													}else{
														Swal.fire("La confirmation de la CNI  ne peut pas être vide.");
													}
												
											}else{
													Swal.fire("La CNI  ne peut pas être vide.");
												}

										}else{
											if(document.getElementById("idpassport").value!="" ){  
												
													if(document.getElementById("idDatepassport").value!="" ){
														if(document.getElementById("idtelpersonne").value!="" ){
															if(document.getElementById("qvh").value!="" ){
																if(document.getElementById("idadresse").value!="" ){
																	let idlieunais = document.getElementById("idlieunais").value;
																	if (idlieunais.match(/^[0-9]+$/)!=null){
																		Swal.fire("Le lieu de naissance ne peut pas contenir que des chiffres.");
																				
																	}else{
																			let prenom = document.getElementById("prenom").value;
																			if (prenom.match(/^[0-9]+$/)!=null){
																				Swal.fire("Le prénom ne peut pas contenir que des chiffres.");
																						
																			}
																			else{
																			let nom = document.getElementById("idnom").value;
																			if (nom.match(/^[0-9]+$/)!=null){
																				Swal.fire("Nom ne peut pas contenir que des chiffres.");			
																			}
																			else{
																				let datenais = new Date($('#idDatenais').val());
																				var dateDuJour = new Date();
																				let yearsDiff = dateDuJour.getFullYear() - datenais.getFullYear();
																				//console.log(yearsDiff);
																				var dateinf=new Date("1900-01-01");
																				if(datenais>dateinf)
																				{	
																					if (yearsDiff < 18 && formejuridique == 10)
																					{
																						$("#idDatenais").addClass("has_error");
																						document.getElementById("nindatenais").innerHTML = "L'âge ne doit pas être inférieur à 18 ans";
																						Swal.fire("L'âge ne doit pas être inférieur à 18 ans")

																					}else
																					{ 
																							let passport = document.getElementById("idpassport").value;
																						
																								$.ajax({
																									type: 'GET',
																									url: "{{ path('controleCNI') }}" + "/" + passport,
																									async : false,
																									success: function (data) 
																									{
																										if (data == 1)
																										{
																											document.getElementById('btnSuivant').setAttribute("disabled",true);
																											document.getElementById('ninpassport').innerHTML = "Ce numéro d'identification est déjà utilisé.";
																											$('#idpassport').addClass('has_error');
																											$("#idpassport").focus();
																											exitcni=1;
																											personne_sub=0;
																			
																										}
																										//data == 0
																										else
																										{
																											exitcni=0;
																											personne_sub=0;
																											$('#idpassport').removeClass('has_error');
																											document.getElementById('ninpassport').innerHTML = "";
																											
																										}

																			
																									}
																			
																								});


																								let confirmationCNI = $("#idConfirmpassport").val();
																									if(passport != confirmationCNI)
																									{
																										//$("#idmodif_confirmcni").focus();
																										$('#idConfirmpassport').addClass('has_error');
																										document.getElementById("ninconfpassport").innerHTML="Les deux numéros ne sont pas conformes.";
																										$('#idConfirmpassport').focus();

																										Swal.fire("Les deux numéros ne sont pas conformes.");				   

																									}
																									else
																									{
																										//document.getElementById("btnSuivant").removeAttribute("disabled");
																										$('#idConfirmpassport').removeClass('has_error');
																										document.getElementById("ninconfpassport").innerHTML="";

																										$("#formajouterPersonne").submit();
																										$("#editajouter_personne").submit();
																									}

																					}
																				}else{
																						
																						Swal.fire('La date du passport   ne doit pas être antérieure à la date 01-01-1900.');
																						
																				}
																			}		
																				
																		}
																	}
																
																}else{
																	Swal.fire("L'adresse complète ne peut pas être vide.");
																}
															}else{
																Swal.fire("L'adresse(QVH) ne peut pas être vide.");
															}	
														}else{
															Swal.fire("Le téléphone ne peut pas être vide.");
														}			
													}else{
														Swal.fire("La date du passport ne peut pas être vide.");
													}
												
											}else{
												Swal.fire("Le passport  ne peut pas être vide.");
											}
										}
									}else{
										Swal.fire("Le lieu de naissance ne peut pas être vide.");
									}
								}else{
									Swal.fire("La date de naissance ne peut pas être vide.");
								}
							}else{
								Swal.fire("Le nom ne peut pas être vide.");
							}
				
						}else{
							Swal.fire("Le prénom ne peut pas être vide.");
						}
					}else{
						Swal.fire("La civilité ne peut pas être vide.");
					}
				}
				else
				{
					if ($("#idraison").val() != "")
					{
						
						$("#formajouterPersonne").submit();
						$("#editajouter_personne").submit();
						
					}
					else
					{
						
						Swal.fire("La raison sociale ne doit pas être vide.");

					}

					
				}
			
				
	   });

       	$("#idlieunais").change(function() {
        let idlieunais = document.getElementById("idlieunais").value;
			
			if (idlieunais.match(/^[0-9]+$/)!=null)
			{
				
				//document.getElementById("btnSuivant").setAttribute("disabled", true);
				//document.getElementById("btnValider").setAttribute("disabled", true);
				document.getElementById("ninlieunais").innerHTML = "Le lieu de naissance ne peut pas contenir que des chiffres.";
			}
			else
			{
				//document.getElementById("btnSuivant").removeAttribute("disabled");
				//document.getElementById("btnValider").setAttribute("disabled", true);
				document.getElementById("ninlieunais").innerHTML = "";
			
			}
		});


		$("#txtLibelleact").change(function() {
			let idlieunais = document.getElementById("txtLibelleact").value;
				
				if (idlieunais.match(/^[0-9]+$/)!=null)
				{
					
					//document.getElementById("btnSuivant").setAttribute("disabled", true);
					//document.getElementById("btnValider").setAttribute("disabled", true);
					document.getElementById("ninLibelleact").innerHTML = "Le libellé ne peut pas contenir que des chiffres.";
				}
				else
				{
					//document.getElementById("btnSuivant").removeAttribute("disabled");
					//document.getElementById("btnValider").setAttribute("disabled", true);
					document.getElementById("ninLibelleact").innerHTML = "";
				
				}
			});


			$("#idninAutact1").change(function() {
				let idlieunais = document.getElementById("idninAutact1").value;
					
					if (idlieunais.match(/^[0-9]+$/)!=null)
					{
						
						//document.getElementById("btnSuivant").setAttribute("disabled", true);
						//document.getElementById("btnValider").setAttribute("disabled", true);
						if (document.getElementById("ninAutact1") != null)
							document.getElementById("ninAutact1").innerHTML = "Le libellé ne peut pas contenir que des chiffres.";
					}
					else
					{
						//document.getElementById("btnSuivant").removeAttribute("disabled");
						//document.getElementById("btnValider").setAttribute("disabled", true);
						if (document.getElementById("ninAutact1") != null)
							document.getElementById("ninAutact1").innerHTML = "";
					
					}
				});


				

				//CONTROLES SUR LA CNI
				$('#idcni').change(function () 
				{	
					let cni = $("#idcni").val();
					let route = "{{ path('controleCNI') }}" + "/" + cni;	 

					//CNI avec 13 ou 14 caractere
					if ( cni.length == 13 || cni.length == 14)
						{
							document.getElementById('nincni').innerHTML = "";

							$.ajax({
								type: 'GET',
								url: route,
								async : false,
								success: function (data) 
								{
									
									if (data == 1)
									{
										if(document.getElementById('idninStatut').value==1){
											document.getElementById('btnSuivant').setAttribute("disabled",true);
											document.getElementById('nincni').innerHTML = "Ce numéro d'identification est déjà utilisé.";
											$('#idcni').addClass('has_error');
											$("#idcni").focus();
											exitcni=1;
											personne_sub=0;
										}else{

										}

									}
									//data == 0
									else if(cni != "")
									{
										exitcni=0;
										personne_sub=0;
										$('#idcni').removeClass('has_error');
										document.getElementById('nincni').innerHTML = "";
										
											var element1 = cni.substring(0,1);		
											if ( element1 != 1 && element1 != 2 )
											{
												$("#idcni").focus();
												document.getElementById('nincni').innerHTML = "La CNI n'est pas valide.";
												Swal.fire("La CNI n'est pas valide.");
												$('#idcni').hasClass('has_error');
												document.getElementById('btnSuivant').setAttribute("disabled",true);
											}
											else 
											{
					
												//test entre CNI et civilité
												var nationalite= document.getElementById("idnationalite_personne").value;	
												var elementCni = cni.substring(0, 1);
												var sexe = document.getElementById("idsexe");
												if (cni.startsWith("1") && nationalite == "SN") 
												{
													//si cni commence par 1, sexe = masculin
												/*	var sexe = document.getElementById("idsexe");
													sexe.innerHTML = "";
													var opt = document.createElement('option');
													opt.innerHTML = "Masculin";
													opt.value = 1;
													sexe.add(opt);
												
													//civilite
													var civilite = document.getElementById("idCivilite");
													civilite.innerHTML = "";
													var opt = document.createElement('option');
													opt.innerHTML = "Monsieur";
													opt.value = 1;
													civilite.add(opt);*/
												
													// test civilite et cni
													if (document.getElementById("idCivilite").value == "2" ) 
														{
															document.getElementById('nincni').innerHTML = "Attention! la CNI commmence par 1, donc non conforme avec la civilité Madame.";
															Swal.fire("Attention! la CNI commmence par 1, donc non conforme avec la civilité Madame");
															$('#idcni').addClass('has_error');
															//document.getElementById('btnSuivant').setAttribute("disabled",true);
						
															//changer la civilite
															
														}else{
															$('#idcni').removeClass('has_error');
															document.getElementById('btnSuivant').removeAttribute("disabled");
						
														}
														
												}
					
												else if (cni.startsWith("2") && nationalite == "SN") 
												{
												/*	let idcivilite = document.getElementById("idCivilite").value;

													console.log(idcivilite);
													var sexe = document.getElementById("idsexe");
													sexe.innerHTML = "";
													var opt = document.createElement('option');
													opt.innerHTML = "Féminin";
													opt.value = 2;
													sexe.add(opt);
					
													//civilite
													var civilite = document.getElementById("idCivilite");
													civilite.innerHTML = "";
													var opt1 = document.createElement('option');
													opt1.innerHTML = "Madame";
													opt1.value = 2;*/
													

													// test civilite et cni
													if (document.getElementById("idCivilite").value == "1" ) 
													{
														document.getElementById('nincni').innerHTML = "Attention! la CNI commmence par 2, donc non conforme avec la civilité Monsieur.";
														Swal.fire("Attention! la CNI commmence par 2, donc non conforme avec la civilité Monsieur");
														$('#idcni').addClass('has_error');
														//document.getElementById('btnSuivant').setAttribute("disabled",true);
					
														//changer la civilite
														
													}else{
														$('#idcni').removeClass('has_error');
														document.getElementById('nincni').innerHTML = "";
													    document.getElementById('btnSuivant').removeAttribute("disabled");
						
													}
													
													
												}
					
											}					
											
										
									}

								}


							});
				
						}
						else
						{
							document.getElementById('nincni').innerHTML = "Le nombre de caractères ne doit pas etre inférieur à 13 ou 14 .";
								$('#idcni').addClass('has_error');
								$("#idcni").focus();

						} 

						//CNI a 11 caractères
						/*else if ( cni.length == 11)
						{
							//2er controle
							$.ajax({
								type: 'GET',
								url: route,
								success: function (data) 
								{
									if (data == 1)
									{
										document.getElementById('nincni').innerHTML = "Ce numéro d'identification est déjà utilisé .";
										$('#idcni').addClass('has_error');
										$("#idcni").focus();
										$("#idcni").val("");

									}

										$('#idcni').removeClass('has_error');

								}

							});
						} */

	    		});



				//CONFIRMATION CNI
				
				$('#idConfirmcni').change(function () {	
					let CNI = $("#idcni").val();
					let confirmationCNI = $("#idConfirmcni").val();
					if(CNI != confirmationCNI)
					{
						$("#ninconfcni").focus();
						$('#idConfirmcni').addClass('has_error');
						document.getElementById("ninconfcni").innerHTML = "Les deux CNI ne sont pas conformes.";
						Swal.fire("Les deux CNI ne sont pas conformes.");						
						//document.getElementById("btnSuivant").setAttribute("disabled", true);
					}
					else
					{
						$('#idConfirmcni').removeClass('has_error');
						document.getElementById("ninconfcni").innerHTML = "";
						//document.getElementById("btnSuivant").removeAttribute("disabled");

					}
				});  
			


				//controle sur la ciHvilité en fonction de la CNI (personne physique)
				$('#idCivilite').change(function () {
					//alert(document.getElementById("idcni").value);
					//on recupère le pays (SN)
					let cni = $("#idcni").val();
					
					if (document.getElementById("idCivilite").value == "2") {
						var sexe = document.getElementById("idsexe");
						sexe.innerHTML = "";
						var opt = document.createElement('option');
						opt.innerHTML = "Féminin";
						opt.value = 2;
						sexe.add(opt);
						if(!cni){

						}else{
						
							if (cni.startsWith("2"))
							{
								
								$('#idCivilite').removeClass('has_error');
								$('#idcni').removeClass('has_error');
								document.getElementById('nincni').innerHTML = "";
								document.getElementById('nincivil').innerHTML = "";
								//document.getElementById('btnSuivant').removeAttribute("disabled");
							}
							else
							{
								document.getElementById('nincivil').innerHTML = "La civilité Madame non conforme avec la CNI";
								$('#idCivilite').addClass('has_error');
								$('#idcni').addClass('has_error');
								document.getElementById('nincni').innerHTML = "La CNI commence par 1 et non conforme avec la civilite Madame.";

								//document.getElementById('btnSuivant').setAttribute("disabled",true);
	
							}
						}
					}
					else {
						var sexe = document.getElementById("idsexe");
						sexe.innerHTML = "";
						var opt = document.createElement('option');
						opt.innerHTML = "Masculin";
						opt.value = 1;
						sexe.add(opt);

						if(!cni){

						}else{
						
							if ( cni.startsWith("1"))
							{
								document.getElementById('nincni').innerHTML = "";
								document.getElementById('nincivil').innerHTML = "";
								$('#idcni').removeClass('has_error');
								//document.getElementById('btnSuivant').removeAttribute("disabled");
							}
							else
							{
								$("#nincivil").val("La civilité Monsieur non conforme avec la CNI .");
								$('#idcni').addClass('has_error');
								document.getElementById('nincni').innerHTML = "La CNI commence par 2 et non conforme avec la civilite Monsieur.";
								//document.getElementById('btnSuivant').setAttribute("disabled",true);
	
							}
						}

					}
                    
					
				
				}); 


				//CONTROLES SUR LE Passport
				$('#idpassport').change(function () 
				{	
					let cni = $("#idpassport").val();
					let route = "{{ path('controleCNI') }}" + "/" + cni;	 

					document.getElementById('ninpassport').innerHTML = "";

					$.ajax({
						type: 'GET',
						url: route,
						async : false,
						success: function (data) 
						{
							if (data == 1)
							{
								document.getElementById('btnSuivant').setAttribute("disabled",true);
								document.getElementById('ninpassport').innerHTML = "Ce numéro d'identification est déjà utilisé.";
								$('#idpassport').addClass('has_error');
								$("#idpassport").focus();
								exitcni=1;
								personne_sub=0;

							}
							
							else if(cni != "")
							{

								exitcni=0;
								personne_sub=0;
								document.getElementById('btnSuivant').removeAttribute("disabled");
								$('#idpassport').removeClass('has_error');
								document.getElementById('ninpassport').innerHTML = "";
															
								
								let civilite = document.getElementById("idCivilite").value;

							}

						}

					});
		

						//CNI a 11 caractères
						/*else if ( cni.length == 11)
						{
							//2er controle
							$.ajax({
								type: 'GET',
								url: route,
								success: function (data) 
								{
									if (data == 1)
									{
										document.getElementById('nincni').innerHTML = "Ce numéro d'identification est déjà utilisé .";
										$('#idcni').addClass('has_error');
										$("#idcni").focus();
										$("#idcni").val("");

									}

										$('#idcni').removeClass('has_error');

								}

							});
						} */

	    		});

				

				//CONFIRMATION CNI
				   
				$('#idConfirmpassport').change(function () {	
					let CNI = $("#idpassport").val();
					let confirmationCNI = $("#idConfirmpassport").val();
					if(CNI != confirmationCNI)
					{
						//$("#idmodif_confirmcni").focus();
						 $('#idConfirmpassport').addClass('has_error');
						document.getElementById("ninconfpassport").innerHTML="Les deux numéros ne sont pas conformes.";
						$('#idConfirmpassport').focus();

						Swal.fire("Les deux numéros ne sont pas conformes.");				   

					}
					else
					{
					   
						$('#idConfirmpassport').removeClass('has_error');
						 document.getElementById("ninconfpassport").innerHTML="";
					}
				});  



		   //CONTROLES SUR LA CNI
		   $('#idmodif_cni').change(function () 
		   {	
			   let cni = $("#idmodif_cni").val();
			   let route = "{{ path('controleCNI') }}" + "/" + cni;	 
   
			   //CNI avec 13 ou 14 caractere
			   if ( cni.length == 13 || cni.length == 14)
				   {
					   let cni_ext1 = cni.substr(0,4);
					   let cni_ext2 = cni.substr(4,2);
					   let cni_ext3 = cni.substr(6);
					   let cni11 = cni_ext1 + cni_ext3;
					   let route11 = "{{ path('controleCNI') }}" + "/" +cni11;	   
   
					  
   
					   //1er controle
					   $.ajax({
						   type: 'GET',
						   url: route11,
						   success: function (data) 
						   {
							   if (data == 1)
							   {
								   //document.getElementById('btnSuivant').setAttribute("disabled",true);
								   document.getElementById('nincni').innerHTML = "Ce numéro d'identification est déjà utilisé avec une CNI de  11 caractères.";
								   $('#idmodif_cni').addClass('has_error');
								   $("#idmodif_cni").focus();
   
							   }
							   //data == 0
							   else if(cni != "")
							   {
								   $('#idmodif_cni').removeClass('has_error');
								   document.getElementById('nincni').innerHTML = "";
								   
								   if (cni.length == 11 || cni.length == 13 || cni.length == 14)
								   {
									   var element1 = cni.substring(0,1);		
									   if ( element1 != 1 && element1 != 2 )
									   {
										   $("#idmodif_cni").focus();
										    document.getElementById('nincni').innerHTML = "La CNI n'est pas valide.";
										   Swal.fire("La CNI n'est pas valide.");
										   $('#idmodif_cni').hasClass('has_error');
										  // document.getElementById('btnSuivant').setAttribute("disabled",true);
									   }
									   else 
									   {
			   
										   //test entre CNI et civilité
										   var nationalite= document.getElementById("idnationalite_personne").value;	
										   var elementCni = cni.substring(0, 1);
										   var sexe = document.getElementById("idsexe");
										   if (cni.startsWith("1") && nationalite == "SN") 
										   {
											   //si cni commence par 1, sexe = masculin
											   var sexe = document.getElementById("idsexe");
											   sexe.innerHTML = "";
											   var opt = document.createElement('option');
											   opt.innerHTML = "Masculin";
											   opt.value = 1;
											   sexe.add(opt);
										   
											   //civilite
											   var civilite = document.getElementById("idCivilite");
											   civilite.innerHTML = "";
											   var opt = document.createElement('option');
											   opt.innerHTML = "Monsieur";
											   opt.value = 1;
											   civilite.add(opt);
										   
											   
												   
										   }
			   
										   else if (cni.startsWith("2") && nationalite == "SN") 
										   {
											   let idcivilite = document.getElementById("idCivilite").value;
   
											   console.log(idcivilite);
											   var sexe = document.getElementById("idsexe");
											   sexe.innerHTML = "";
											   var opt = document.createElement('option');
											   opt.innerHTML = "Féminin";
											   opt.value = 2;
											   sexe.add(opt);
			   
											   //civilite
											   var civilite = document.getElementById("idCivilite");
											   civilite.innerHTML = "";
											   var opt1 = document.createElement('option');
											   opt1.innerHTML = "Madame";
											   opt1.value = 2;
											 
											   if (idcivilite == 2)
											   {
												   civilite.add(opt1);
											   }
											   else 
											   {
												   civilite.add(opt1);
											   }
   
											   // test civilite et cni
											   if (document.getElementById("idCivilite").value == "1" ) {
												   
												   Swal.fire("Attention! la CNI commmence par 2, donc non conforme avec la civilité Madame");
												   $('#idmodif_cni').addClass('has_error');
												   //document.getElementById('btnSuivant').setAttribute("disabled",true);
			   
												   //changer la civilite
												   $("#idCivilite").change(function() {
													   if (document.getElementById("idCivilite").value == "2" && cni.startsWith("2"))
													   {
														   $('#idmodif_cni').removeClass('has_error');
														   //document.getElementById('btnSuivant').removeAttribute("disabled");
													   }
													   else
													   {
														   $('#idmodif_cni').addClass('has_error');
														   //document.getElementById('btnSuivant').setAttribute("disabled",true);
			   
													   }
												   });
											   }
											   
											   
										   }
			   
									   }					
									   
								   }
								   else
									   {
										   $('#idmodif_cni').focus();                 
										   Swal.fire("La longueur de la CNI doit être comprise entre 11, 13 et 14 caractères.");
										   $('#idmodif_cni').addClass('has_error');
										   //document.getElementById('btnSuivant').setAttribute("disabled",true);
			   
									   }
							   }
   
						   }
   
					   });
		   
				   } 
   
				     
		   });
   
   
   
				   //CONFIRMATION CNI
				   
				   $('#idmodif_confirmcni').change(function () {	
					   let CNI = $("#idmodif_cni").val();
					   let confirmationCNI = $("#idmodif_confirmcni").val();
					   if(CNI != confirmationCNI)
					   {
						   $("#idmodif_confirmcni").focus();
						    $('#idmodif_cni').addClass('has_error');
						   document.getElementById("connincni").innerHTML="Les deux CNI ne sont pas conformes.";
						   Swal.fire("Les deux CNI ne sont pas conformes.");
						   //document.getElementById("idcni").type = "password";
						   //document.getElementById("btnSuivant").setAttribute("disabled", true);
						   $('#idmodif_confirmcni').addClass('has_error');
						  
   
					   }
					   else
					   {
						  document.getElementById("btnSuivant").removeAttribute("disabled");
						   $('#idmodif_cni').removeClass('has_error');
						   $('#idmodif_confirmcni').removeClass('has_error');
						    document.getElementById("connincni").innerHTML="";
					   }
				   });  
			   
   
				$("#prenom").change(function() {
					let prenom = document.getElementById("prenom").value;
					
					if (prenom.match(/^[0-9]+$/)!=null)
					{
						
						document.getElementById("ninprenom").innerHTML = "Le prénom ne peut pas contenir que des chiffres.";
					}
					else
					{
						
						document.getElementById("ninprenom").innerHTML = "";
					
					}
				});

				$("#idnom").change(function() {
					let nom = document.getElementById("idnom").value;
					
					if (nom.match(/^[0-9]+$/)!=null)
					{
						//document.getElementById("btnSuivant").setAttribute("disabled", true);
						document.getElementById("ninnom").innerHTML = "Le nom ne peut pas contenir que des chiffres.";
					}
					else
					{
						//document.getElementById("btnSuivant").removeAttribute("disabled");
						document.getElementById("ninnom").innerHTML = "";
					
					}
				});
   
				//prenom capitalize first letter 
				function capitalize(input) {  
					var CapitalizeWords = input[0].toUpperCase();  
					for (var i = 1; i <= input.length - 1; i++) {  
						let currentCharacter,  
							previousCharacter = input[i - 1];  
						if (previousCharacter && previousCharacter == ' ') {  
							currentCharacter = input[i].toUpperCase();  
						} else {  
							currentCharacter = input[i];  
						}  
						CapitalizeWords = CapitalizeWords + currentCharacter;  
					}  
					return CapitalizeWords;  
				}  
			

				//controle ADRESSES pour coordonnees
				$("#idadresse1").change(function() {
					let nom = document.getElementById("idadresse1").value;
					
					if (nom.match(/^[0-9]+$/)!=null)
					{
						//document.getElementById("btnSuivant").setAttribute("disabled", true);
						document.getElementById("idadresse1").value = "";
						document.getElementById("ninadresse1").innerHTML = "L'adresse ne peut pas contenir que des chiffres.";
					}
					else
					{
						//document.getElementById("btnSuivant").removeAttribute("disabled");
						document.getElementById("ninadresse1").innerHTML = "";
					
					}
				});


			$('#idcivilite_dirig').change(function () {
					//alert(document.getElementById("idcni").value);
				//on recupère le pays (SN)
				var nat_dirig = document.getElementById("idnationalite_dirigeant").value;
				var cni_dirig = document.getElementById("idcni_dirig").value;
				var elementCni_dirig = cni_dirig.substring(0, 1);

				if (nat_dirig == "SN")
				{
					if (elementCni_dirig == 1)
					{
						if (document.getElementById("idcivilite_dirig").value == "2" ) 
						{
							Swal.fire("Erreur de sélection du sexe.");
							$('#idcivilite_dirig').hasClass('has_error');

							var sexe = document.getElementById("idSexe_dirig");
							sexe.innerHTML = "";
							var opt = document.createElement('option');
							opt.innerHTML = "Féminin";
							opt.value = 2;
							sexe.add(opt);
						}
					}
					else if (elementCni_dirig == 2)
					{
						if (document.getElementById("idcivilite_dirig").value == "1") {
							Swal.fire("Erreur de sélection du sexe.");
							$('#idcivilite_dirig').hasClass('has_error');

							var sexe = document.getElementById("idSexe_dirig");
							sexe.innerHTML = "";
							var opt = document.createElement('option');
							opt.innerHTML = "Masculin";
							opt.value = 1;
							sexe.add(opt);
						} 
					} else {
						$('#idcivilite_dirig').removeClass('has_error');
					}
				}
				
			});

			});


		// contole date cni et date passpport
			$('#idDatecni').blur(function () {
				var dateCNI = new Date($('#idDatecni').val());
				var dateDuJour = new Date();

				console.log(dateCNI);
				if (dateCNI > dateDuJour) {
				Swal.fire('La date de délivrance du CNI  ne doit pas être postérieure à la date du jour.');
				//document.getElementById("idDatecni").value = new Date("");
				
				}

				var datenais =  new Date($('#idDatenais').val());
				if (datenais >= dateCNI)
				{
					Swal.fire('La date de naissance ne doit pas être postérieure ou égale  à la date de délivrance de la CNI.');
					document.getElementById("idDatecni").value = new Date("");
				}
				else if (dateCNI < new Date("1901-01-01") )
					{
						$('#idDatecni').val("");
						$('#idDatecni').hasClass("has_error");
						document.getElementById("ninDatecni").innerHTML = "La date de délivrance ne doit pas être inférieure à l'année 1900.";
					}
					else
					{
						document.getElementById("ninDatecni").innerHTML = "";
						$('#idDatecni').removeClass("has_error");

					}

				});
			

				$('#idDatepassport').blur(function () {
				var datepassport = new Date($('#idDatepassport').val());
				var datenais =  new Date($('#idDatenais').val());
				var dateDuJour = new Date();
				if (datepassport > dateDuJour) {
				Swal.fire('La date du passport ne doit pas être postérieure à la date du jour.');
				document.getElementById("idDatepassport").value = new Date("");
				}
				else
				{
					if (datepassport <= datenais)
					{
						Swal.fire('La date du passport ne doit pas être antérieure ou égale à la date de naissance.');
						document.getElementById("idDatepassport").value = new Date("");

					}
				}

			});


			// contole date cni et date passpport de dirigeant
			$('#idDatcni_dirig').blur(function () {
				
				var dateCNI = new Date($('#idDatcni_dirig').val());
				var datenais =  new Date($('#idDatenais_dirig').val());
				
				var dateDuJour = new Date();
				if (dateCNI > dateDuJour) {
				Swal.fire('La date de CNI ne doit pas être postérieure à la date du jour.');
				document.getElementById("idDatcni_dirig").value = new Date("");
				}
				
			});


			$("#idDatenais_dirig").blur(function()
			{
				var dateCNI = new Date($('#idDatcni_dirig').val());
				var datenais =  new Date($('#idDatenais_dirig').val());
				var dateDuJour = new Date();
				if (datenais >= dateDuJour )
				{
					document.getElementById("idDatenais_dirig").value = new Date("");
					$("#idDatenais_dirig").hasClass("has_error");
					document.getElementById("nindatenais").innerHTML= "La date de naissance ne doit pas être postérieure  à la date de  jour.";
					Swal.fire('La date de naissance ne doit pas être postérieure  à la date de délivrance du jour.');

				}
				else {
					if (datenais >= dateCNI)
					{
						document.getElementById("idDatenais_dirig").value = new Date("");
						$("#idDatenais_dirig").hasClass("has_error");
						document.getElementById("nindatenais").innerHTML= "La date de naissance ne doit pas être postérieure ou égale  à la date de délivrance de la CNI.";
						Swal.fire('La date de naissance ne doit pas être postérieure ou égale à la date de délivrance de la CNI.');
	
					}
					else
					{
						$("#idDatenais_dirig").removeClass("has_error");
						document.getElementById("nindatenais").innerHTML= "";
						
					}
				}
				
				
			});
			
			$('#idDatepassport_dirig').change(function () {
				var datepassport = new Date($('#idDatepassport_dirig').val());
				var datenais =  new Date($('#idDatenais_dirig').val());
				var dateDuJour = new Date();
				if (datepassport >= dateDuJour) {
				Swal.fire('La date du passport ne doit pas être postérieure  à la date du jour.');
				document.getElementById("idDatepassport_dirig").value = new Date("");
				}
				else
				{
					if (datenais >= datepassport)
					{
						document.getElementById("idDatepassport_dirig").value = new Date("");
						$("#idDatepassport_dirig").hasClass("has_error");
						document.getElementById("nindatepassport").innerHTML= "La date de naissance ne doit pas être postérieure ou égale  à la date de délivrance du passport.";
						Swal.fire('La date de naissance ne doit pas être postérieure ou égale à la date de délivrance du passport.');
	
					}
					else
					{
						$("#idDatepassport_dirig").removeClass("has_error");
						document.getElementById("nindatepassport").innerHTML= "";
						
					}
				}
			});


			$("#idDatenais").blur(function() {
				var dateCNI = new Date($('#idDatecni').val());
				var datepassport = new Date($('#idDatepassport').val());
				var datenais =  new Date($('#idDatenais').val());
				if (datenais >= dateCNI)
				{
					document.getElementById("idDatenais").value = new Date("");
					$("#idDatenais").hasClass("has_error");
					document.getElementById("nindatenais").innerHTML= "La date de naissance ne doit pas être postérieure  à la date de délivrance de la CNI.";
					Swal.fire('La date de naissance ne doit pas être postérieure  ou égale à la date de délivrance de la CNI.');

				} else
				{
					$("#idDatenais").removeClass("has_error");
					document.getElementById("nindatenais").innerHTML= "";
				}

			});


			//controle sur l'age avec entreprise individuelle
			let formunite = "{{ ni_nineaproposition.ninFormejuridique.niFormeunite.id }}";
			$("#idDatenais").blur(function() {
				let datenais = new Date($('#idDatenais').val());
				var dateDuJour = new Date();
				let yearsDiff = dateDuJour.getFullYear() - datenais.getFullYear();
				if (yearsDiff < 18 && (formunite == 11 || formunite == 12))
				{
					Swal.fire("L'âge ne doit pas être inférieur à 18 ans")
					//document.getElementById("idDatenais").addClass("has_error");
					//document.getElementById("idDatenais").value = new Date("");

				}
			});


				// verification de l'Email
			function IsEmail(email) {
				var regex = /^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
				if (! regex.test(email)) {
				return false;
				} else {
				return true;
				}
			}
			
			
			$("#idemailpersonne").blur(function () {
				var inputvalues = $(this).val();
				var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;

				if($('#idemailpersonne').val()!=""){
                    if (! regex.test(inputvalues)) {
						$("#idemailpersonne").focus();
						Swal.fire("Entrez une adresse mail valide.");
						$('#idemailpersonne').addClass('has_error');
				    }
					else{
						$('#idemailpersonne').removeClass('has_error');
					}
				}
				else{
					$('#idemailpersonne').removeClass('has_error');
				}
			
			});


			$("#idemail").change(function () {
				var inputvalues = $(this).val();
				var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
				if (! regex.test(inputvalues)) {
				Swal.fire("Entrez une adresse email valide.");
				$('#idemail').addClass('has_error');
				$("#idemail").focus();
				}
				
			});

			/*$("#idemail_dirig").blur(function () {
				var inputvalues = $(this).val();
				var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
				if (! regex.test(inputvalues)) {
					$("#idemail_dirig").focus();
					Swal.fire("Entrez une adresse email valide.");
					$('#idemail_dirig').addClass('has_error');
				}
				else 
				{
					$('#idemail_dirig').removeClass('has_error');
				}
				
			}); */
			
			// CONTROLES SUR LES DATES
			
			$('#idDatenais').change(function () {
				var verifdatenaiss = 0;
				if ($('#idDatenais').val() != "") {
				
				var date1 = new Date($('#idDatenais').val());
					var dateDuJour = new Date();
					
					if (date1 > dateDuJour) {
					Swal.fire('La   date de naissance  doit être antérieure  à la date du jour.');
					document.getElementById("idDatenais").value = new Date("");
					}
				}
			});


		$('#idDatenais_dirig').blur(function () {
			var verifdatenaiss = 0;
				if ($('#idDatenais_dirig').val() != null) {
				
					var date1 = new Date($('#idDatenais_dirig').val());
					var dateDuJour = new Date();
					
					if (date1 > dateDuJour) 
					{
						Swal.fire('La   date de naissance  ne doit pas être postérieure  à la date du jour.');
						document.getElementById("idDatenais_dirig").value = new Date("");
						
					}
					else
					{
						let yearsDiff = dateDuJour.getFullYear() - date1.getFullYear();
						if (yearsDiff < 18 )
						{
							Swal.fire("L'âge ne doit pas être inférieur à 18 ans");
						}
					}
				}
			});


		//controle url
		$("#idurl").change(function () {
				var inputvalues = $(this).val();
				var regex = /^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/;
				if (!regex.test(inputvalues)) {
					Swal.fire("Entrez une url valide.");
					$('#idurl').addClass('has_error');
					$("#idurl").focus();
				}
				else 
				{
					$('#idurl').removeClass('has_error');
				}

			});
	

		// Fonction servant à limiter le nombre de caractere  dans une textarea
		function maxLength(element, max) {
			value = element.value;
			max = parseInt(max);
			if (value.length > max) {
			Swal.fire('Nombre de chiffres dépassé.');
			element.value = value.substr(0, max);
			}
		}

	
	$(".soumettre").click(function(e) {

	var soumettre  = 1;
      
	{% if ni_nineaproposition.ninFormejuridique.niFormeunite.id == 21 or ni_nineaproposition.ninFormejuridique.niFormeunite.id == 22 %}
		{% if ni_nineaproposition.ninDirigeants|length>0 %} 
						
		{% else %}
			soumettre = 0;
			Swal.fire("Le ou les dirigeants ne sont pas renseignées.");
		{% endif %}
	{% endif %}

		{% if (ni_nineaproposition.niPersonne is not null ) %} 

			{% if ni_nineaproposition.coordonnees|length>0 %} 

				{% if ni_nineaproposition.ninActivites|length>0 %}  
					
						{% if ni_nineaproposition.niActiviteEconomiques|length>0 %} 
						
						{% else %}
							
						{% endif %}

				{% else %}
					soumettre = 0;
					Swal.fire("Les activités et produits ne sont pas renseignées.");
				{% endif %}

			{% else %}
				soumettre = 0;
				Swal.fire("Les coordonnées ne sont pas renseignées.");
			{% endif %}

		{% else %}
			soumettre = 0;
			Swal.fire("Personne morale ou physique n'est pas renseignée.");

		{% endif %}

		
		if (soumettre==1) {
			
			{
				e.preventDefault();
				
				var a=$(this);
				Swal.fire({
				title:"Confirmation",
				text:"Êtes-vous sûr de vouloir soumettre la demande  ?",
				icon:"warning",
				showCancelButton:true,
				confirmButtonText:"Oui",
				cancelButtonText:"Non",
				confirmButtonClass:"btn btn-success mt-2",
				cancelButtonClass:"btn btn-danger ms-2 mt-2",
				buttonsStyling:!1}).then(function(t)
				{
				if (t.value) {
					
					window.location.href="{{ path('ni_nineaproposition_soumission', {'id': ni_nineaproposition.id } )}}";
				}else
					e.preventDefault();

				})}
		}

	});


	$("#idBtnsuivantDirigeant").click(function() {
	    $("#soumettre").click();

	});

		
		// controle sur les boutons précédent et suivant
		$('#idBtnPrecedentActivitesEconomiques').click(function () {

			$('#idactiviteEconomique').removeClass('active');
			$('#activiteEconomiques').removeClass('active');

			$('#idactivite').addClass('active');
			$('#idactivite').attr('href', '#activites');
			$('#activites').addClass('active');

		});

			// controle sur les boutons précédent et suivant
		$('#idBtnPrecedentDirigeant').click(function () {

			$('#iddirigeant').removeClass('active');
			$('#dirigeants').removeClass('active');

			$('#idactiviteEconomique').addClass('active');
			$('#idactiviteEconomique').attr('href', '#activiteEconomiques');
			$('#activiteEconomiques').addClass('active');

		});

			// controle sur les boutons précédent et suivant
		$('#idBtnPrecedentActivites').click(function () {

			$('#idactivite').removeClass('active');
			$('#activites').removeClass('active');

			$('#idcoordonnee').addClass('active');
			$('#idcoordonnee').attr('href', '#coordonnees');
			$('#coordonnees').addClass('active');

		});

		// controle sur les boutons précédent et suivant
		$('#idBtnPrecedentCoordonnees').click(function () {

			$('#idcoordonnee').removeClass('active');
			$('#coordonnees').removeClass('active');

			$('#idpersonne').addClass('active');
			$('#idpersonne').attr('href', '#personne');
			$('#personne').addClass('active');

		});


		$(document).keydown(function (eventObject) 
		{
			if(eventObject.keyCode==39){
				// $("#btnSuivant").click();
				var attClass=document.getElementById("personne").getAttribute('class');
				var indexactive = attClass.indexOf("active");    
				if(indexactive !== -1){
					$("#btnSuivant").click();
					return;
				}

				attClass=document.getElementById("coordonnees").getAttribute('class');
				indexactive = attClass.indexOf("active"); 
				if(indexactive !== -1){
					$("#idBtnSuivantCoordonnees").click();
					return;
				}

				attClass=document.getElementById("activites").getAttribute('class');
				indexactive = attClass.indexOf("active"); 
				if(indexactive !== -1){
					$("#idBtnSuivantActivites").click();
					return;
				}

				attClass=document.getElementById("dirigeants").getAttribute('class');
				indexactive = attClass.indexOf("active"); 
				if(indexactive !== -1){
					$("#idBtnsuivantDirigeant").click();
					return;
				}

				attClass=document.getElementById("activiteEconomiques").getAttribute('class');
				indexactive = attClass.indexOf("active"); 
				if(indexactive !== -1){
					$("#idBtnsuivantActivitesEconomiques").click();
					return;
				}

			}
			else if(eventObject.keyCode==37){
	
				attClass=document.getElementById("coordonnees").getAttribute('class');
				indexactive = attClass.indexOf("active"); 
				if(indexactive !== -1){
					$("#idBtnPrecedentCoordonnees").click();
					return;
				}

				attClass=document.getElementById("activites").getAttribute('class');
				indexactive = attClass.indexOf("active"); 
				if(indexactive !== -1){
					$("#idBtnPrecedentActivites").click();
					return;
				}

				attClass=document.getElementById("dirigeants").getAttribute('class');
				indexactive = attClass.indexOf("active"); 
				if(indexactive !== -1){
					$("#idBtnPrecedentDirigeant").click();
					return;
				}

				attClass=document.getElementById("activiteEconomiques").getAttribute('class');
				indexactive = attClass.indexOf("active"); 
				if(indexactive !== -1){
					$("#idBtnPrecedentActivitesEconomiques").click();
					return;
				}
			}
		
		});

	

		var $ninationalite_dirig = $('#idnationalite_dirigeant');

		$ninationalite_dirig.change(function () {

		if ($ninationalite_dirig.val() == "SN") {
		document.getElementById("tableCni_dirigeant").style.display = "block";
		document.getElementById("idcni_dirig").setAttribute('required',true);
		document.getElementById("idDatcni_dirig").setAttribute('required',true);
		document.getElementById("idDatepassport_dirig").removeAttribute('required');
		document.getElementById("idPassport_dirig").removeAttribute('required',true);

		document.getElementById("tablePassport_dirigeant").style.display = "none";

		} else {
		document.getElementById("tableCni_dirigeant").style.display = "none";
		document.getElementById("tablePassport_dirigeant").style.display = "block";
		document.getElementById("idDatepassport_dirig").setAttribute('required',true);
		document.getElementById("idPassport_dirig").setAttribute('required',true);
		document.getElementById("idcni_dirig").removeAttribute('required');
		document.getElementById("idDatcni_dirig").removeAttribute('required');


		}
	});


   		//CONTROLES SUR LA CNI
		$('#idcni_dirig').change(function () 
		{	
			let cni = $("#idcni_dirig").val();
			let route = "{{ path('controleCNIDIRIG') }}" + "/" + cni;	 

			//CNI avec 13 ou 14 caractere
			if ( cni.length == 13 || cni.length == 14)
				{
				
					if(cni != "")
							{
								
								if (cni.length == 11 || cni.length == 13 || cni.length == 14)
								{
									var element1 = cni.substring(0,1);		
									if ( element1 != 1 && element1 != 2 )
									{
										$("#idcni_dirig").focus();
										document.getElementById('nincni_dirig').innerHTML = "La CNI n'est pas valide.";
										$('#idcni_dirig').hasClass('has_error');
										Swal.fire("La CNI n'est pas valide.");

									}
									else 
									{
										document.getElementById('nincni_dirig').innerHTML = "";
										$('#idcni_dirig').removeClass('has_error');
			
										//test entre CNI et civilité
										var nationalite= document.getElementById("idnationalite_dirigeant").value;	
										var elementCni = cni.substring(0, 1);
										var sexe = document.getElementById("idSexe_dirig");
										if (cni.startsWith("1") && nationalite == "SN") 
										{
										
											// test civilite et cni
											if (document.getElementById("idcivilite_dirig").value == "2" ) 
												{
													document.getElementById('nincni_dirig').innerHTML = "Attention! la CNI commmence par 1, donc non conforme avec la civilité Madame.";
													$('#idcni_dirig').addClass('has_error');
													Swal.fire("Attention! la CNI commmence par 1, donc non conforme avec la civilité Madame");
													//changer la civilite
													
												}else{
													$('#idcni_dirig').removeClass('has_error');
													document.getElementById('btnValider').removeAttribute("disabled");
				
												}
												
										}
			
										else if (cni.startsWith("2") && nationalite == "SN") 
										{

											// test civilite et cni
											if (document.getElementById("idcivilite_dirig").value == "1" ) 
											{
												document.getElementById('nincni_dirig').innerHTML = "Attention! la CNI commmence par 2, donc non conforme avec la civilité Monsieur.";
												$('#idcni_dirig').addClass('has_error');
												Swal.fire("Attention! la CNI commmence par 2, donc non conforme avec la civilité Monsieur");
												//changer la civilite
												
											}else{
												$('#idcni_dirig').removeClass('has_error');
												document.getElementById('nincni_dirig').innerHTML = "";
				
											}
											
											
										}
			
									}					
									
								}
								else
									{
										$('#idcni_dirig').focus();   
										document.getElementById('nincni_dirig').innerHTML = "La longueur de la CNI doit être comprise entre 11, 13 et 14 caractères.";              
										$('#idcni_dirig').addClass('has_error');
										Swal.fire("La longueur de la CNI doit être comprise entre 11, 13 et 14 caractères.");

									}
							}

		
				} 

				//CNI a 11 caractères
				else if ( cni.length == 11)
				{
					//2er controle
					$.ajax({
						type: 'GET',
						url: route,
						success: function (data) 
						{
							if (data == 1)
							{
								document.getElementById('nincni').innerHTML = "Ce numéro d'identification est déjà utilisé .";
								$('#idcni_dirig').addClass('has_error');
								$("#idcni_dirig").focus();
							}

								$('#idcni_dirig').removeClass('has_error');

						}

					});
				}

		});


		$('#idConfirmcni_dirig').change(function () {	
			let CNI = $("#idcni_dirig").val();
			let confirmationCNI = $("#idConfirmcni_dirig").val();
			if(CNI != confirmationCNI)
			{
				$("#idConfirmcni_dirig").focus();
				$('#idConfirmcni_dirig').addClass('has_error');
				document.getElementById("ninconfcni_dirg").innerHTML = "Les deux CNI ne sont pas conformes.";
				Swal.fire("Les deux CNI ne sont pas conformes.");						
			}
			else
			{
				$('#idConfirmcni_dirig').removeClass('has_error');
				document.getElementById("ninconfcni_dirg").innerHTML = "";

			}
		});  
	


  	/*$('#idcni_dirig').blur(function () {	
		var cni = $('#idcni_dirig').val();
		if (cni.length == 13 || cni.length == 14)
		{
			var element1 = cni.substring(0,1);		
			if ( element1 != 1 && element1 != 2 )
			{
				$("#idcni_dirig").focus();
				$('#idcni_dirig').addClass('has_error');
				Swal.fire("La CNI n'est pas valide.");
			}
			else
			{
				$('#idcni_dirig').removeClass('has_error');
	
			}
		}
		else
		{
			$("#idcni_dirig").focus();
			$('#idcni_dirig').addClass('has_error');
			Swal.fire("La longueur de la CNI doit être de 13 à 14 caractères.");

		}
		
	});  */



		// QVH POUR personnes
		$('#region').change(function () {

		let route = "{{ path('departementsRegion') }}" + "/" + $('#region').val();
		$.ajax({
		type: 'GET',
		url: route,
		dataType: "json",
		success: function (data) {
		
		let departement = document.getElementById("departement");
		departement.innerHTML = "";
		
		let opt = document.createElement('option');
		opt.innerHTML = "Selectionner ...";
		opt.value = '';
		departement.add(opt);
		for (var i = data.length - 1; i >= 0; i--) 
		{
			let opt = document.createElement('option');
			opt.value = data[i][0];
			opt.innerHTML = data[i][1];
			departement.add(opt);
		
		}

			/*if ( document.getElementById("region").value == "0") 
			{
				let departement = document.getElementById("departement");
				departement.innerHTML = "";
				
				let opt = document.createElement('option');
				opt.innerHTML = "Selectionner ...";
				opt.value = '0';
				departement.add(opt);
			}*/

		},
		error: function (error) {
		console.log(error);
		}
		})
		});
		
		$('#departement').change(function () {
		
		let route = "{{ path('cavDepartement') }}" + "/" + $('#departement').val();
		$.ajax({
		type: 'GET',
		url: route,
		dataType: "json",
		success: function (data) {
		
		let cav = document.getElementById("cav");
		cav.innerHTML = "";
		
		let opt = document.createElement('option');
		opt.innerHTML = "Selectionner ...";
		opt.value = '';
		cav.add(opt);
		for (var i = data.length - 1; i >= 0; i--) {
		let opt = document.createElement('option');
		opt.value = data[i][0];
		opt.innerHTML = data[i][1];
		cav.add(opt);		
		
		}
		},
		error: function (error) {
		console.log(error);
		}
		})
		});
		
		
		$('#cav').change(function () {
		
		let route = "{{ path('cacrCav') }}" + "/" + $('#cav').val();
		$.ajax({
		type: 'GET',
		url: route,
		dataType: "json",
		success: function (data) {
		
		let cacr = document.getElementById("cacr");
		cacr.innerHTML = "";
		
		let opt = document.createElement('option');
		opt.innerHTML = "Selectionner ...";
		opt.value = '';
		cacr.add(opt);
		for (var i = data.length - 1; i >= 0; i--) {
		let opt = document.createElement('option');
		opt.value = data[i][0];
		opt.innerHTML = data[i][1];
		cacr.add(opt);
		
		
		}
		},
		error: function (error) {
		console.log(error);
		}
		})
		});
		
		$('#cacr').change(function () {
		
		let route = "{{ path('qvhCacr') }}" + "/" + $('#cacr').val();
		$.ajax({
		type: 'GET',
		url: route,
		dataType: "json",
		success: function (data) {
		
		let qvh = document.getElementById("qvh");
		qvh.innerHTML = "";
		
		let opt = document.createElement('option');
		opt.innerHTML = "Selectionner ...";
		opt.value = '';
		qvh.add(opt);
		for (var i = data.length - 1; i >= 0; i--) {
		let opt = document.createElement('option');
		opt.value = data[i][0];
		opt.innerHTML = data[i][1];
		qvh.add(opt);
		

		}
		},
		error: function (error) {
		console.log(error);
		}
		})
		});



			// QVH POUR coordonnees
	$('#region_coordonnees').change(function () {

	let route = "{{ path('departementsRegion') }}" + "/" + $('#region_coordonnees').val();
	$.ajax({
	type: 'GET',
	url: route,
	dataType: "json",
	success: function (data) {
	
	let departement = document.getElementById("departement_coordonnees");
	departement.innerHTML = "";
	
	let opt = document.createElement('option');
	opt.innerHTML = "Selectionner ...";
	opt.value = '';
	departement.add(opt);
	for (var i = data.length - 1; i >= 0; i--) {
	let opt = document.createElement('option');
	opt.value = data[i][0];
	opt.innerHTML = data[i][1];
	departement.add(opt);
	
	}
	},
	error: function (error) {
	console.log(error);
	
	}
	})
	});
	
	$('#departement_coordonnees').change(function () {
	
	let route = "{{ path('cavDepartement') }}" + "/" + $('#departement_coordonnees').val();
	$.ajax({
	type: 'GET',
	url: route,
	dataType: "json",
	success: function (data) {
	
	let cav = document.getElementById("cav_coordonnees");
	cav.innerHTML = "";
	
	let opt = document.createElement('option');
	opt.innerHTML = "Selectionner ...";
	opt.value = '';
	cav.add(opt);
	for (var i = data.length - 1; i >= 0; i--) {
	let opt = document.createElement('option');
	opt.value = data[i][0];
	opt.innerHTML = data[i][1];
	cav.add(opt);
	
	}
	},
	error: function (error) {
	console.log(error);
	}
	})
	});
	
	
	$('#cav_coordonnees').change(function () {
	
	let route = "{{ path('cacrCav') }}" + "/" + $('#cav_coordonnees').val();
	$.ajax({
	type: 'GET',
	url: route,
	dataType: "json",
	success: function (data) {
	
	let cacr = document.getElementById("cacr_coordonnees");
	cacr.innerHTML = "";
	
	let opt = document.createElement('option');
	opt.innerHTML = "Selectionner ...";
	opt.value = '';
	cacr.add(opt);
	for (var i = data.length - 1; i >= 0; i--) {
	let opt = document.createElement('option');
	opt.value = data[i][0];
	opt.innerHTML = data[i][1];
	cacr.add(opt);
	
	}
	},
	error: function (error) {
	console.log(error);
	}
	})
	});
	
	$('#cacr_coordonnees').change(function () {
	
	let route = "{{ path('qvhCacr') }}" + "/" + $('#cacr_coordonnees').val();
	$.ajax({
	type: 'GET',
	url: route,
	dataType: "json",
	success: function (data) {
	
	let qvh = document.getElementById("qvh_coordonnees");
	qvh.innerHTML = "";
	
	let opt = document.createElement('option');
	opt.innerHTML = "Selectionner ...";
	opt.value = '';
	qvh.add(opt);
	for (var i = data.length - 1; i >= 0; i--) {
	let opt = document.createElement('option');
	opt.value = data[i][0];
	opt.innerHTML = data[i][1];
	qvh.add(opt);
	
	}
	},
	error: function (error) {
	console.log(error);
	}
	})
	});
	

			// QVH POUR PERSONNE
			$('#region_dirigeant').change(function () {

				let route = "{{ path('departementsRegion') }}" + "/" + $('#region_dirigeant').val();
				$.ajax({
				type: 'GET',
				url: route,
				dataType: "json",
				success: function (data) {
				
				let departement = document.getElementById("departement_dirigeant");
				departement.innerHTML = "";
				
				let opt = document.createElement('option');
				opt.innerHTML = "Selectionner ...";
				opt.value = '';
				departement.add(opt);
				for (var i = data.length - 1; i >= 0; i--) {
				let opt = document.createElement('option');
				opt.value = data[i][0];
				opt.innerHTML = data[i][1];
				departement.add(opt);
				
				}
				},
				error: function (error) {
				console.log(error);
				}
				})
			});
				
				$('#departement_dirigeant').change(function () {
				
				let route = "{{ path('cavDepartement') }}" + "/" + $('#departement_dirigeant').val();
				$.ajax({
				type: 'GET',
				url: route,
				dataType: "json",
				success: function (data) {
				
				let cav = document.getElementById("cav_dirigeant");
				cav.innerHTML = "";
				
				let opt = document.createElement('option');
				opt.innerHTML = "Selectionner ...";
				opt.value = '';
				cav.add(opt);
				for (var i = data.length - 1; i >= 0; i--) {
				let opt = document.createElement('option');
				opt.value = data[i][0];
				opt.innerHTML = data[i][1];
				cav.add(opt);
				
				}
				},
				error: function (error) {
				console.log(error);
				}
				})
				});
				
				
				$('#cav_dirigeant').change(function () {
				
				let route = "{{ path('cacrCav') }}" + "/" + $('#cav_dirigeant').val();
				$.ajax({
				type: 'GET',
				url: route,
				dataType: "json",
				success: function (data) {
				
				let cacr = document.getElementById("cacr_dirigeant");
				cacr.innerHTML = "";
				
				let opt = document.createElement('option');
				opt.innerHTML = "Selectionner ...";
				opt.value = '';
				cacr.add(opt);
				for (var i = data.length - 1; i >= 0; i--) {
				let opt = document.createElement('option');
				opt.value = data[i][0];
				opt.innerHTML = data[i][1];
				cacr.add(opt);
				
				}
				},
				error: function (error) {
				console.log(error);
				}
				})
				});
				
				$('#cacr_dirigeant').change(function () {
				
				let route = "{{ path('qvhCacr') }}" + "/" + $('#cacr_dirigeant').val();
				$.ajax({
				type: 'GET',
				url: route,
				dataType: "json",
				success: function (data) {
				
				let qvh = document.getElementById("qvh_dirigeant");
				qvh.innerHTML = "";
				
				let opt = document.createElement('option');
				opt.innerHTML = "Selectionner ...";
				opt.value = '';
				qvh.add(opt);
				for (var i = data.length - 1; i >= 0; i--) {
				let opt = document.createElement('option');
				opt.value = data[i][0];
				opt.innerHTML = data[i][1];
				qvh.add(opt);
				
				}
				},
				error: function (error) {
				console.log(error);
				}
				})
				});



             $('#editregion_dirigeant').change(function () {
              //  alert("okkk");
				let route = "{{ path('departementsRegion') }}" + "/" + $('#editregion_dirigeant').val();
				$.ajax({
				type: 'GET',
				url: route,
				dataType: "json",
				success: function (data) {
				
				let departement = document.getElementById("editdepartement_dirigeant");
				departement.innerHTML = "";
				
				let opt = document.createElement('option');
				opt.innerHTML = "Selectionner ...";
				opt.value = '';
				departement.add(opt);
				for (var i = data.length - 1; i >= 0; i--) {
				let opt = document.createElement('option');
				opt.value = data[i][0];
				opt.innerHTML = data[i][1];
				departement.add(opt);
				
				}
				},
				error: function (error) {
				console.log(error);
				}
				})
				});
				
				$('#editdepartement_dirigeant').change(function () {
				
				let route = "{{ path('cavDepartement') }}" + "/" + $('#editdepartement_dirigeant').val();
				$.ajax({
				type: 'GET',
				url: route,
				dataType: "json",
				success: function (data) {
				
				let cav = document.getElementById("editcav_dirigeant");
				cav.innerHTML = "";
				
				let opt = document.createElement('option');
				opt.innerHTML = "Selectionner ...";
				opt.value = '';
				cav.add(opt);
				for (var i = data.length - 1; i >= 0; i--) {
				let opt = document.createElement('option');
				opt.value = data[i][0];
				opt.innerHTML = data[i][1];
				cav.add(opt);
				
				}
				},
				error: function (error) {
				console.log(error);
				}
				})
				});
				
				
				$('#editcav_dirigeant').change(function () {
				
				let route = "{{ path('cacrCav') }}" + "/" + $('#editcav_dirigeant').val();
				$.ajax({
				type: 'GET',
				url: route,
				dataType: "json",
				success: function (data) {
				
				let cacr = document.getElementById("editcacr_dirigeant");
				cacr.innerHTML = "";
				
				let opt = document.createElement('option');
				opt.innerHTML = "Selectionner ...";
				opt.value = '';
				cacr.add(opt);
				for (var i = data.length - 1; i >= 0; i--) {
				let opt = document.createElement('option');
				opt.value = data[i][0];
				opt.innerHTML = data[i][1];
				cacr.add(opt);
				
				}
				},
				error: function (error) {
				console.log(error);
				}
				})
				});
				
				$('#editcacr_dirigeant').change(function () {
				
				let route = "{{ path('qvhCacr') }}" + "/" + $('#editcacr_dirigeant').val();
				$.ajax({
				type: 'GET',
				url: route,
				dataType: "json",
				success: function (data) {
				
				let qvh = document.getElementById("editqvh_dirigeant");
				qvh.innerHTML = "";
				
				let opt = document.createElement('option');
				opt.innerHTML = "Selectionner ...";
				opt.value = '';
				qvh.add(opt);
				for (var i = data.length - 1; i >= 0; i--) {
				let opt = document.createElement('option');
				opt.value = data[i][0];
				opt.innerHTML = data[i][1];
				qvh.add(opt);
				
				}
				},
				error: function (error) {
				console.log(error);
				}
				})
				});


			
				//separateur de caractères pour activté économiques
				/*$('#ni_activite_economique_ninAffaire').on("keyup", function () {
						this.value = this.value.replace(/[^0-9]/g, '');
						var number = this.value;
						this.value = number.replace(/\B(?=(\d{3})+(?!\d))/g, " ");
					});

					$('#ni_activite_economique_ninAffaire').on("change", function () {
							console.log($('#ni_activite_economique_ninAffaire').val());
						});
						

					$('#ni_activite_economique_ninCapital').on("keyup", function () {
						this.value = this.value.replace(/[^0-9]/g, '');
						var number = this.value;
						this.value = number.replace(/\B(?=(\d{3})+(?!\d))/g, " ");
						
					});*/

					
					$('#ni_activite_economique_ninEffectifFemSAIS').change(function () {
					if(document.getElementById("ni_activite_economique_ninEffect1").value!=""){
						//alert(document.getElementById("ni_activite_economique_ninEffectifFemSAIS").value+ " "+ document.getElementById("ni_activite_economique_ninEffect1").value);
						if (Number(document.getElementById("ni_activite_economique_ninEffectifFemSAIS").value) > Number(document.getElementById("ni_activite_economique_ninEffect1").value)) {
							Swal.fire("Effectif temporaire femme ne doit pas dépasser l'effectif temporaire total.");
							document.getElementById("ni_activite_economique_ninEffectifFemSAIS").value="";
						}
					}
									
					});

					$('#ni_activite_economique_ninEffect1').change(function () {
					if(document.getElementById("ni_activite_economique_ninEffectifFemSAIS").value!=""){
						if (Number(document.getElementById("ni_activite_economique_ninEffectifFemSAIS").value)> Number(document.getElementById("ni_activite_economique_ninEffect1").value)) {
							Swal.fire("l'effectif temporaire total doit être supérieur effectif temporaire femme.");
							document.getElementById("ni_activite_economique_ninEffect1").value="";
						}
					}
					
					
					});

					$('#ni_activite_economique_ninEffectifFem').change(function () {
						
					if(document.getElementById("ni_activite_economique_ninEffectif").value!=""){
						if (Number(document.getElementById("ni_activite_economique_ninEffectifFem").value) > Number(document.getElementById("ni_activite_economique_ninEffectif").value)) {
							Swal.fire("Effectif permanent femme ne doit pas dépasser l'effectif permanent total.");
							document.getElementById("ni_activite_economique_ninEffectifFem").value="";
						}
					}
					
					
					});

					$('#ni_activite_economique_ninEffectif').change(function () {
					if(document.getElementById("ni_activite_economique_ninEffectifFem").value!=""){
						if (Number(document.getElementById("ni_activite_economique_ninEffectifFem").value) > Number(document.getElementById("ni_activite_economique_ninEffectif").value)) {
							Swal.fire("l'effectif permanent total doit être supérieur à effectif permanent femme.");
							document.getElementById("ni_activite_economique_ninEffectif").value="";
						}
					}
					});



					$('#idninEffectifFemSAIS').change(function () {
					if(document.getElementById("idninEffect1").value!=""){
						//alert(document.getElementById("idninEffectifFemSAIS").value+ " "+ document.getElementById("ni_activite_economique_ninEffect1").value);
						if (Number(document.getElementById("idninEffectifFemSAIS").value) > Number(document.getElementById("idninEffect1").value)) {
							Swal.fire("Effectif temporaire femme ne doit pas dépasser l'effectif temporaire total.");
							document.getElementById("idninEffectifFemSAIS").value="";
						}
					}
									
					});

					$('#idninEffect1').change(function () {
					if(document.getElementById("idninEffectifFemSAIS").value!=""){
						if (Number(document.getElementById("idninEffectifFemSAIS").value)> Number(document.getElementById("idninEffect1").value)) {
							Swal.fire("l'effectif temporaire total doit être supérieur effectif temporaire femme.");
							document.getElementById("idninEffect1").value="";
						}
					}
					
					
					});

					$('#idninEffectifFem').change(function () {
						
					if(document.getElementById("idninEffectif").value!=""){
						if (Number(document.getElementById("idninEffectifFem").value) > Number(document.getElementById("ni_activite_economique_ninEffectif").value)) {
							Swal.fire("Effectif permanent femme ne doit pas dépasser l'effectif permanent total.");
							document.getElementById("ni_activite_economique_ninEffectifFem").value="";
						}
					}
					
					
					});

					$('#idninEffectif').change(function () {
					if(document.getElementById("idninEffectifFem").value!=""){
						if (Number(document.getElementById("idninEffectifFem").value) > Number(document.getElementById("idninEffectif").value)) {
							Swal.fire("l'effectif permanent total doit être supérieur à effectif permanent femme.");
							document.getElementById("idninEffectif").value="";
						}
					}
					});


					//controle chiffres affaire et annee chiffre

					$('#idninAffaire').change(function() {

						    let nStr = $("#idninAffaire").val();
							nStr += '';
							x = nStr.split('.');
							x1 = x[0];
							x2 = x.length > 1 ? '.' + x[1] : '';
							var rgx = /(\d+)(\d{3})/;
							while (rgx.test(x1)) {
							x1 = x1.replace(rgx, '$1' + ' ' + '$2');
							}
							$("#idninAffaire").val(x1 + x2) ;


					});

					$('#ni_activite_economique_ninAffaire').change(function() {
						let chiffreaffaire = $("#ni_activite_economique_ninAffaire").val();
						
						if (chiffreaffaire.length != 0 && chiffreaffaire != "0")
						{
							document.getElementById('ni_activite_economique_ninAnneeCa').removeAttribute("disabled");
							document.getElementById('ni_activite_economique_ninAnneeCa').setAttribute("required", true);
							let nStr = $("#ni_activite_economique_ninAffaire").val();
							nStr += '';
							x = nStr.split('.');
							x1 = x[0];
							x2 = x.length > 1 ? '.' + x[1] : '';
							var rgx = /(\d+)(\d{3})/;
							while (rgx.test(x1)) {
							x1 = x1.replace(rgx, '$1' + ' ' + '$2');
							}
							$("#ni_activite_economique_ninAffaire").val(x1 + x2) ;

						}
						
						else
						{
							document.getElementById('ni_activite_economique_ninAnneeCa').setAttribute("disabled", true);
							document.getElementById('ni_activite_economique_ninAnneeCa').removeAttribute("required");

						 }

					})


					$('#ni_activite_economique_ninAnneeCa').change(function () {
					//	alert("ca changes");
					    var annee=document.getElementById("ni_activite_economique_ninAnneeCa").value;
						let anneenormale = annee.split('_').join('').trim();
						
			
							if(anneenormale.length != 4){
								Swal.fire("l'année du chiffre d'affaire doit être sur 4 chiffres");
								document.getElementById("ni_activite_economique_ninAnneeCa").value="";
							}								
							else
							{
								
								var dateDuJour=new Date();
								//alert(dateDuJour);
								var anneeActuelle=dateDuJour.getFullYear();
								if(anneenormale > anneeActuelle){
									Swal.fire("l'année du chiffre d'affaire doit être antérieur à "+anneeActuelle);
									
									document.getElementById('idBtnsuivantActivitesEconomiques').setAttribute("disabled", true);

								}
							}

							let formeunite = "{{ ni_nineaproposition.ninFormejuridique.niFormeunite.id }}"
				            
							if (formeunite == 11 || formeunite == 12){
								
                                let datenais = new Date($('#idDatenais').val());
								
							//let yearsDiff = dateDuJour.getFullYear() - datenais.getFullYear();
								if (document.getElementById('ni_activite_economique_ninAnneeCa').value < datenais.getFullYear() )
								{
									document.getElementById('ni_activite_economique_ninAnneeCa').value = "";
									Swal.fire("L'année du chiffre d'affaires ne doit pas être antérieure à l'année de naissance.");
								}
								
								
							}

					
					});

					 
                    $("#idninAffaire").keyup(function (event) {
                        var value = jQuery(this).val();
                         value = value.replace(/[^0-9]+/g, '');
                         jQuery(this).val(value);
                     });
					 $("#idninAnneeCa").keyup(function (event) {
                        var value = jQuery(this).val();
                         value = value.replace(/[^0-9]+/g, '');
                         jQuery(this).val(value);
                     });
					 $("#idninCapital").keyup(function (event) {
                        var value = jQuery(this).val();
                         value = value.replace(/[^0-9]+/g, '');
                         jQuery(this).val(value);
                     });
					 $("#idninEffectif").keyup(function (event) {
                        var value = jQuery(this).val();
                         value = value.replace(/[^0-9]+/g, '');
                         jQuery(this).val(value);
                     });

					 $("#idninEffect1").keyup(function (event) {
                        var value = jQuery(this).val();
                         value = value.replace(/[^0-9]+/g, '');
                         jQuery(this).val(value);
                     });
					 $("#idninEffectifFem").keyup(function (event) {
                        var value = jQuery(this).val();
                         value = value.replace(/[^0-9]+/g, '');
                         jQuery(this).val(value);
                     });
					 $("#idninEffectifFemSAIS").keyup(function (event) {
                        var value = jQuery(this).val();
                         value = value.replace(/[^0-9]+/g, '');
                         jQuery(this).val(value);
                     });
				


</script>
{% endblock %}
